(()=>{var a={};a.id=2942,a.ids=[2942],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3368:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3625:(a,b,c)=>{"use strict";c.d(b,{default:()=>l});var d=c(21124),e=c(3991),f=c.n(e),g=c(42378),h=c(38301),i=c(84342),j=c(45583);let k=JSON.parse('{"version":1,"updatedAt":"2025-09-21T00:00:00.000Z","modules":[{"id":"asking-questions","slug":"asking-questions","title":"Asking Questions","description":"Master natural language questions and sensor basics","domain":"Asking Questions","order":1},{"id":"refining-questions","slug":"refining-questions","title":"Refining Questions & Targeting","description":"Advanced targeting with groups and filters","domain":"Refining Questions & Targeting","order":2},{"id":"taking-action","slug":"taking-action","title":"Taking Action","description":"Safe package deployment and action execution","domain":"Taking Action","order":3},{"id":"navigation-modules","slug":"navigation-modules","title":"Navigation & Basic Modules","description":"Navigate the console and core modules","domain":"Navigation and Basic Module Functions","order":4},{"id":"reporting-export","slug":"reporting-export","title":"Reporting & Data Export","description":"Report creation and data export","domain":"Report Generation and Data Export","order":5}]}');function l(){let a=(0,g.usePathname)()||"",{user:b}=(0,i.A)(),c=[...k.modules].sort((a,b)=>a.order-b.order),[e,l]=(0,h.useState)({}),m=(0,h.useMemo)(()=>c.map(a=>a.id),[c]);function n({pct:a}){let b=Math.max(0,Math.min(1,a??0)),c=Math.round(5*b),e=`Progress: ${Math.round(100*b)}%`;return(0,d.jsx)("div",{"aria-label":e,className:"flex items-center gap-1","data-testid":"progress",children:Array.from({length:5}).map((a,b)=>{let e=b<c;return(0,d.jsx)("span",{"data-testid":"progress-dot","data-filled":e?"true":"false",className:["h-1.5 w-1.5 rounded-full",e?"bg-blue-500":"bg-slate-300 dark:bg-slate-700"].join(" ")},b)})})}return(0,h.useEffect)(()=>{let a=!1;return async function(){if(!b?.id)return;let c=await Promise.all(m.map(async a=>[a,await (0,j.U)(b.id,a)]));if(!a){let a={};for(let[b,d]of c)a[b]=d;l(a)}}(),()=>{a=!0}},[b?.id,m.join("|")]),(0,d.jsxs)("nav",{"aria-label":"Study modules navigation",className:"w-full md:w-64 md:min-h-[calc(100vh-4rem)] md:border-r md:border-slate-200 dark:md:border-slate-800 md:pr-4",children:[(0,d.jsx)("div",{className:"px-4 py-3 md:px-0",children:(0,d.jsx)("h2",{className:"text-sm font-semibold text-slate-700 dark:text-slate-200",children:"Curriculum"})}),(0,d.jsx)("ul",{className:"space-y-1 px-2 md:px-0 pb-4",children:c.map(b=>{var c;let g=(c=b.slug,a===`/learn/${c}`);return(0,d.jsx)("li",{children:(0,d.jsx)(f(),{href:`/learn/${b.slug}`,className:["block rounded px-3 py-2 text-sm transition-colors",g?"bg-blue-600 text-white":"text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800"].join(" "),"aria-current":g?"page":void 0,children:(0,d.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,d.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,d.jsx)("span",{className:"font-medium truncate",children:b.title}),b.description?(0,d.jsx)("span",{className:"text-xs opacity-75 truncate",children:b.description}):null]}),(0,d.jsx)(n,{pct:e[b.id]?.percentage})]})})},b.id)})})]})}},8294:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},8849:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},9212:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},10350:(a,b,c)=>{"use strict";c.d(b,{Z:()=>e});var d=c(38301);function e(a){let b=d.useRef({value:a,previous:a});return d.useMemo(()=>(b.current.value!==a&&(b.current.previous=b.current.value,b.current.value=a),b.current.previous),[a])}},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:a=>{"use strict";a.exports=require("punycode")},14153:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>aO});var d=c(21124),e=c(38301),f=c.n(e),g=c(62186),h=c(44928),i=c(35284),j=c(99187),k=c(64772),l=c(18310),m=c(71117),n=c(75219),o=c(88285),p=c(9212),q=c(23339);let r=(0,q.A)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var s=c(30887),t=c(72954),u=c(75234),v=c(33204),w=c(93758),x=c(80665),y=c(40068),z=c(15303),A=c(65828),B=c(8849),C=c(30733),D=c(94684),E=c(59405),F=c(81925),G=c(47089);let H=(0,e.memo)(function({selectedSensors:a,onAdd:b,onRemove:c,onUpdate:f,catalog:k,maxSensors:m=10,className:n=""}){let[p,q]=(0,e.useState)(""),[r,s]=(0,e.useState)("all"),[t,u]=(0,e.useState)(!1),[v,H]=(0,e.useState)(null),I=(0,e.useMemo)(()=>["all",...new Set(k.map(a=>a.category))],[k]),J=(0,e.useMemo)(()=>{let a=k;if("all"!==r&&(a=a.filter(a=>a.category===r)),p){let b=p.toLowerCase();a=a.filter(a=>"name"in a.sensor&&a.sensor.name?.toLowerCase().includes(b)||a.description?.toLowerCase().includes(b)||a.category.toLowerCase().includes(b))}return a.sort((a,b)=>{if(a.popularity!==b.popularity)return b.popularity-a.popularity;let c={fast:1,medium:2,slow:3};return(c[a.runtime]||4)-(c[b.runtime]||4)}),a},[k,p,r]),K=(0,e.useMemo)(()=>k.filter(a=>a.popularity>.7).sort((a,b)=>b.popularity-a.popularity).slice(0,6),[k]),L=(0,e.useCallback)(c=>{if(a.length>=m)return void alert(`Maximum ${m} sensors allowed`);b({sensor:c.sensor,parameters:c.parameters?.reduce((a,b)=>(void 0!==b.default&&(a[b.name]=b.default),a),{}),isValid:!0}),u(!1)},[a.length,m,b]),M=(a,b)=>{let c={fast:"border-green-500 text-green-400",medium:"border-yellow-500 text-yellow-400",slow:"border-red-500 text-red-400"};return(0,d.jsxs)(j.E,{variant:"outline",className:`text-xs ${c[a]||c.slow}`,children:[(0,d.jsx)(z.A,{className:"h-3 w-3 mr-1"}),b?`${b}ms`:a]})};return(0,d.jsxs)(g.Zp,{className:`glass border-white/10 ${n}`,children:[(0,d.jsx)(g.aR,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)(g.ZB,{className:"flex items-center text-white",children:[(0,d.jsx)(A.A,{className:"mr-2 h-5 w-5"}),"Select Sensors",(0,d.jsxs)(j.E,{variant:"secondary",className:"ml-2",children:[a.length," / ",m]})]}),(0,d.jsxs)(y.lG,{open:t,onOpenChange:u,children:[(0,d.jsx)(y.zM,{asChild:!0,children:(0,d.jsxs)(i.$,{size:"sm",disabled:a.length>=m,className:"bg-tanium-accent hover:bg-blue-600",children:[(0,d.jsx)(B.A,{className:"mr-1 h-4 w-4"}),"Add Sensor"]})}),(0,d.jsxs)(y.Cf,{className:"max-w-3xl bg-gray-900 border-gray-700",children:[(0,d.jsxs)(y.c7,{children:[(0,d.jsx)(y.L3,{className:"text-white",children:"Browse Sensors"}),(0,d.jsx)(y.rr,{className:"text-gray-400",children:"Select sensors to include in your query"})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(o.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,d.jsx)(w.p,{type:"text",placeholder:"Search sensors...",value:p,onChange:a=>q(a.target.value),className:"pl-10 bg-gray-800 border-gray-600 text-white"})]}),(0,d.jsxs)(h.tU,{value:r,onValueChange:s,children:[(0,d.jsx)(h.j7,{className:"bg-gray-800",children:I.map(a=>(0,d.jsx)(h.Xi,{value:a,children:"all"===a?"All":a},a))}),(0,d.jsxs)(h.av,{value:r,className:"mt-4",children:["all"===r&&""===p&&(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsxs)("h4",{className:"text-sm font-medium text-gray-400 mb-2 flex items-center",children:[(0,d.jsx)(C.A,{className:"mr-1 h-4 w-4"}),"Popular Sensors"]}),(0,d.jsx)("div",{className:"grid grid-cols-2 gap-2",children:K.map(a=>(0,d.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>L(a),className:"justify-start text-left",children:(0,d.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,d.jsx)("span",{className:"text-white",children:"name"in a.sensor?a.sensor.name:""}),M(a.runtime,a.runtimeMs)]})},a.sensor.key||("name"in a.sensor?a.sensor.name:"")))})]}),(0,d.jsx)(x.F,{className:"h-96",children:(0,d.jsx)("div",{className:"space-y-2",children:J.map(a=>(0,d.jsx)("div",{className:"p-3 border border-gray-700 rounded hover:border-gray-600 cursor-pointer",onClick:()=>L(a),children:(0,d.jsxs)("div",{className:"flex items-start justify-between",children:[(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("span",{className:"font-medium text-white",children:"name"in a.sensor?a.sensor.name:""}),a.parameters&&a.parameters.length>0&&(0,d.jsxs)(j.E,{variant:"outline",className:"text-xs",children:[(0,d.jsx)(D.A,{className:"h-3 w-3 mr-1"}),"Parameterized"]})]}),(0,d.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:a.description}),a.examples&&a.examples.length>0&&(0,d.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:["Example: ",a.examples[0]]})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[M(a.runtime,a.runtimeMs),(0,d.jsx)(E.A,{className:"h-4 w-4 text-gray-400"})]})]})},a.sensor.key||("name"in a.sensor?a.sensor.name:"")))})})]})]})]})]})]})]})}),(0,d.jsx)(g.Wu,{children:0===a.length?(0,d.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,d.jsx)(A.A,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,d.jsx)("p",{children:"No sensors selected"}),(0,d.jsx)("p",{className:"text-sm mt-1",children:'Click "Add Sensor" to get started'})]}):(0,d.jsx)("div",{className:"space-y-2",children:a.map((b,e)=>(0,d.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-gray-800 rounded border border-gray-700",children:[(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("span",{className:"font-medium text-white",children:"name"in b.sensor?b.sensor.name:""}),b.filter&&(0,d.jsxs)(j.E,{variant:"outline",className:"text-xs",children:[(0,d.jsx)(F.A,{className:"h-3 w-3 mr-1"}),"Filtered"]}),!b.isValid&&(0,d.jsxs)(j.E,{variant:"destructive",className:"text-xs",children:[(0,d.jsx)(l.A,{className:"h-3 w-3 mr-1"}),"Invalid"]})]}),b.parameters&&Object.keys(b.parameters).length>0&&(0,d.jsx)("div",{className:"mt-2 space-y-2",children:Object.entries(b.parameters).map(([b,c])=>(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsxs)("label",{className:"text-sm text-gray-400 w-24",children:[b,":"]}),(0,d.jsx)(w.p,{type:"text",value:c,onChange:c=>((b,c,d)=>{let e=a[b];f(b,{...e,parameters:{...e.parameters,[c]:d}})})(e,b,c.target.value),className:"flex-1 h-8 bg-gray-700 border-gray-600 text-white"})]},b))}),b.filter&&(0,d.jsxs)("div",{className:"mt-2 text-sm text-gray-400",children:["Filter: ",b.filter.operator,' "',b.filter.value,'"']})]}),(0,d.jsx)(i.$,{size:"sm",variant:"ghost",onClick:()=>c(e),className:"text-gray-400 hover:text-white",children:(0,d.jsx)(G.A,{className:"h-4 w-4"})})]},e))})})]})});var I=c(23227),J=c(67094),K=c(90477),L=c(23201),M=c(72567);let N=(0,q.A)("toggle-left",[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]]);var O=c(85351),P=c(65783);let Q={text:[{value:"contains",label:"Contains"},{value:"does_not_contain",label:"Does not contain"},{value:"equals",label:"Equals"},{value:"not_equals",label:"Not equals"},{value:"starts_with",label:"Starts with"},{value:"ends_with",label:"Ends with"},{value:"matches",label:"Matches (regex)"}],number:[{value:"equals",label:"Equals"},{value:"not_equals",label:"Not equals"},{value:"greater_than",label:"Greater than"},{value:"less_than",label:"Less than"},{value:"greater_or_equal",label:"Greater or equal"},{value:"less_or_equal",label:"Less or equal"}],date:[{value:"equals",label:"On"},{value:"not_equals",label:"Not on"},{value:"greater_than",label:"After"},{value:"less_than",label:"Before"},{value:"greater_or_equal",label:"On or after"},{value:"less_or_equal",label:"On or before"}],boolean:[{value:"equals",label:"Is"},{value:"not_equals",label:"Is not"}]},R={"Computer Name":"text","Operating System":"text","IP Address":"text","CPU Percent":"number","Disk Free GB":"number","Memory GB":"number","Last Reboot":"date","Is Virtual":"boolean","Compliance Score":"number","Last Logged In User":"text"};function S({filters:a,parentId:b,depth:c=0,logic:f,onAdd:g,onRemove:h,onUpdate:k,onLogicChange:l,availableSensors:m,allowNested:n}){let[o,p]=(0,e.useState)(!0),q=a.filter(a=>b?a.parentId===b:!a.parentId),r=[...new Set(a.filter(a=>a.isNested&&a.parentId===b).map(a=>a.id))];return(0,d.jsxs)("div",{className:`space-y-2 ${c>0?"pl-8 border-l-2 border-gray-700":""}`,children:[c>0&&(0,d.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,d.jsx)(J.Nt,{open:o,onOpenChange:p,children:(0,d.jsx)(J.R6,{asChild:!0,children:(0,d.jsx)(i.$,{variant:"ghost",size:"sm",className:"p-1",children:o?(0,d.jsx)(O.A,{className:"h-4 w-4"}):(0,d.jsx)(E.A,{className:"h-4 w-4"})})})}),(0,d.jsx)(j.E,{variant:"secondary",className:"text-xs",children:"Group"}),(0,d.jsxs)(I.Select,{value:f,onValueChange:a=>l(a,b),children:[(0,d.jsx)(I.SelectTrigger,{className:"w-20 h-6 bg-gray-700 border-gray-600",children:(0,d.jsx)(I.SelectValue,{})}),(0,d.jsxs)(I.SelectContent,{children:[(0,d.jsx)(I.SelectItem,{value:"AND",children:"AND"}),(0,d.jsx)(I.SelectItem,{value:"OR",children:"OR"})]})]})]}),(!c||o)&&(0,d.jsxs)(d.Fragment,{children:[q.filter(a=>!a.isNested).map((a,b)=>(0,d.jsxs)("div",{className:"flex items-start space-x-2",children:[b>0&&(0,d.jsx)("div",{className:"w-12 pt-2 text-center",children:(0,d.jsx)(j.E,{variant:"outline",className:`text-xs ${"AND"===f?"border-blue-500 text-blue-400":"border-orange-500 text-orange-400"}`,children:f})}),(0,d.jsxs)("div",{className:`flex-1 flex items-start space-x-2 p-2 bg-gray-800 rounded border border-gray-700 ${0===b?"":"ml-12"}`,children:[(0,d.jsxs)(I.Select,{value:a.sensor,onValueChange:b=>{let c=R[b]||"text";k(a.id,{...a,sensor:b,dataType:c})},children:[(0,d.jsx)(I.SelectTrigger,{className:"w-48 bg-gray-700 border-gray-600",children:(0,d.jsx)(I.SelectValue,{placeholder:"Select sensor"})}),(0,d.jsx)(I.SelectContent,{children:m.map(a=>(0,d.jsx)(I.SelectItem,{value:a,children:(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(a=>{switch(a){case"text":return(0,d.jsx)(K.A,{className:"h-3 w-3"});case"number":return(0,d.jsx)(L.A,{className:"h-3 w-3"});case"date":return(0,d.jsx)(M.A,{className:"h-3 w-3"});case"boolean":return(0,d.jsx)(N,{className:"h-3 w-3"});default:return null}})(R[a]||"text"),(0,d.jsx)("span",{children:a})]})},a))})]}),(0,d.jsxs)(I.Select,{value:a.operator,onValueChange:b=>k(a.id,{...a,operator:b}),children:[(0,d.jsx)(I.SelectTrigger,{className:"w-40 bg-gray-700 border-gray-600",children:(0,d.jsx)(I.SelectValue,{})}),(0,d.jsx)(I.SelectContent,{children:Q[a.dataType].map(a=>(0,d.jsx)(I.SelectItem,{value:a.value,children:a.label},a.value))})]}),"boolean"===a.dataType?(0,d.jsxs)(I.Select,{value:a.value.toString(),onValueChange:b=>k(a.id,{...a,value:"true"===b}),children:[(0,d.jsx)(I.SelectTrigger,{className:"flex-1 bg-gray-700 border-gray-600",children:(0,d.jsx)(I.SelectValue,{})}),(0,d.jsxs)(I.SelectContent,{children:[(0,d.jsx)(I.SelectItem,{value:"true",children:"True"}),(0,d.jsx)(I.SelectItem,{value:"false",children:"False"})]})]}):(0,d.jsx)(w.p,{type:"number"===a.dataType?"number":"date"===a.dataType?"date":"text",value:"boolean"==typeof a.value?String(a.value):a.value,onChange:b=>k(a.id,{...a,value:b.target.value}),placeholder:`Enter ${a.dataType} value`,className:"flex-1 bg-gray-700 border-gray-600 text-white"}),(0,d.jsx)(i.$,{size:"sm",variant:"ghost",onClick:()=>h(a.id),className:"text-gray-400 hover:text-white",children:(0,d.jsx)(G.A,{className:"h-4 w-4"})})]})]},a.id)),r.map(b=>{let e=a.find(a=>a.id===b);return e?(0,d.jsx)(S,{filters:a,parentId:b,depth:c+1,logic:e.logic||"AND",onAdd:g,onRemove:h,onUpdate:k,onLogicChange:l,availableSensors:m,allowNested:n},b):null}),(0,d.jsxs)("div",{className:`flex space-x-2 ${q.length>0?"ml-12":""}`,children:[(0,d.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>{g({id:`filter-${Date.now()}`,sensor:m[0]||"Computer Name",operator:"contains",value:"",dataType:"text",...b&&{parentId:b},logic:"AND"})},className:"text-gray-400 hover:text-white",children:[(0,d.jsx)(B.A,{className:"mr-1 h-3 w-3"}),"Add Filter"]}),n&&c<2&&(0,d.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>{g({id:`group-${Date.now()}`,sensor:"",operator:"equals",value:"",dataType:"text",isNested:!0,...b&&{parentId:b},logic:"AND"})},className:"text-gray-400 hover:text-white",children:[(0,d.jsx)(P.A,{className:"mr-1 h-3 w-3"}),"Add Group"]})]})]})]})}function T({filters:a,onAdd:b,onRemove:c,onUpdate:e,availableSensors:f,filterLogic:h,onLogicChange:j,allowNested:k=!1,className:l=""}){return(0,d.jsxs)(g.Zp,{className:`glass border-white/10 ${l}`,children:[(0,d.jsx)(g.aR,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)(g.ZB,{className:"flex items-center text-white",children:[(0,d.jsx)(F.A,{className:"mr-2 h-5 w-5"}),"Filter Conditions"]}),a.length>1&&(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("span",{className:"text-sm text-gray-400",children:"Logic:"}),(0,d.jsxs)(I.Select,{value:h,onValueChange:a=>j(a),children:[(0,d.jsx)(I.SelectTrigger,{className:"w-20 h-8 bg-gray-700 border-gray-600",children:(0,d.jsx)(I.SelectValue,{})}),(0,d.jsxs)(I.SelectContent,{children:[(0,d.jsx)(I.SelectItem,{value:"AND",children:"AND"}),(0,d.jsx)(I.SelectItem,{value:"OR",children:"OR"})]})]})]})]})}),(0,d.jsx)(g.Wu,{children:0===a.length?(0,d.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,d.jsx)(F.A,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,d.jsx)("p",{children:"No filters applied"}),(0,d.jsx)("p",{className:"text-sm mt-1",children:"Add filters to narrow down results"}),(0,d.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>{b({id:`filter-${Date.now()}`,sensor:f[0]||"Computer Name",operator:"contains",value:"",dataType:"text",logic:"AND"})},className:"mt-4",children:[(0,d.jsx)(B.A,{className:"mr-1 h-3 w-3"}),"Add First Filter"]})]}):(0,d.jsx)(S,{filters:a,depth:0,logic:h,onAdd:b,onRemove:c,onUpdate:e,onLogicChange:j,availableSensors:f,allowNested:k})})]})}var U=c(3368),V=c(72380);let W=(0,q.A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);function X({query:a,validation:b,syntaxHighlight:c=!0,showWarnings:h=!0,className:o=""}){let[p,q]=f().useState(!1),[r,s]=f().useState(!1),t=(0,e.useMemo)(()=>{if(a.rawQuery&&a.rawQuery.trim())return a.rawQuery;let b=[];if(a.sensors.length>0||a.aggregates.length>0){b.push("Get");let c=a.sensors.map(a=>{let b="name"in a.sensor&&a.sensor.name||"";return a.filter&&(b+=` ${a.filter.operator} "${a.filter.value}"`),b}),d=a.aggregates.map(a=>`${a.function}(${a.sensor||""})`);b.push([...c,...d].join(" and "))}if(b.push("from"),"all"===a.scope.type?b.push("all machines"):"group"===a.scope.type&&a.scope.computerGroup?b.push(`group "${a.scope.computerGroup}"`):"custom"===a.scope.type&&a.scope.customFilter&&b.push("all machines"),a.filters.length>0){b.push("where");let c=a.filters.map(a=>`${a.sensor} ${a.operator.replace("_"," ")} "${a.value}"`);b.push(c.join(` ${a.filterLogic.toLowerCase()} `))}if(a.groupBy.length>0&&(b.push("group by"),b.push(a.groupBy.join(", "))),a.orderBy.length>0){b.push("order by");let c=a.orderBy.map(a=>`${a.sensor} ${a.direction}`);b.push(c.join(", "))}return a.limit&&b.push(`limit ${a.limit}`),b.join(" ")},[a]),u=(0,e.useMemo)(()=>{if(!c||p)return t;let a=t;return["Get","from","where","with","group by","order by","limit","and","or","all machines","group"].forEach(b=>{let c=RegExp(`\\b(${b})\\b`,"gi");a=a.replace(c,'<span class="text-blue-400 font-semibold">$1</span>')}),["contains","does not contain","equals","not equals","greater than","less than","starts with","ends with","matches"].forEach(b=>{let c=RegExp(`\\b(${b})\\b`,"gi");a=a.replace(c,'<span class="text-purple-400">$1</span>')}),["count","min","max","avg","sum"].forEach(b=>{let c=RegExp(`\\b(${b})\\(`,"gi");a=a.replace(c,'<span class="text-green-400">$1</span>(')}),a=(a=a.replace(/"([^"]*)"/g,'<span class="text-yellow-400">"$1"</span>')).replace(/\b(\d+)\b/g,'<span class="text-orange-400">$1</span>'),["Computer Name","Operating System","IP Address","CPU Percent","Disk Free GB","Memory GB","Last Reboot","Last Logged In User"].forEach(b=>{let c=RegExp(`\\b(${b})\\b`,"gi");a=a.replace(c,'<span class="text-cyan-400">$1</span>')}),a},[t,c,p]);return(0,d.jsxs)(g.Zp,{className:`glass border-white/10 ${o}`,children:[(0,d.jsx)(g.aR,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)(g.ZB,{className:"flex items-center text-white",children:[(0,d.jsx)(v.A,{className:"mr-2 h-5 w-5"}),"Query Preview"]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[b.isValid?b.warnings.length>0?(0,d.jsx)(m.A,{className:"h-4 w-4 text-yellow-500"}):(0,d.jsx)(n.A,{className:"h-4 w-4 text-green-500"}):(0,d.jsx)(l.A,{className:"h-4 w-4 text-red-500"}),(0,d.jsx)(i.$,{size:"sm",variant:"ghost",onClick:()=>q(!p),className:"text-gray-400 hover:text-white",children:p?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(U.A,{className:"mr-1 h-3 w-3"}),"Formatted"]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(V.A,{className:"mr-1 h-3 w-3"}),"Raw"]})}),(0,d.jsx)(i.$,{size:"sm",variant:"ghost",onClick:()=>{navigator.clipboard.writeText(t),s(!0),setTimeout(()=>s(!1),2e3)},className:"text-gray-400 hover:text-white",children:r?(0,d.jsx)(n.A,{className:"h-4 w-4 text-green-400"}):(0,d.jsx)(W,{className:"h-4 w-4"})})]})]})}),(0,d.jsxs)(g.Wu,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"p-4 bg-gray-900 rounded border border-gray-700 font-mono text-sm overflow-x-auto",style:{minHeight:"60px"},children:t?p?(0,d.jsx)("pre",{className:"text-gray-300 whitespace-pre-wrap",children:t}):(0,d.jsx)("div",{className:"text-gray-300",dangerouslySetInnerHTML:{__html:u}}):(0,d.jsx)("span",{className:"text-gray-500 italic",children:"Start building your query above..."})}),!t&&(0,d.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,d.jsx)(j.E,{variant:"outline",className:"border-gray-600 text-gray-400",children:"Empty Query"})})]}),b.errors.length>0&&(0,d.jsxs)(k.Fc,{className:"border-red-500 bg-red-500/10",children:[(0,d.jsx)(l.A,{className:"h-4 w-4 text-red-500"}),(0,d.jsxs)(k.TN,{className:"text-red-400",children:[(0,d.jsx)("div",{className:"font-semibold mb-1",children:"Query Errors:"}),(0,d.jsx)("ul",{className:"list-disc list-inside space-y-1",children:b.errors.map((a,b)=>(0,d.jsxs)("li",{className:"text-sm",children:[a.field&&(0,d.jsxs)("span",{className:"font-mono",children:[a.field,": "]}),a.message]},b))})]})]}),h&&b.warnings.length>0&&(0,d.jsxs)(k.Fc,{className:"border-yellow-500 bg-yellow-500/10",children:[(0,d.jsx)(m.A,{className:"h-4 w-4 text-yellow-500"}),(0,d.jsxs)(k.TN,{className:"text-yellow-400",children:[(0,d.jsx)("div",{className:"font-semibold mb-1",children:"Warnings:"}),(0,d.jsx)("ul",{className:"list-disc list-inside space-y-1",children:b.warnings.map((a,b)=>(0,d.jsxs)("li",{className:"text-sm",children:[a.field&&(0,d.jsxs)("span",{className:"font-mono",children:[a.field,": "]}),a.message,a.suggestion&&(0,d.jsxs)("div",{className:"ml-4 text-xs text-yellow-300 mt-0.5",children:["\uD83D\uDCA1 ",a.suggestion]})]},b))})]})]}),b.isValid&&t&&(0,d.jsxs)(k.Fc,{className:"border-green-500 bg-green-500/10",children:[(0,d.jsx)(n.A,{className:"h-4 w-4 text-green-500"}),(0,d.jsx)(k.TN,{className:"text-green-400",children:"Query is valid and ready to execute"})]}),t&&(0,d.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a.sensors.length>0&&(0,d.jsxs)(j.E,{variant:"outline",className:"text-xs",children:[a.sensors.length," sensor",1!==a.sensors.length?"s":""]}),a.aggregates.length>0&&(0,d.jsxs)(j.E,{variant:"outline",className:"text-xs",children:[a.aggregates.length," aggregate",1!==a.aggregates.length?"s":""]}),a.filters.length>0&&(0,d.jsxs)(j.E,{variant:"outline",className:"text-xs",children:[a.filters.length," filter",1!==a.filters.length?"s":""]}),a.groupBy.length>0&&(0,d.jsxs)(j.E,{variant:"outline",className:"text-xs",children:["Grouped by ",a.groupBy.length," field",1!==a.groupBy.length?"s":""]}),a.orderBy.length>0&&(0,d.jsxs)(j.E,{variant:"outline",className:"text-xs",children:["Sorted by ",a.orderBy.length," field",1!==a.orderBy.length?"s":""]}),a.limit&&(0,d.jsxs)(j.E,{variant:"outline",className:"text-xs",children:["Limited to ",a.limit," rows"]})]})]})]})}var Y=c(79202);let Z=(0,q.A)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),$=(0,q.A)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),_=(0,q.A)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var aa=c(14263),ab=c(3663);let ac=(0,q.A)("file-json",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),ad=(0,q.A)("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);var ae=c(15952),af=c(8294),ag=c(82042);function ah({data:a,columns:b,rowHeight:c=48,containerHeight:f=600,onRowClick:h,className:k="",emptyMessage:m="No results found",loading:n=!1,striped:o=!0,highlightOnHover:p=!0}){let q=(0,e.useRef)(null),[r,s]=(0,e.useState)(0),[t,u]=(0,e.useState)({key:null,direction:"asc"});(0,e.useCallback)(()=>{q.current&&s(q.current.scrollTop)},[]);let v=(0,e.useMemo)(()=>t.key?[...a].sort((a,b)=>{let c=a[t.key],d=b[t.key];if(null==c)return 1;if(null==d)return -1;if("string"==typeof c){let a=c.localeCompare(d);return"asc"===t.direction?a:-a}return c<d?"asc"===t.direction?-1:1:c>d?"asc"===t.direction?1:-1:0}):a,[a,t]),{visibleItems:w,startIndex:x,offsetY:y,totalHeight:z}=(0,e.useMemo)(()=>(function(a,b,c,d){let e=a.length*c,f=Math.floor(d/c),g=Math.min(a.length-1,Math.floor((d+b)/c)),h=Math.max(0,f-5),i=Math.min(a.length-1,g+5);return{visibleItems:a.slice(h,i+1),startIndex:h,endIndex:i,offsetY:h*c,totalHeight:e}})(v,f,c,r),[v,f,c,r]),B=(0,e.useCallback)((a,b,c)=>{("Enter"===a.key||" "===a.key)&&(a.preventDefault(),h?.(b,c))},[h]);return n?(0,d.jsx)(g.Zp,{className:`glass border-white/10 ${k}`,children:(0,d.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-tanium-accent mx-auto"}),(0,d.jsx)("p",{className:"mt-4 text-gray-400",children:"Loading results..."})]})})}):0===a.length?(0,d.jsx)(g.Zp,{className:`glass border-white/10 ${k}`,children:(0,d.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,d.jsxs)("div",{className:"text-center text-gray-400",children:[(0,d.jsx)(A.A,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,d.jsx)("p",{children:m})]})})}):(0,d.jsxs)(g.Zp,{className:`glass border-white/10 overflow-hidden ${k}`,children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(A.A,{className:"h-5 w-5 text-tanium-accent"}),(0,d.jsx)("span",{className:"font-medium text-white",children:"Query Results"}),(0,d.jsxs)(j.E,{variant:"secondary",children:[a.length.toLocaleString()," rows"]})]}),w.length<a.length&&(0,d.jsxs)(j.E,{variant:"outline",className:"text-xs",children:["Showing ",x+1,"-",x+w.length," of ",a.length]})]}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"sticky top-0 z-10 bg-gray-800 border-b border-gray-700",children:(0,d.jsx)(Y.XI,{children:(0,d.jsx)(Y.A0,{children:(0,d.jsx)(Y.Hj,{className:"hover:bg-transparent",children:b.map(a=>(0,d.jsx)(Y.nd,{style:{width:a.width},className:"text-gray-300",children:!1!==a.sortable?(0,d.jsxs)(i.$,{variant:"ghost",size:"sm",onClick:()=>{var b;return b=a.key,void u(a=>({key:b,direction:a.key===b&&"asc"===a.direction?"desc":"asc"}))},className:"h-auto p-0 font-medium text-gray-300 hover:text-white",children:[a.label,t.key===a.key&&(0,d.jsx)("span",{className:"ml-2",children:"asc"===t.direction?(0,d.jsx)(ag.A,{className:"h-3 w-3"}):(0,d.jsx)(O.A,{className:"h-3 w-3"})})]}):a.label},a.key))})})})}),(0,d.jsx)("div",{ref:q,className:"overflow-auto",style:{height:f},role:"region","aria-label":"Query results table",children:(0,d.jsx)("div",{style:{height:z,position:"relative"},children:(0,d.jsx)("div",{style:{transform:`translateY(${y}px)`,position:"absolute",top:0,left:0,right:0},children:(0,d.jsx)(Y.XI,{children:(0,d.jsx)(Y.BF,{children:w.map((a,e)=>{let f=x+e;return(0,d.jsx)(Y.Hj,{className:`
                          ${o&&f%2==0?"bg-gray-800/50":""}
                          ${p?"hover:bg-gray-700/50":""}
                          ${h?"cursor-pointer":""}
                          transition-colors
                        `,style:{height:c},onClick:()=>h?.(a,f),onKeyDown:b=>B(b,a,f),tabIndex:h?0:void 0,role:h?"button":void 0,"aria-label":h?`Row ${f+1}`:void 0,children:b.map(b=>(0,d.jsx)(Y.nA,{style:{width:b.width},className:"text-gray-300",children:b.render?b.render(a[b.key],a):a[b.key]?.toString()||"-"},b.key))},f)})})})})})})]}),a.length>1e3&&(0,d.jsx)("div",{className:"p-2 border-t border-gray-700 bg-gray-800/50",children:(0,d.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[(0,d.jsx)(l.A,{className:"h-3 w-3"}),(0,d.jsxs)("span",{children:["Virtual scrolling enabled for optimal performance with ",a.length.toLocaleString()," rows"]})]})})]})}function ai({result:a,isLoading:b=!1,onExport:c,onSort:f,pageSize:m=50,className:p=""}){let[q,r]=(0,e.useState)(1),[s,t]=(0,e.useState)(""),[u,v]=(0,e.useState)(null),[y,z]=(0,e.useState)("asc"),[B,C]=(0,e.useState)("table"),[D,F]=(0,e.useState)(!1),G=(0,e.useMemo)(()=>{if(!a||!a.rows)return[];let b=[...a.rows];if(s){let a=s.toLowerCase();b=b.filter(b=>b.some(b=>String(b).toLowerCase().includes(a)))}if(null!==u&&a.headers){let c=a.headers.indexOf(u);c>=0&&b.sort((a,b)=>{let d=a[c],e=b[c];if(null==d)return 1;if(null==e)return -1;let f=d<e?-1:+(d>e);return"asc"===y?f:-f})}return b},[a,s,u,y]);(0,e.useMemo)(()=>{G.length>1e3&&!D&&(F(!0),C("virtual"))},[G.length,D]);let H=(0,e.useMemo)(()=>a&&a.headers&&G?G.map(b=>{let c={};return a.headers?.forEach((a,d)=>{c[a]=b[d]}),c}):[],[a,G]),J=(0,e.useMemo)(()=>a&&a.headers?a.headers.map(a=>({key:a,label:a,sortable:!0,render:a=>null==a?(0,d.jsx)("span",{className:"text-gray-500 italic",children:"null"}):"boolean"==typeof a?(0,d.jsx)(j.E,{variant:"outline",className:a?"border-green-500 text-green-400":"border-red-500 text-red-400",children:String(a)}):String(a)})):[],[a]),K=Math.ceil(G.length/m),L=(0,e.useMemo)(()=>{let a=(q-1)*m;return G.slice(a,a+m)},[G,q,m]),M=(0,e.useCallback)(a=>{u===a?z(a=>"asc"===a?"desc":"asc"):(v(a),z("asc")),f&&f(a,"asc"===y?"desc":"asc")},[u,y,f]),N=(0,e.useCallback)(b=>{if(a&&a.rows&&c)if("csv"===b&&a.csv){let b=new Blob([a.csv],{type:"text/csv"}),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`query-results-${Date.now()}.csv`,d.click(),URL.revokeObjectURL(c)}else c(b)},[a,c]);return b?(0,d.jsx)(g.Zp,{className:`glass border-white/10 ${p}`,children:(0,d.jsx)(g.Wu,{className:"flex items-center justify-center py-12",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(aa.A,{className:"h-8 w-8 animate-spin text-tanium-accent mx-auto mb-3"}),(0,d.jsx)("p",{className:"text-gray-400",children:"Executing query..."})]})})}):a&&!a.ok?(0,d.jsxs)(g.Zp,{className:`glass border-white/10 ${p}`,children:[(0,d.jsx)(g.aR,{children:(0,d.jsxs)(g.ZB,{className:"flex items-center text-white",children:[(0,d.jsx)(A.A,{className:"mr-2 h-5 w-5"}),"Query Results"]})}),(0,d.jsx)(g.Wu,{children:(0,d.jsxs)(k.Fc,{className:"border-red-500 bg-red-500/10",children:[(0,d.jsx)(l.A,{className:"h-4 w-4 text-red-500"}),(0,d.jsxs)(k.TN,{className:"text-red-400",children:[(0,d.jsx)("div",{className:"font-semibold",children:"Query execution failed"}),(0,d.jsx)("div",{className:"mt-1 text-sm",children:a.error})]})]})})]}):a&&a.rows&&0!==a.rows.length?(0,d.jsxs)(g.Zp,{className:`glass border-white/10 ${p}`,children:[(0,d.jsx)(g.aR,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)(g.ZB,{className:"flex items-center text-white",children:[(0,d.jsx)(A.A,{className:"mr-2 h-5 w-5"}),"Query Results",(0,d.jsxs)(j.E,{variant:"secondary",className:"ml-2",children:[G.length," ",1===G.length?"row":"rows"]})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)(o.A,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,d.jsx)(w.p,{type:"text",placeholder:"Search results...",value:s,onChange:a=>{t(a.target.value),r(1)},className:"pl-8 w-48 h-8 bg-gray-800 border-gray-600 text-white"})]}),c&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(i.$,{size:"sm",variant:"ghost",onClick:()=>N("csv"),className:"text-gray-400 hover:text-white",children:[(0,d.jsx)(ab.A,{className:"mr-1 h-3 w-3"}),"CSV"]}),(0,d.jsxs)(i.$,{size:"sm",variant:"ghost",onClick:()=>N("json"),className:"text-gray-400 hover:text-white",children:[(0,d.jsx)(ac,{className:"mr-1 h-3 w-3"}),"JSON"]})]})]})]})}),(0,d.jsxs)(g.Wu,{className:"space-y-4",children:[a.execution&&(0,d.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,d.jsxs)(j.E,{variant:"outline",className:"text-xs border-green-500 text-green-400",children:[(0,d.jsx)(n.A,{className:"mr-1 h-3 w-3"}),"Success"]}),(0,d.jsxs)(j.E,{variant:"outline",className:"text-xs",children:["Execution: ",a.execution.totalTimeMs,"ms"]}),a.execution.cacheHit&&(0,d.jsx)(j.E,{variant:"outline",className:"text-xs border-blue-500 text-blue-400",children:"Cached"}),void 0!==a.execution.rowsExamined&&(0,d.jsxs)(j.E,{variant:"outline",className:"text-xs",children:["Examined: ",a.execution.rowsExamined," rows"]})]}),G.length>100&&(0,d.jsx)(h.tU,{value:B,onValueChange:a=>C(a),children:(0,d.jsxs)(h.j7,{className:"bg-gray-800",children:[(0,d.jsxs)(h.Xi,{value:"table",children:[(0,d.jsx)(ad,{className:"h-4 w-4 mr-2"}),"Paginated"]}),(0,d.jsxs)(h.Xi,{value:"virtual",children:[(0,d.jsx)(ae.A,{className:"h-4 w-4 mr-2"}),"Virtual Scroll",G.length>1e3&&(0,d.jsx)(j.E,{variant:"secondary",className:"ml-2 text-xs",children:"Recommended"})]}),(0,d.jsxs)(h.Xi,{value:"summary",children:[(0,d.jsx)(U.A,{className:"h-4 w-4 mr-2"}),"Summary"]})]})}),"table"===B&&(0,d.jsxs)(x.F,{className:"w-full",children:[(0,d.jsxs)(Y.XI,{children:[(0,d.jsx)(Y.A0,{children:(0,d.jsx)(Y.Hj,{className:"border-gray-700",children:a.headers?.map((a,b)=>(0,d.jsx)(Y.nd,{className:"text-gray-300 cursor-pointer hover:text-white",onClick:()=>M(a),children:(0,d.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,d.jsx)("span",{children:a}),u!==a?(0,d.jsx)(Z,{className:"h-3 w-3 opacity-50"}):"asc"===y?(0,d.jsx)($,{className:"h-3 w-3"}):(0,d.jsx)(_,{className:"h-3 w-3"})]})},b))})}),(0,d.jsx)(Y.BF,{children:L.map((a,b)=>(0,d.jsx)(Y.Hj,{className:"border-gray-700",children:a.map((a,b)=>(0,d.jsx)(Y.nA,{className:"text-gray-300",children:null==a?(0,d.jsx)("span",{className:"text-gray-500 italic",children:"null"}):"boolean"==typeof a?(0,d.jsx)(j.E,{variant:"outline",className:a?"border-green-500 text-green-400":"border-red-500 text-red-400",children:String(a)}):String(a)},b))},b))})]}),(0,d.jsx)(x.$,{orientation:"horizontal"})]}),"virtual"===B&&(0,d.jsx)(ah,{data:H,columns:J,rowHeight:48,containerHeight:600,striped:!0,highlightOnHover:!0}),"summary"===B&&(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,d.jsx)(g.Zp,{className:"glass border-white/10",children:(0,d.jsxs)(g.Wu,{className:"p-4",children:[(0,d.jsx)("div",{className:"text-2xl font-bold text-white",children:G.length}),(0,d.jsx)("div",{className:"text-sm text-gray-400",children:"Total Rows"})]})}),(0,d.jsx)(g.Zp,{className:"glass border-white/10",children:(0,d.jsxs)(g.Wu,{className:"p-4",children:[(0,d.jsx)("div",{className:"text-2xl font-bold text-white",children:a.headers?.length||0}),(0,d.jsx)("div",{className:"text-sm text-gray-400",children:"Columns"})]})}),a.execution&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.Zp,{className:"glass border-green-500/50",children:(0,d.jsxs)(g.Wu,{className:"p-4",children:[(0,d.jsxs)("div",{className:"text-2xl font-bold text-green-400",children:[a.execution.totalTimeMs,"ms"]}),(0,d.jsx)("div",{className:"text-sm text-gray-400",children:"Query Time"})]})}),void 0!==a.execution.rowsExamined&&(0,d.jsx)(g.Zp,{className:"glass border-blue-500/50",children:(0,d.jsxs)(g.Wu,{className:"p-4",children:[(0,d.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:a.execution.rowsExamined}),(0,d.jsx)("div",{className:"text-sm text-gray-400",children:"Rows Examined"})]})})]})]}),(0,d.jsxs)("div",{className:"mt-4",children:[(0,d.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Data Preview (First 10 rows)"}),(0,d.jsx)("div",{className:"bg-gray-800 rounded-lg p-4 overflow-auto max-h-64",children:(0,d.jsx)("pre",{className:"text-xs text-gray-300 font-mono",children:JSON.stringify(H.slice(0,10),null,2)})})]})]}),"table"===B&&K>1&&(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"text-sm text-gray-400",children:["Showing ",(q-1)*m+1," to"," ",Math.min(q*m,G.length)," of"," ",G.length," results"]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)(i.$,{size:"sm",variant:"ghost",onClick:()=>r(a=>Math.max(1,a-1)),disabled:1===q,children:(0,d.jsx)(af.A,{className:"h-4 w-4"})}),(0,d.jsxs)(I.Select,{value:String(q),onValueChange:a=>r(Number(a)),children:[(0,d.jsx)(I.SelectTrigger,{className:"w-20 h-8 bg-gray-800 border-gray-600",children:(0,d.jsx)(I.SelectValue,{})}),(0,d.jsx)(I.SelectContent,{children:Array.from({length:K},(a,b)=>b+1).map(a=>(0,d.jsx)(I.SelectItem,{value:String(a),children:a},a))})]}),(0,d.jsxs)("span",{className:"text-sm text-gray-400",children:["of ",K]}),(0,d.jsx)(i.$,{size:"sm",variant:"ghost",onClick:()=>r(a=>Math.min(K,a+1)),disabled:q===K,children:(0,d.jsx)(E.A,{className:"h-4 w-4"})})]})]})]})]}):(0,d.jsxs)(g.Zp,{className:`glass border-white/10 ${p}`,children:[(0,d.jsx)(g.aR,{children:(0,d.jsxs)(g.ZB,{className:"flex items-center text-white",children:[(0,d.jsx)(A.A,{className:"mr-2 h-5 w-5"}),"Query Results"]})}),(0,d.jsx)(g.Wu,{children:(0,d.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,d.jsx)(A.A,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,d.jsx)("p",{children:"No results found"}),a&&a.execution&&(0,d.jsxs)("p",{className:"text-sm mt-2",children:["Query executed in ",a.execution.totalTimeMs,"ms"]})]})})]})}let aj=[{pattern:/show\s+(?:me\s+)?all\s+(.+)/i,type:"list"},{pattern:/get\s+(.+)\s+from\s+(.+)/i,type:"query"},{pattern:/find\s+(.+)\s+where\s+(.+)/i,type:"filter"},{pattern:/count\s+(.+)/i,type:"aggregate"},{pattern:/how\s+many\s+(.+)/i,type:"count"},{pattern:/top\s+(\d+)\s+(.+)/i,type:"limit"},{pattern:/(.+)\s+with\s+(.+)\s+(?:greater|more|higher)\s+than\s+(.+)/i,type:"comparison"},{pattern:/(.+)\s+(?:contains|containing)\s+(.+)/i,type:"contains"}],ak={"Computer Name":["computer","machine","endpoint","device","name","hostname"],"Operating System":["os","operating system","windows","linux","mac","platform"],"IP Address":["ip","address","network","ip address"],"CPU Percent":["cpu","processor","cpu usage","processor usage","cpu percent"],"Memory GB":["memory","ram","mem","memory usage"],"Disk Free GB":["disk","storage","disk space","free space","available space"],"Last Logged In User":["user","logged in","last user","username"],"Last Reboot":["reboot","restart","boot time","uptime"],"Compliance Score":["compliance","score","compliance score","security score"],"Is Virtual":["virtual","vm","virtual machine","virtualized"]},al={contains:["contains","containing","includes","including","with"],equals:["equals","is","equal to","exactly"],greater_than:["greater than","more than","higher than","above",">"],less_than:["less than","lower than","below","under","<"],starts_with:["starts with","beginning with","starting"],ends_with:["ends with","ending with","ending"]},am=[{sensor:{name:"Computer Name",key:"computer_name",type:"text",category:"System"},category:"System",description:"The name of the computer or endpoint",examples:["PC-001","SERVER-WEB-01"],runtime:"fast",runtimeMs:10,popularity:.95,columns:["Computer Name"]},{sensor:{name:"Operating System",key:"os_platform",type:"text",category:"System"},category:"System",description:"The operating system platform",examples:["Windows 10","Windows Server 2019","macOS","Linux"],runtime:"fast",runtimeMs:15,popularity:.9,columns:["Operating System"]},{sensor:{name:"IP Address",key:"ip_address",type:"text",category:"Network"},category:"Network",description:"The IP address of the endpoint",examples:["192.168.1.100","10.0.0.50"],runtime:"fast",runtimeMs:20,popularity:.85,columns:["IP Address"]},{sensor:{name:"CPU Percent",key:"cpu_percent",type:"number",category:"Performance"},category:"Performance",description:"Current CPU usage percentage",examples:["25.5","80.3"],runtime:"medium",runtimeMs:100,popularity:.75,columns:["CPU Percent"]},{sensor:{name:"Memory GB",key:"memory_gb",type:"number",category:"Performance"},category:"Performance",description:"Total memory in gigabytes",examples:["16","32","8"],runtime:"fast",runtimeMs:25,popularity:.7,columns:["Memory GB"]},{sensor:{name:"Disk Free GB",key:"disk_free_gb",type:"number",category:"Storage"},category:"Storage",description:"Available disk space in gigabytes",examples:["250.5","45.2"],runtime:"medium",runtimeMs:150,popularity:.8,columns:["Disk Free GB"]},{sensor:{name:"Last Logged In User",key:"last_logged_in_user",type:"text",category:"Security"},category:"Security",description:"The username of the last logged in user",examples:["john.doe","admin"],runtime:"fast",runtimeMs:30,popularity:.65,columns:["Last Logged In User"]},{sensor:{name:"Last Reboot",key:"last_reboot",type:"date",category:"System"},category:"System",description:"Date and time of last system reboot",examples:["2024-01-15 10:30:00"],runtime:"fast",runtimeMs:35,popularity:.6,columns:["Last Reboot"]},{sensor:{name:"Compliance Score",key:"compliance_score",type:"number",category:"Security"},category:"Security",description:"Security compliance score (0-1)",examples:["0.85","0.92"],runtime:"slow",runtimeMs:500,popularity:.55,columns:["Compliance Score"]},{sensor:{name:"Is Virtual",key:"is_virtual",type:"boolean",category:"System"},category:"System",description:"Whether the machine is a virtual machine",examples:["true","false"],runtime:"fast",runtimeMs:15,popularity:.5,columns:["Is Virtual"]},{sensor:{name:"Installed Applications",key:"installed_apps",type:"text",category:"Software"},category:"Software",description:"List of installed applications",examples:["Microsoft Office","Google Chrome"],runtime:"slow",runtimeMs:800,popularity:.7,columns:["Name","Version","Publisher"],parameters:[{name:"filter",type:"text",required:!1,description:"Filter applications by name",default:""}]},{sensor:{name:"Running Processes",key:"processes",type:"text",category:"Performance"},category:"Performance",description:"List of currently running processes",runtime:"medium",runtimeMs:200,popularity:.45,columns:["Process Name","PID","CPU %","Memory MB"],parameters:[{name:"top",type:"number",required:!1,description:"Limit to top N processes by CPU",default:10}]},{sensor:{name:"Network Connections",key:"network_connections",type:"text",category:"Network"},category:"Network",description:"Active network connections",runtime:"medium",runtimeMs:250,popularity:.4,columns:["Protocol","Local Address","Remote Address","State"]},{sensor:{name:"Windows Updates",key:"windows_updates",type:"text",category:"Software"},category:"Software",description:"Windows update status and history",runtime:"slow",runtimeMs:600,popularity:.65,columns:["Update Name","Status","Date"],parameters:[{name:"days",type:"number",required:!1,description:"Updates from last N days",default:30}]},{sensor:{name:"Service Status",key:"service_status",type:"text",category:"System"},category:"System",description:"Status of Windows services",runtime:"medium",runtimeMs:180,popularity:.35,columns:["Service Name","Display Name","Status","Startup Type"],parameters:[{name:"service",type:"text",required:!0,description:"Service name to check"}]},{sensor:{name:"Registry Value",key:"registry_value",type:"text",category:"System"},category:"System",description:"Read Windows registry values",runtime:"fast",runtimeMs:50,popularity:.3,columns:["Key","Value Name","Value"],parameters:[{name:"key",type:"text",required:!0,description:"Registry key path"},{name:"value",type:"text",required:!1,description:"Value name (optional)"}]},{sensor:{name:"File Hash",key:"file_hash",type:"text",category:"Security"},category:"Security",description:"Calculate file hash (MD5, SHA1, SHA256)",runtime:"medium",runtimeMs:300,popularity:.25,columns:["File Path","MD5","SHA1","SHA256"],parameters:[{name:"path",type:"text",required:!0,description:"File path"},{name:"algorithm",type:"select",required:!1,description:"Hash algorithm",default:"SHA256",options:[{value:"MD5",label:"MD5"},{value:"SHA1",label:"SHA1"},{value:"SHA256",label:"SHA256"}]}]}];var an=function(a){return a.GET="GET",a.FROM="FROM",a.WHERE="WHERE",a.WITH="WITH",a.GROUP_BY="GROUP_BY",a.ORDER_BY="ORDER_BY",a.LIMIT="LIMIT",a.AND="AND",a.CONTAINS="CONTAINS",a.DOES_NOT_CONTAIN="DOES_NOT_CONTAIN",a.EQUALS="EQUALS",a.IS_GREATER_THAN="IS_GREATER_THAN",a.IS_LESS_THAN="IS_LESS_THAN",a.STARTS_WITH="STARTS_WITH",a.ENDS_WITH="ENDS_WITH",a.COUNT="COUNT",a.MIN="MIN",a.MAX="MAX",a.AVG="AVG",a.SUM="SUM",a.IDENTIFIER="IDENTIFIER",a.STRING="STRING",a.NUMBER="NUMBER",a.COMMA="COMMA",a.LPAREN="LPAREN",a.RPAREN="RPAREN",a.DOT="DOT",a.EOF="EOF",a.UNKNOWN="UNKNOWN",a}({});class ao extends Error{constructor(a,b,c,d,e="error"){super(a),this.position=b,this.line=c,this.column=d,this.severity=e,this.name="QueryError"}}class ap extends ao{constructor(a,b){super(a,b?.position,b?.line,b?.column),this.name="ParseError"}}class aq extends ao{constructor(a,b){super(a),this.code=b,this.name="ExecutionError"}}class ar{static{this.KEYWORDS=new Map([["get",an.GET],["from",an.FROM],["where",an.WHERE],["with",an.WITH],["group",an.GROUP_BY],["by",an.GROUP_BY],["order",an.ORDER_BY],["limit",an.LIMIT],["and",an.AND],["contains",an.CONTAINS],["does",an.DOES_NOT_CONTAIN],["not",an.DOES_NOT_CONTAIN],["contain",an.DOES_NOT_CONTAIN],["equals",an.EQUALS],["is",an.IS_GREATER_THAN],["greater",an.IS_GREATER_THAN],["less",an.IS_LESS_THAN],["than",an.IS_GREATER_THAN],["starts",an.STARTS_WITH],["ends",an.ENDS_WITH],["count",an.COUNT],["min",an.MIN],["max",an.MAX],["avg",an.AVG],["sum",an.SUM]])}static{this.OPERATOR_PATTERNS=[{pattern:/^does\s+not\s+contain/i,type:an.DOES_NOT_CONTAIN},{pattern:/^is\s+greater\s+than/i,type:an.IS_GREATER_THAN},{pattern:/^is\s+less\s+than/i,type:an.IS_LESS_THAN},{pattern:/^starts\s+with/i,type:an.STARTS_WITH},{pattern:/^ends\s+with/i,type:an.ENDS_WITH},{pattern:/^group\s+by/i,type:an.GROUP_BY},{pattern:/^order\s+by/i,type:an.ORDER_BY}]}constructor(a){this.position=0,this.line=1,this.column=1,this.tokens=[],this.input=a}tokenize(){for(this.tokens=[],this.position=0,this.line=1,this.column=1;!this.isEOF()&&(this.skipWhitespace(),!this.isEOF());){let a=this.nextToken();a.type!==an.UNKNOWN&&this.tokens.push(a)}return this.tokens.push(this.createToken(an.EOF,"")),this.tokens}nextToken(){let a=this.position,b=this.line,c=this.column;for(let{pattern:d,type:e}of ar.OPERATOR_PATTERNS){let f=this.input.slice(this.position).match(d);if(f&&0===f.index){let d=f[0];return this.advance(d.length),this.createTokenAt(e,d,a,b,c)}}let d=this.peek();if('"'===d||"'"===d)return this.readString();if(this.isDigit(d))return this.readNumber();if(this.isAlpha(d))return this.readIdentifier();switch(d){case",":return this.advance(),this.createTokenAt(an.COMMA,",",a,b,c);case"(":return this.advance(),this.createTokenAt(an.LPAREN,"(",a,b,c);case")":return this.advance(),this.createTokenAt(an.RPAREN,")",a,b,c);case".":return this.advance(),this.createTokenAt(an.DOT,".",a,b,c);default:return this.advance(),this.createTokenAt(an.UNKNOWN,d,a,b,c)}}readString(){let a=this.position,b=this.line,c=this.column,d=this.peek();this.advance();let e="",f=!1;for(;!this.isEOF()&&(f||this.peek()!==d);){let a=this.peek();if(f){switch(a){case"n":e+="\n";break;case"t":e+="	";break;case"r":e+="\r";break;case"\\":e+="\\";break;case'"':e+='"';break;case"'":e+="'";break;default:e+=a}f=!1}else"\\"===a?f=!0:e+=a;this.advance()}if(this.isEOF())throw new ao("Unterminated string literal",a,b,c);return this.advance(),this.createTokenAt(an.STRING,e,a,b,c)}readNumber(){let a=this.position,b=this.line,c=this.column,d="";for(;!this.isEOF()&&this.isDigit(this.peek());)d+=this.peek(),this.advance();if(!this.isEOF()&&"."===this.peek()&&this.isDigit(this.peek(1)))for(d+=this.peek(),this.advance();!this.isEOF()&&this.isDigit(this.peek());)d+=this.peek(),this.advance();return this.createTokenAt(an.NUMBER,d,a,b,c)}readIdentifier(){let a=this.position,b=this.line,c=this.column,d="";for(;!this.isEOF()&&(this.isAlphaNumeric(this.peek())||"_"===this.peek()||" "===this.peek());){let a=this.peek();if(" "===a){let b=this.peek(1);if(!b||!this.isAlpha(b))break;let c=this.input.slice(this.position).match(/^[A-Za-z\s]+/);if(c&&this.isKnownField(c[0].trim()))d+=a,this.advance();else break}else d+=a,this.advance()}let e=(d=d.trim()).toLowerCase(),f=ar.KEYWORDS.get(e);return f?([an.COUNT,an.MIN,an.MAX,an.AVG,an.SUM].includes(f)&&(this.skipWhitespace(),this.peek()),this.createTokenAt(f,d,a,b,c)):this.createTokenAt(an.IDENTIFIER,d,a,b,c)}isKnownField(a){return["computer name","computer role","operating system","os platform","os version","disk free gb","memory gb","cpu percent","compliance score","group name","group","location","last reboot","last seen","service status","ip address","mac address","serial number","manufacturer","model"].includes(a.toLowerCase())}skipWhitespace(){for(;!this.isEOF()&&this.isWhitespace(this.peek());)"\n"===this.peek()?(this.line++,this.column=1):this.column++,this.position++}isWhitespace(a){return/\s/.test(a)}isDigit(a){return/\d/.test(a)}isAlpha(a){return/[a-zA-Z]/.test(a)}isAlphaNumeric(a){return/[a-zA-Z0-9]/.test(a)}peek(a=0){let b=this.position+a;return b>=this.input.length?"\0":this.input[b]}advance(a=1){for(let b=0;b<a;b++)this.position<this.input.length&&("\n"===this.input[this.position]?(this.line++,this.column=1):this.column++,this.position++)}isEOF(){return this.position>=this.input.length}createToken(a,b){return{type:a,value:b,position:this.position,line:this.line,column:this.column}}createTokenAt(a,b,c,d,e){return{type:a,value:b,position:c,line:d,column:e}}getTokens(){return this.tokens}formatTokens(){return this.tokens.map(a=>`${a.type}(${a.value}) @ ${a.line}:${a.column}`).join("\n")}}class as{constructor(a={}){this.tokens=[],this.current=0,this.options={strictMode:!1,allowPartialQueries:!1,maxDepth:100,validateSemantics:!0,...a}}parse(a){let b=new ar(a);this.tokens=b.tokenize(),this.current=0;let c=this.parseQuery();return this.options.validateSemantics&&this.validateQuery(c),c}parseQuery(){let a,b,c,d,e=this.peek();if(!this.match(an.GET))throw new ap('Query must start with "Get"',this.peek());let f=this.parseSelect();if(!this.match(an.FROM))throw new ap('Expected "from" after column list',this.peek());let g=this.parseFrom();return(this.match(an.WHERE)||this.match(an.WITH))&&(a=this.parseWhere()),(this.matchSequence([an.GROUP_BY])||this.check(an.IDENTIFIER)&&this.peekValue()?.toLowerCase()==="group")&&(b=this.parseGroupBy()),(this.matchSequence([an.ORDER_BY])||this.check(an.IDENTIFIER)&&this.peekValue()?.toLowerCase()==="order")&&(c=this.parseOrderBy()),this.match(an.LIMIT)&&(d=this.parseLimit()),{type:"Query",select:f,from:g,where:a,groupBy:b,orderBy:c,limit:d,location:this.createLocation(e,this.previous())}}parseSelect(){let a=this.peek(),b=[],c=[];do if(this.checkAggregate())c.push(this.parseAggregate());else{let a=this.parseColumn();a&&b.push(a)}while(this.match(an.COMMA)||this.check(an.IDENTIFIER)&&this.peekValue()?.toLowerCase()==="and"&&!this.checkAhead(an.FROM));if(0===b.length&&0===c.length)throw new ap("Expected at least one column or aggregate",this.peek());return{type:"Select",columns:b,aggregates:c,location:this.createLocation(a,this.previous())}}parseColumn(){let a=this.peek(),b="";for(;this.check(an.IDENTIFIER)&&(b&&(b+=" "),b+=this.advance().value,this.checkColumnContinuation()););return b?{type:"Column",name:b,location:this.createLocation(a,this.previous())}:null}parseAggregate(){let a,b,c=this.peek(),d=this.advance();switch(d.type){case an.COUNT:a="count";break;case an.MIN:a="min";break;case an.MAX:a="max";break;case an.AVG:a="avg";break;case an.SUM:a="sum";break;default:throw new ap(`Unknown aggregate function: ${d.value}`,d)}if(this.match(an.LPAREN)){if(!this.check(an.RPAREN)){let a=this.parseColumn();a&&(b=a.name)}this.consume(an.RPAREN,"Expected closing parenthesis")}return{type:"Aggregate",function:a,column:b,location:this.createLocation(c,this.previous())}}parseFrom(){let a=this.peek();return{type:"From",scope:this.parseScope(),location:this.createLocation(a,this.previous())}}parseScope(){let a=this.peek();if(this.check(an.IDENTIFIER)){let b=this.peekValue()?.toLowerCase();if("all"===b)return this.advance(),this.check(an.IDENTIFIER)&&this.peekValue()?.toLowerCase()==="machines"&&this.advance(),{type:"Scope",scopeType:"all",location:this.createLocation(a,this.previous())};if("group"===b){this.advance();let b="";if(this.check(an.STRING))b=this.advance().value;else for(;this.check(an.IDENTIFIER)&&(b&&(b+=" "),b+=this.advance().value,this.checkGroupNameContinuation()););return{type:"Scope",scopeType:"group",value:b,location:this.createLocation(a,this.previous())}}}return{type:"Scope",scopeType:"all",location:this.createLocation(a,a)}}parseWhere(){let a=this.previous(),b=[];do b.push(this.parseFilter());while(this.match(an.AND));return{type:"Where",filters:b,location:this.createLocation(a,this.previous())}}parseFilter(){let a,b=this.peek(),c=this.parseColumn();if(!c)throw new ap("Expected field name in filter",this.peek());let d=this.parseOperator();if(this.check(an.STRING))a=this.advance().value;else if(this.check(an.NUMBER))a=parseFloat(this.advance().value);else{let b="";for(;this.check(an.IDENTIFIER)&&(b&&(b+=" "),b+=this.advance().value,this.checkFilterValueContinuation()););a=b}return{type:"Filter",field:c.name,operator:d,value:a,location:this.createLocation(b,this.previous())}}parseOperator(){if(this.match(an.CONTAINS))return"contains";if(this.match(an.DOES_NOT_CONTAIN))return"does_not_contain";if(this.match(an.EQUALS))return"equals";if(this.match(an.IS_GREATER_THAN))return"greater_than";if(this.match(an.IS_LESS_THAN))return"less_than";if(this.match(an.STARTS_WITH))return"starts_with";if(this.match(an.ENDS_WITH))return"ends_with";throw new ap("Expected comparison operator",this.peek())}parseGroupBy(){let a=this.peek();this.check(an.IDENTIFIER)&&this.peekValue()?.toLowerCase()==="group"?(this.advance(),this.check(an.IDENTIFIER)&&this.peekValue()?.toLowerCase()==="by"&&this.advance()):this.check(an.GROUP_BY)&&this.advance();let b=[];do{let a=this.parseColumn();a&&b.push(a.name)}while(this.match(an.COMMA));return{type:"GroupBy",columns:b,location:this.createLocation(a,this.previous())}}parseOrderBy(){let a=this.peek();this.check(an.IDENTIFIER)&&this.peekValue()?.toLowerCase()==="order"?(this.advance(),this.check(an.IDENTIFIER)&&this.peekValue()?.toLowerCase()==="by"&&this.advance()):this.check(an.ORDER_BY)&&this.advance();let b=[];do{let a=this.parseColumn();if(a){let c="asc";if(this.check(an.IDENTIFIER)){let a=this.peekValue()?.toLowerCase();("asc"===a||"desc"===a)&&(c=a,this.advance())}b.push({column:a.name,direction:c})}}while(this.match(an.COMMA));return{type:"OrderBy",columns:b,location:this.createLocation(a,this.previous())}}parseLimit(){let a=this.previous();if(!this.check(an.NUMBER))throw new ap("Expected number after LIMIT",this.peek());return{type:"Limit",value:parseInt(this.advance().value),location:this.createLocation(a,this.previous())}}validateQuery(a){if(a.groupBy){for(let b of a.groupBy.columns)if(!a.select.columns.some(a=>a.name===b)&&0===a.select.aggregates.length)throw new ap(`GROUP BY column "${b}" must appear in SELECT clause`)}if(a.orderBy)for(let b of a.orderBy.columns){let c=a.select.columns.some(a=>a.name===b.column),d=a.groupBy?.columns.includes(b.column);if(!c&&!d)throw new ap(`ORDER BY column "${b.column}" must appear in SELECT or GROUP BY clause`)}}check(a){return!this.isAtEnd()&&this.peek().type===a}checkAggregate(){return[an.COUNT,an.MIN,an.MAX,an.AVG,an.SUM].includes(this.peek().type)}checkAhead(a,b=1){let c=this.current+b;return!(c>=this.tokens.length)&&this.tokens[c].type===a}match(...a){for(let b of a)if(this.check(b))return this.advance(),!0;return!1}matchSequence(a){for(let b=0;b<a.length;b++)if(!this.checkAhead(a[b],b))return!1;for(let b=0;b<a.length;b++)this.advance();return!0}consume(a,b){if(this.check(a))return this.advance();throw new ap(b,this.peek())}advance(){return!this.isAtEnd()&&this.current++,this.previous()}isAtEnd(){return this.peek().type===an.EOF}peek(){return this.tokens[this.current]}peekValue(){return this.tokens[this.current]?.value}previous(){return this.tokens[this.current-1]}checkColumnContinuation(){return![an.FROM,an.WHERE,an.WITH,an.GROUP_BY,an.ORDER_BY,an.LIMIT,an.AND,an.COMMA].includes(this.peek().type)}checkGroupNameContinuation(){return![an.WHERE,an.WITH,an.GROUP_BY,an.ORDER_BY,an.LIMIT].includes(this.peek().type)}checkFilterValueContinuation(){return![an.AND,an.GROUP_BY,an.ORDER_BY,an.LIMIT,an.EOF].includes(this.peek().type)}createLocation(a,b){return{start:a.position,end:b.position+b.value.length,line:a.line,column:a.column}}}let at=new Map([["computer name",{key:"computer_name",type:"text",dbColumn:"computer_name",description:"Endpoint hostname",category:"Core"}],["hostname",{key:"computer_name",type:"text",dbColumn:"computer_name",description:"Endpoint hostname (alias)",category:"Core"}],["computer role",{key:"role",type:"text",dbColumn:"role",description:"Computer role (Workstation, Server, etc.)",category:"Core"}],["role",{key:"role",type:"text",dbColumn:"role",description:"Computer role (alias)",category:"Core"}],["operating system",{key:"os_platform",type:"text",dbColumn:"os_platform",description:"Operating system platform",category:"Core"}],["os platform",{key:"os_platform",type:"text",dbColumn:"os_platform",description:"OS platform (Windows, macOS, Linux)",category:"Core"}],["os version",{key:"os_version",type:"text",dbColumn:"os_version",description:"Operating system version",category:"Core"}],["disk free gb",{key:"disk_free_gb",type:"number",dbColumn:"disk_free_gb",description:"Available disk space in GB",category:"Performance"}],["disk space",{key:"disk_free_gb",type:"number",dbColumn:"disk_free_gb",description:"Available disk space (alias)",category:"Performance"}],["memory gb",{key:"memory_gb",type:"number",dbColumn:"memory_gb",description:"Physical memory in GB",category:"Performance"}],["ram",{key:"memory_gb",type:"number",dbColumn:"memory_gb",description:"RAM in GB (alias)",category:"Performance"}],["cpu percent",{key:"cpu_percent",type:"number",dbColumn:"cpu_percent",description:"CPU utilization percentage",category:"Performance"}],["cpu usage",{key:"cpu_percent",type:"number",dbColumn:"cpu_percent",description:"CPU usage percentage (alias)",category:"Performance"}],["compliance score",{key:"compliance_score",type:"number",dbColumn:"compliance_score",description:"Compliance score (0-1)",category:"Governance"}],["compliance",{key:"compliance_score",type:"number",dbColumn:"compliance_score",description:"Compliance score (alias)",category:"Governance"}],["group",{key:"group_name",type:"text",dbColumn:"group_name",description:"Computer group membership",category:"Metadata"}],["group name",{key:"group_name",type:"text",dbColumn:"group_name",description:"Computer group name",category:"Metadata"}],["location",{key:"location",type:"text",dbColumn:"location",description:"Geographic or network location",category:"Metadata"}],["last reboot",{key:"last_reboot",type:"date",dbColumn:"last_reboot",description:"Last system reboot timestamp",category:"Core"}],["last seen",{key:"last_seen",type:"date",dbColumn:"last_seen",description:"Last time endpoint was seen",category:"Core"}],["ip address",{key:"ip_address",type:"text",dbColumn:"ip_address",description:"Primary IP address",category:"Network"}],["mac address",{key:"mac_address",type:"text",dbColumn:"mac_address",description:"Primary MAC address",category:"Network"}],["serial number",{key:"serial_number",type:"text",dbColumn:"serial_number",description:"Hardware serial number",category:"Asset"}],["manufacturer",{key:"manufacturer",type:"text",dbColumn:"manufacturer",description:"Hardware manufacturer",category:"Asset"}],["model",{key:"model",type:"text",dbColumn:"model",description:"Hardware model",category:"Asset"}]]),au=new Map([["laptops","Laptops"],["servers","Data Center Servers"],["data center servers","Data Center Servers"],["finance","Finance Workstations"],["finance workstations","Finance Workstations"],["canary","Canary Cohort"],["canary cohort","Canary Cohort"],["engineering","Engineering Lab"],["engineering lab","Engineering Lab"],["operations","Operations"],["ops","Operations"],["production","Production Servers"],["prod","Production Servers"],["development","Development Workstations"],["dev","Development Workstations"],["staging","Staging Servers"],["test","Test Environment"]]),av=[{name:"Computer Name",key:"computer_name",category:"Core",type:"text",description:"Returns the endpoint hostname"},{name:"Operating System",key:"os_platform",category:"Core",type:"text",description:"Human-readable OS platform string"},{name:"OS Platform",key:"os_platform",category:"Core",type:"text",description:"Normalized OS platform (Windows, macOS, Linux)"},{name:"OS Version",key:"os_version",category:"Core",type:"text",description:"Version information for the current OS"},{name:"CPU Percent",key:"cpu_percent",category:"Performance",type:"number",description:"Current CPU utilization percentage"},{name:"Memory GB",key:"memory_gb",category:"Performance",type:"number",description:"Physical memory in gigabytes"},{name:"Disk Free GB",key:"disk_free_gb",category:"Performance",type:"number",description:"Available disk capacity in gigabytes"},{name:"Compliance Score",key:"compliance_score",category:"Governance",type:"number",description:"Composite score for patching and configuration compliance"},{name:"Service Status",key:"service_status",category:"Core",type:"text",description:"Status of a given service on the endpoint",parameters:{serviceName:"string"}},{name:"Last Reboot",key:"last_reboot",category:"Core",type:"date",description:"Timestamp of the last reboot"},{name:"Group",key:"group_name",category:"Metadata",type:"text",description:"Logical group membership for the endpoint"},{name:"Location",key:"location",category:"Metadata",type:"text",description:"Geographic or network zone indicator"}],aw=["count()","min()","max()","avg()","sum()"];function ax(a){return at.get(a.toLowerCase().trim())}function ay(a){let b=ax(a);return b?.dbColumn}class az{constructor(a=[],b={}){this.data=[],this.warnings=[],this.data=a,this.options={timeout:5e3,maxRows:1e4,useCache:!0,cacheTTL:6e4,explainOnly:!1,format:"json",...b},this.metrics=this.initMetrics()}initMetrics(){return{parseTimeMs:0,planTimeMs:0,executeTimeMs:0,totalTimeMs:0,scoped:0,filtered:0,rowsExamined:0,cacheHit:!1}}async execute(a){let b=performance.now();this.warnings=[],this.metrics=this.initMetrics();try{let c=performance.now(),d=this.generateQueryPlan(a);if(this.metrics.planTimeMs=performance.now()-c,this.options.explainOnly)return this.createExplainResult(d);let e=performance.now(),f=await this.executePlan(a,d);return this.metrics.executeTimeMs=performance.now()-e,this.metrics.totalTimeMs=performance.now()-b,f.execution={...this.metrics},f.warnings=this.warnings,f}catch(a){if(a instanceof aq)throw a;throw new aq(`Query execution failed: ${a}`)}}generateQueryPlan(a){let b={type:"scan",cost:this.data.length,rows:this.data.length,width:100,children:[]};if("group"===a.from.scope.scopeType&&a.from.scope.value&&b.children?.push({type:"filter",cost:.1*b.rows,rows:Math.floor(.3*b.rows),width:b.width,details:{scope:a.from.scope.value}}),a.where&&a.where.filters.length>0){let c=.5**a.where.filters.length;b.children?.push({type:"filter",cost:.2*b.rows,rows:Math.floor(b.rows*c),width:b.width,details:{filters:a.where.filters.length}})}if(a.groupBy&&a.groupBy.columns.length>0&&b.children?.push({type:"aggregate",cost:.5*b.rows,rows:Math.floor(.1*b.rows),width:50,details:{groupBy:a.groupBy.columns}}),a.orderBy&&a.orderBy.columns.length>0){let c=b.rows*Math.log2(b.rows);b.children?.push({type:"sort",cost:c,rows:b.rows,width:b.width,details:{orderBy:a.orderBy.columns}})}return a.limit&&b.children?.push({type:"limit",cost:1,rows:Math.min(a.limit.value,b.rows),width:b.width,details:{limit:a.limit.value}}),b}async executePlan(a,b){let c=[...this.data];this.metrics.rowsExamined=c.length,c=this.applyScope(c,a),this.metrics.scoped=c.length,a.where?(c=this.applyFilters(c,a.where.filters),this.metrics.filtered=c.length):this.metrics.filtered=this.metrics.scoped;let d=[],e=[];if(a.groupBy||a.select.aggregates.length>0){let b=this.executeAggregates(c,a);d=b.headers,e=b.rows}else{let b=this.executeSelect(c,a);d=b.headers,e=b.rows}a.orderBy&&(e=this.applyOrderBy(e,d,a.orderBy)),a.limit&&(e=e.slice(0,a.limit.value));let f={ok:!0,headers:d,rows:e,rowCount:e.length,metadata:this.buildMetadata(a)};return"csv"===this.options.format&&(f.csv=this.formatAsCSV(d,e)),f}applyScope(a,b){let c=b.from.scope;if("all"===c.scopeType)return a;if("group"===c.scopeType&&c.value){var d;let b=(d=c.value,au.get(d.toLowerCase().trim())||d);return a.filter(a=>a.group_name===b)}return a}applyFilters(a,b){let c=a;for(let a of b){let b=ay(a.field);if(!b){this.warnings.push({message:`Unknown field: ${a.field}`,severity:"warning"});continue}!function(a,b){let c=function(a){let b=ax(a);return b?.type}(a);return!!c&&!!(["equals","not_equals"].includes(b)||"number"===c&&["greater_than","less_than","greater_or_equal","less_or_equal"].includes(b)||"text"===c&&["contains","does_not_contain","starts_with","ends_with"].includes(b))}(a.field,a.operator)&&this.warnings.push({message:`Operator '${a.operator}' may not be compatible with field '${a.field}'`,severity:"warning"}),c=c.filter(c=>this.evaluateFilter(c,a,b))}return c}evaluateFilter(a,b,c){let d=a[c];if(null==d)return!1;let e=String(d).toLowerCase(),f=String(b.value).toLowerCase();switch(b.operator){case"contains":return e.includes(f);case"does_not_contain":return!e.includes(f);case"equals":return e===f;case"not_equals":return e!==f;case"starts_with":return e.startsWith(f);case"ends_with":return e.endsWith(f);case"greater_than":return Number(d)>Number(b.value);case"less_than":return Number(d)<Number(b.value);case"greater_or_equal":return Number(d)>=Number(b.value);case"less_or_equal":return Number(d)<=Number(b.value);default:return!1}}executeSelect(a,b){let c=b.select.columns,d=c.length>0?c.map(a=>a.name):["Computer Name"],e=a.map(a=>d.map(b=>{let c=ay(b);if(!c)return null;let d=a[c];return this.formatValue(d)}));return{headers:d,rows:e}}executeAggregates(a,b){let c=[],d=b.select.aggregates,e=b.groupBy?.columns[0];if(e&&c.push(e),d.length>0?d.forEach(a=>{c.push(`${a.function}(${a.column||""})`)}):c.push("count()"),e){let b=this.groupData(a,e),f=[];for(let[a,c]of b.entries()){let b=[a];d.length>0?d.forEach(a=>{b.push(this.calculateAggregate(c,a))}):b.push(c.length),f.push(b)}return{headers:c,rows:f}}{let b=[];return d.length>0?d.forEach(c=>{b.push(this.calculateAggregate(a,c))}):b.push(a.length),{headers:c,rows:[b]}}}groupData(a,b){let c=new Map,d=ay(b);if(!d)return this.warnings.push({message:`Unknown group by column: ${b}`,severity:"error"}),c;for(let b of a){let a=String(b[d]||"null");c.has(a)||c.set(a,[]),c.get(a).push(b)}return c}calculateAggregate(a,b){if("count"===b.function){if(!b.column)return a.length;let c=ay(b.column);return c?a.filter(a=>null!=a[c]).length:0}if(!b.column)return null;let c=ay(b.column);if(!c)return null;let d=a.map(a=>a[c]).filter(a=>null!=a&&!isNaN(Number(a))).map(Number);if(0===d.length)return null;switch(b.function){case"min":return Math.min(...d);case"max":return Math.max(...d);case"avg":return Math.round(d.reduce((a,b)=>a+b,0)/d.length*100)/100;case"sum":return Math.round(100*d.reduce((a,b)=>a+b,0))/100;default:return null}}applyOrderBy(a,b,c){if(!c)return a;let d=[...a],e=c.columns;return d.sort((a,c)=>{for(let d of e){let e=b.indexOf(d.column);if(-1===e)continue;let f=a[e],g=c[e];if(null===f&&null===g)continue;if(null===f)return"asc"===d.direction?-1:1;if(null===g)return"asc"===d.direction?1:-1;let h=0;if(0!==(h="number"==typeof f&&"number"==typeof g?f-g:String(f).localeCompare(String(g))))return"asc"===d.direction?h:-h}return 0}),d}formatValue(a){return null==a?null:"number"==typeof a?Math.round(1e3*a)/1e3:a instanceof Date?a.toISOString():String(a)}formatAsCSV(a,b){let c=[];for(let d of(c.push(a.map(a=>this.escapeCSV(a)).join(",")),b))c.push(d.map(a=>this.escapeCSV(a)).join(","));return c.join("\n")}escapeCSV(a){if(null==a)return"";let b=String(a);return b.includes(",")||b.includes('"')||b.includes("\n")?`"${b.replace(/"/g,'""')}"`:b}buildMetadata(a){return{aggregations:a.select.aggregates.map(a=>a.function),groupBy:a.groupBy?.columns[0]||null,orderBy:a.orderBy?.columns[0]?.column||null,orderDir:a.orderBy?.columns[0]?.direction||"asc",limit:a.limit?.value||null,scope:a.from.scope.value||a.from.scope.scopeType,filters:a.where?.filters.length||0}}createExplainResult(a){return{ok:!0,headers:["Operation","Cost","Rows","Details"],rows:this.planToRows(a),rowCount:1,metadata:{aggregations:[],groupBy:null,orderBy:null,orderDir:"asc",limit:null,scope:"all",filters:0}}}planToRows(a,b=0){let c=[],d="  ".repeat(b);if(c.push([`${d}${a.type}`,a.cost,a.rows,a.details?JSON.stringify(a.details):null]),a.children)for(let d of a.children)c.push(...this.planToRows(d,b+1));return c}setData(a){this.data=a}getData(){return this.data}}var aA=c(55511);class aB{constructor(a=1e3,b=3e5){this.accessOrder=[],this.cache=new Map,this.maxSize=a,this.defaultTTL=b,this.stats={hits:0,misses:0,evictions:0,size:0,maxSize:a}}generateKey(a,b){let c="string"==typeof a?a:JSON.stringify(a),d=b?JSON.stringify(b):"";return(0,aA.createHash)("sha256").update(c+d).digest("hex").substring(0,16)}get(a,b){let c=this.generateKey(a,b),d=this.cache.get(c);return d?Date.now()>d.timestamp+d.ttl?(this.delete(c),this.stats.misses++,null):(this.updateAccessOrder(c),d.hits++,this.stats.hits++,d.value):(this.stats.misses++,null)}set(a,b,c){let d=this.generateKey(a),e=c?.ttl||this.defaultTTL,f=c?.size||this.estimateSize(b);this.cache.size>=this.maxSize&&this.evictLRU();let g={value:b,timestamp:Date.now(),ttl:e,hits:0,size:f};this.cache.set(d,g),this.updateAccessOrder(d),this.stats.size=this.cache.size}delete(a){let b=this.cache.delete(a);if(b){let b=this.accessOrder.indexOf(a);b>-1&&this.accessOrder.splice(b,1),this.stats.size=this.cache.size}return b}clear(){this.cache.clear(),this.accessOrder=[],this.stats.size=0,this.stats.evictions=0}getStats(){return{...this.stats}}getHitRate(){let a=this.stats.hits+this.stats.misses;return 0===a?0:this.stats.hits/a}evictLRU(){if(0===this.accessOrder.length)return;let a=this.accessOrder[0];this.cache.delete(a),this.accessOrder.shift(),this.stats.evictions++,this.stats.size=this.cache.size}updateAccessOrder(a){let b=this.accessOrder.indexOf(a);b>-1&&this.accessOrder.splice(b,1),this.accessOrder.push(a)}estimateSize(a){return null==a?0:"string"==typeof a?a.length:"number"==typeof a?8:"boolean"==typeof a?1:a instanceof Date?8:Array.isArray(a)?a.reduce((a,b)=>a+this.estimateSize(b),0):"object"==typeof a?Object.entries(a).reduce((a,[b,c])=>a+b.length+this.estimateSize(c),0):0}pruneExpired(){let a=Date.now(),b=0;for(let[c,d]of this.cache.entries())a>d.timestamp+d.ttl&&(this.delete(c),b++);return b}getSizeInBytes(){let a=0;for(let b of this.cache.values())a+=b.size;return a}export(){return JSON.stringify({entries:Array.from(this.cache.entries()),stats:this.stats,accessOrder:this.accessOrder})}import(a){try{let b=JSON.parse(a);this.cache=new Map(b.entries),this.stats=b.stats,this.accessOrder=b.accessOrder||[],this.pruneExpired()}catch(a){console.error("Failed to import cache:",a)}}}class aC extends aB{constructor(a=500){super(a,36e5)}getAST(a){return this.get(a)}setAST(a,b){this.set(a,b,{size:JSON.stringify(b).length})}}class aD extends aB{constructor(a=100,b=6e4){super(a,b)}getResult(a,b){return this.get(a,b?{userId:b}:void 0)}setResult(a,b,c){let d=this.estimateResultSize(b);this.set(a,b,{size:d,metadata:c?{userId:c}:void 0})}estimateResultSize(a){let b=100;return a.headers&&(b+=a.headers.join("").length),a.rows&&(b+=50*a.rows.length),a.csv&&(b+=a.csv.length),b}invalidateUser(a){let b=[];for(let[c,d]of this.cache.entries())d.value?.metadata?.userId===a&&b.push(c);b.forEach(a=>this.delete(a))}}class aE{constructor(a){this.globalEnabled=!0,this.parsedCache=new aC(a?.maxParsedQueries||500),this.resultCache=new aD(a?.maxResults||100,a?.resultTTL||6e4),this.globalEnabled=a?.enabled??!0}getParsedQuery(a){return this.globalEnabled?this.parsedCache.getAST(a):null}setParsedQuery(a,b){this.globalEnabled&&this.parsedCache.setAST(a,b)}getQueryResult(a,b){return this.globalEnabled?this.resultCache.getResult(a,b):null}setQueryResult(a,b,c){this.globalEnabled&&(b.cached=!0,this.resultCache.setResult(a,b,c))}clearAll(){this.parsedCache.clear(),this.resultCache.clear()}getStatistics(){let a=this.parsedCache.getStats(),b=this.resultCache.getStats(),c=a.hits+b.hits,d=a.misses+b.misses;return{parsed:a,results:b,totalHitRate:c+d===0?0:c/(c+d)}}pruneExpired(){return{parsed:this.parsedCache.pruneExpired(),results:this.resultCache.pruneExpired()}}setEnabled(a){this.globalEnabled=a,a||this.clearAll()}isEnabled(){return this.globalEnabled}}let aF=new aE,aG=[{computer_name:"LAPTOP-001",role:"Workstation",os_platform:"Windows 11",os_version:"22H2",group_name:"Laptops",location:"NA-US",disk_free_gb:68.2,memory_gb:16,cpu_percent:32.5,compliance_score:.87,last_reboot:"2024-05-18",last_seen:"2024-05-20"},{computer_name:"LAPTOP-002",role:"Workstation",os_platform:"Windows 10",os_version:"21H2",group_name:"Laptops",location:"NA-US",disk_free_gb:45.4,memory_gb:8,cpu_percent:74.3,compliance_score:.62,last_reboot:"2024-05-16",last_seen:"2024-05-19"},{computer_name:"LAPTOP-003",role:"Workstation",os_platform:"Windows 11",os_version:"23H1",group_name:"Finance Workstations",location:"NA-US",disk_free_gb:120.1,memory_gb:16,cpu_percent:18.9,compliance_score:.92,last_reboot:"2024-05-14",last_seen:"2024-05-18"},{computer_name:"SERVER-API-01",role:"Server",os_platform:"Windows Server 2019",os_version:"2019",group_name:"Data Center Servers",location:"NA-US",disk_free_gb:512.4,memory_gb:64,cpu_percent:42.1,compliance_score:.95,last_reboot:"2024-05-12",last_seen:"2024-05-17"},{computer_name:"SERVER-SQL-01",role:"Server",os_platform:"Windows Server 2022",os_version:"2022",group_name:"Data Center Servers",location:"NA-US",disk_free_gb:312.9,memory_gb:128,cpu_percent:55.3,compliance_score:.89,last_reboot:"2024-05-13",last_seen:"2024-05-17"},{computer_name:"SRV-LNX-01",role:"Server",os_platform:"Linux",os_version:"RHEL 9",group_name:"Data Center Servers",location:"EU-DE",disk_free_gb:212.5,memory_gb:32,cpu_percent:21.7,compliance_score:.91,last_reboot:"2024-05-11",last_seen:"2024-05-15"},{computer_name:"MAC-OPS-01",role:"Workstation",os_platform:"macOS",os_version:"14.4",group_name:"Operations",location:"NA-US",disk_free_gb:180.7,memory_gb:32,cpu_percent:23.4,compliance_score:.88,last_reboot:"2024-05-18",last_seen:"2024-05-20"},{computer_name:"MAC-FIN-02",role:"Workstation",os_platform:"macOS",os_version:"13.6",group_name:"Finance Workstations",location:"NA-US",disk_free_gb:102.6,memory_gb:16,cpu_percent:26.1,compliance_score:.93,last_reboot:"2024-05-15",last_seen:"2024-05-18"},{computer_name:"ENG-LAB-01",role:"Workstation",os_platform:"Windows 11",os_version:"22H2",group_name:"Engineering Lab",location:"NA-US",disk_free_gb:250.8,memory_gb:32,cpu_percent:65.2,compliance_score:.77,last_reboot:"2024-05-15",last_seen:"2024-05-18"},{computer_name:"ENG-LAB-02",role:"Workstation",os_platform:"Windows 11",os_version:"22H2",group_name:"Engineering Lab",location:"NA-US",disk_free_gb:198.4,memory_gb:32,cpu_percent:58.4,compliance_score:.75,last_reboot:"2024-05-15",last_seen:"2024-05-18"},{computer_name:"CANARY-EDGE",role:"Workstation",os_platform:"Windows 11",os_version:"23H1",group_name:"Canary Cohort",location:"NA-US",disk_free_gb:156.4,memory_gb:16,cpu_percent:12.4,compliance_score:.98,last_reboot:"2024-05-19",last_seen:"2024-05-20"}];class aH{constructor(a){this.savedQueries=new Map,this.templates=new Map,this.parser=new as(a?.parserOptions),this.data=a?.data||aG,this.executor=new az(this.data,a?.executorOptions),this.cache=a?.cacheEnabled!==!1?aF:new aE({enabled:!1}),this.initializeTemplates()}async query(a,b){let c=performance.now();try{if(!a||"string"!=typeof a)throw new ao("Question is required and must be a string");let d=this.normalizeQuery(a);if(b?.useCache!==!1){let a=this.cache.getQueryResult(d);if(a)return a.execution={...a.execution,cacheHit:!0,totalTimeMs:performance.now()-c},a}let e=this.cache.getParsedQuery(d);if(!e){let a=performance.now();e=this.parser.parse(d);let b=performance.now()-a;this.cache.setParsedQuery(d,e),e&&(e.parseTimeMs=b)}let f=await this.executor.execute(e);return f.execution={...f.execution,totalTimeMs:performance.now()-c},b?.useCache!==!1&&this.cache.setQueryResult(d,f),f}catch(a){return{ok:!1,error:a instanceof Error?a.message:String(a),errorPosition:a instanceof ap?a.position:void 0,execution:{parseTimeMs:0,planTimeMs:0,executeTimeMs:0,totalTimeMs:performance.now()-c,scoped:0,filtered:0,rowsExamined:0,cacheHit:!1}}}}parse(a){let b=this.normalizeQuery(a),c=this.cache.getParsedQuery(b);if(c)return c;let d=this.parser.parse(b);return this.cache.setParsedQuery(b,d),d}async explain(a){let b=this.parse(a);return this.executor.execute(b)}normalizeQuery(a){return a.trim().replace(/\s+/g," ").replace(/^get\s+/i,"Get ")}saveQuery(a,b,c){let d={id:`saved_${Date.now()}`,name:a,question:b,description:c,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),executionCount:0};return this.savedQueries.set(a.toLowerCase(),d),d}getSavedQuery(a){return this.savedQueries.get(a.toLowerCase())}listSavedQueries(){return Array.from(this.savedQueries.values())}async runSavedQuery(a){let b=this.getSavedQuery(a);if(!b)throw new ao(`No saved query found with name: ${a}`);b.executionCount=(b.executionCount||0)+1,b.lastExecuted=new Date().toISOString();let c=performance.now(),d=await this.query(b.question),e=performance.now()-c;return b.averageTimeMs?b.averageTimeMs=(b.averageTimeMs+e)/2:b.averageTimeMs=e,d}initializeTemplates(){this.addTemplate({id:"all-machines",name:"All Machines",description:"List all machines",template:"Get Computer Name, OS Platform, Group from all machines",parameters:[],category:"Basic",difficulty:1}),this.addTemplate({id:"high-cpu",name:"High CPU Usage",description:"Find machines with high CPU usage",template:'Get Computer Name, CPU Percent from all machines where CPU Percent is greater than "${threshold}" order by CPU Percent desc',parameters:[{name:"threshold",type:"number",required:!0,default:80}],category:"Performance",difficulty:2}),this.addTemplate({id:"low-disk",name:"Low Disk Space",description:"Find machines with low disk space",template:'Get Computer Name, Disk Free GB from all machines where Disk Free GB is less than "${threshold}" order by Disk Free GB',parameters:[{name:"threshold",type:"number",required:!0,default:50}],category:"Performance",difficulty:2}),this.addTemplate({id:"compliance-check",name:"Compliance Check",description:"Check compliance scores by group",template:"Get avg(Compliance Score), min(Compliance Score), count() from all machines group by Group",parameters:[],category:"Governance",difficulty:3})}addTemplate(a){this.templates.set(a.id,a)}getTemplate(a){return this.templates.get(a)}listTemplates(){return Array.from(this.templates.values())}applyTemplate(a,b){let c=this.getTemplate(a);if(!c)throw new ao(`Template not found: ${a}`);let d=c.template;for(let a of c.parameters){let c=b[a.name]??a.default;if(a.required&&void 0===c)throw new ao(`Required parameter missing: ${a.name}`);d=d.replace(`\${${a.name}}`,String(c))}return d}setData(a){this.data=a,this.executor.setData(a),this.cache.clearAll()}getData(){return this.data}getFieldSuggestions(){return Array.from(at.keys())}getSensorsCatalog(){return av}getAggregateFunctions(){return aw}clearCache(){this.cache.clearAll()}getCacheStatistics(){return this.cache.getStatistics()}export(){return JSON.stringify({savedQueries:Array.from(this.savedQueries.entries()),templates:Array.from(this.templates.entries())},null,2)}import(a){try{let b=JSON.parse(a);b.savedQueries&&(this.savedQueries=new Map(b.savedQueries)),b.templates&&(this.templates=new Map(b.templates))}catch(a){throw new ao(`Failed to import data: ${a}`)}}}new aH;let aI=(0,e.lazy)(()=>c.e(2835).then(c.bind(c,92835)).then(a=>({default:a.NaturalLanguageInput})));function aJ(a,b){switch(b.type){case"SET_MODE":return{...a,mode:b.mode};case"ADD_SENSOR":return{...a,query:{...a.query,sensors:[...a.query.sensors,b.sensor]}};case"REMOVE_SENSOR":return{...a,query:{...a.query,sensors:a.query.sensors.filter((a,c)=>c!==b.index)}};case"UPDATE_SENSOR":return{...a,query:{...a.query,sensors:a.query.sensors.map((a,c)=>c===b.index?b.sensor:a)}};case"ADD_FILTER":return{...a,query:{...a.query,filters:[...a.query.filters,b.filter]}};case"REMOVE_FILTER":return{...a,query:{...a.query,filters:a.query.filters.filter(a=>a.id!==b.filterId)}};case"UPDATE_FILTER":return{...a,query:{...a.query,filters:a.query.filters.map(a=>a.id===b.filterId?b.filter:a)}};case"SET_SCOPE":return{...a,query:{...a.query,scope:b.scope}};case"SET_GROUP_BY":return{...a,query:{...a.query,groupBy:b.groupBy}};case"SET_ORDER_BY":return{...a,query:{...a.query,orderBy:b.orderBy}};case"SET_LIMIT":return{...a,query:{...a.query,limit:b.limit}};case"SET_RAW_QUERY":return{...a,query:{...a.query,rawQuery:b.query}};case"SET_VALIDATION":return{...a,validation:b.validation};case"SET_SUGGESTIONS":return{...a,suggestions:b.suggestions};case"SET_RESULT":return{...a,result:b.result};case"SET_EXECUTING":return{...a,isExecuting:b.isExecuting};case"ADD_TO_HISTORY":return{...a,history:[b.item,...a.history].slice(0,50)};case"RESET_QUERY":return{...a,query:aK,validation:aL,result:void 0};default:return a}}let aK={sensors:[],aggregates:[],scope:{type:"all"},filters:[],filterLogic:"AND",groupBy:[],orderBy:[],limit:void 0,rawQuery:""},aL={isValid:!1,errors:[],warnings:[],syntaxValid:!1,semanticValid:!1},aM={mode:"guided",query:aK,validation:aL,suggestions:[],isExecuting:!1,result:void 0,history:[]};function aN({initialQuery:a,mode:b="guided",onQueryChange:c,onExecute:f,readOnly:q=!1,showResults:w=!0,showHistory:x=!0,maxHeight:y="800px",className:z=""}){let[A,B]=(0,e.useReducer)(aJ,{...aM,mode:b,query:a||aK}),[C]=(0,e.useState)(()=>new aH),[D,E]=(0,e.useState)(!1),{validate:F,getQueryString:G}=function(){let a=(0,e.useCallback)(a=>{let b=[],c=[];if(0===a.sensors.length&&0===a.aggregates.length&&b.push({field:"sensors",message:"Query must have at least one sensor or aggregate function",severity:"error"}),a.sensors.forEach((a,d)=>{let e="name"in a.sensor?a.sensor.name:void 0;e&&""!==e.trim()||b.push({field:`sensor[${d}]`,message:"Sensor name cannot be empty",severity:"error"}),a.parameters&&Object.entries(a.parameters).forEach(([a,b])=>{(void 0===b||""===b)&&c.push({field:`sensor[${d}].${a}`,message:`Parameter "${a}" is empty`,suggestion:"Provide a value or use default",severity:"warning"})})}),a.filters.forEach(a=>{a.sensor&&""!==a.sensor.trim()||b.push({field:`filter[${a.id}]`,message:"Filter must have a sensor selected",severity:"error"}),(""===a.value||void 0===a.value)&&b.push({field:`filter[${a.id}]`,message:"Filter value cannot be empty",severity:"error"}),"number"===a.dataType&&isNaN(Number(a.value))&&b.push({field:`filter[${a.id}]`,message:"Filter value must be a valid number",severity:"error"})}),a.groupBy.length>0){let c=new Set(a.groupBy);a.sensors.some(a=>!c.has("name"in a.sensor&&a.sensor.name||""))&&0===a.aggregates.length&&b.push({field:"groupBy",message:"Non-grouped sensors must be aggregated when using GROUP BY",severity:"error"})}a.orderBy.length>0&&a.orderBy.forEach((a,c)=>{a.sensor&&""!==a.sensor.trim()||b.push({field:`orderBy[${c}]`,message:"ORDER BY must specify a sensor",severity:"error"})}),void 0!==a.limit&&(a.limit<=0&&b.push({field:"limit",message:"LIMIT must be greater than 0",severity:"error"}),a.limit>1e4&&c.push({field:"limit",message:"LIMIT is very high",suggestion:"Consider using a smaller limit for better performance",severity:"warning"})),a.sensors.length>10&&c.push({field:"sensors",message:"Many sensors selected",suggestion:"Consider reducing sensors for better performance",severity:"warning"}),0===a.filters.length&&"all"===a.scope.type&&c.push({field:"filters",message:"No filters applied",suggestion:"Consider adding filters to reduce result set",severity:"info"});let d=0===b.length,e=0===b.filter(a=>"critical"===a.severity).length;return{isValid:d,errors:b,warnings:c,syntaxValid:e,semanticValid:d}},[]),b=(0,e.useCallback)(a=>{let b="name"in a.sensor?a.sensor.name:void 0;return!(!b||""===b.trim()||a.parameters&&Object.entries(a.parameters).some(([a,b])=>void 0===b||""===b))&&!0},[]);return{validate:a,validateSensor:b,validateFilter:(0,e.useCallback)(a=>!(!a.sensor||""===a.sensor.trim()||""===a.value||void 0===a.value||"number"===a.dataType&&isNaN(Number(a.value))),[]),getQueryString:(0,e.useCallback)(a=>{let b=[];if(a.rawQuery&&a.rawQuery.trim())return a.rawQuery;if(a.sensors.length>0||a.aggregates.length>0){b.push("Get");let c=[];a.sensors.forEach(a=>{let b="name"in a.sensor&&a.sensor.name||"";if(a.parameters&&Object.keys(a.parameters).length>0){let c=Object.entries(a.parameters).map(([a,b])=>`${a}="${b}"`).join(", ");b+=`[${c}]`}a.filter&&(b+=` ${a.filter.operator.replace(/_/g," ")} "${a.filter.value}"`),c.push(b)}),a.aggregates.forEach(a=>{let b=a.sensor?`${a.function}(${a.sensor})`:`${a.function}()`;c.push(b)}),b.push(c.join(" and "))}else b.push("Get Computer Name");if(b.push("from"),"all"===a.scope.type?b.push("all machines"):"group"===a.scope.type&&a.scope.computerGroup?b.push(`group "${a.scope.computerGroup}"`):b.push("all machines"),a.filters.length>0){b.push("where");let c=(b,d)=>{let e=b.filter(a=>d?a.parentId===d:!a.parentId&&!a.isNested).map(a=>{let b=a.operator.replace(/_/g," ");return`${a.sensor} ${b} "${a.value}"`});return b.filter(a=>a.isNested&&a.parentId===d).forEach(a=>{let d=c(b,a.id);d&&e.push(`(${d})`)}),e.join(` ${a.filterLogic.toLowerCase()} `)};b.push(c(a.filters))}if(a.groupBy.length>0&&(b.push("group by"),b.push(a.groupBy.join(", "))),a.orderBy.length>0){b.push("order by");let c=a.orderBy.map(a=>`${a.sensor} ${a.direction}`);b.push(c.join(", "))}return a.limit&&b.push(`limit ${a.limit}`),b.join(" ")},[])}}(),{parse:I,getSuggestions:J,isProcessing:K}=function(){let[a,b]=(0,e.useState)(!1),c=(0,e.useCallback)(async a=>{b(!0);try{await new Promise(a=>setTimeout(a,500));let b={sensors:[],aggregates:[],scope:{type:"all"},filters:[],filterLogic:"AND",groupBy:[],orderBy:[],limit:void 0},c=[],e=0,g="";for(let{pattern:c,type:h}of aj){let i=a.match(c);if(i){switch(h){case"list":case"query":let c=i[1]||i[2],j=d(c);j.forEach(a=>{b.sensors.push({sensor:{name:a,key:a.toLowerCase().replace(/\s+/g,"_"),type:"text",category:"General"},isValid:!0})}),e=.8,g=`Query for ${j.join(", ")}`;break;case"filter":case"contains":case"comparison":let k=f(a);b.filters=k.filters,b.sensors=k.sensors,e=.75,g=`Filter by ${k.filters.map(a=>a.sensor).join(", ")}`;break;case"count":case"aggregate":b.aggregates.push({function:"count"});let l=d(i[1]);l.forEach(a=>{b.sensors.push({sensor:{name:a,key:a.toLowerCase().replace(/\s+/g,"_"),type:"text",category:"General"},isValid:!0})}),e=.85,g=`Count ${l.join(", ")}`;break;case"limit":b.limit=parseInt(i[1]);let m=d(i[2]);m.forEach(a=>{b.sensors.push({sensor:{name:a,key:a.toLowerCase().replace(/\s+/g,"_"),type:"text",category:"General"},isValid:!0})}),e=.9,g=`Top ${b.limit} ${m.join(", ")}`}break}}if(0===b.sensors.length){let c=d(a);c.length>0?(c.forEach(a=>{b.sensors.push({sensor:{name:a,key:a.toLowerCase().replace(/\s+/g,"_"),type:"text",category:"General"},isValid:!0})}),e=.5,g=`Query for ${c.join(", ")}`):(b.sensors.push({sensor:{name:"Computer Name",key:"computer_name",type:"text",category:"System"},isValid:!0}),e=.3,g="Default query for Computer Name")}return e<.8&&(c.push({query:{...b,sensors:[{sensor:{name:"Computer Name",key:"computer_name",type:"text",category:"System"},isValid:!0},{sensor:{name:"Operating System",key:"os_platform",type:"text",category:"System"},isValid:!0}]},confidence:.6,explanation:"Show computer names and operating systems"}),c.push({query:{...b,sensors:[{sensor:{name:"Computer Name",key:"computer_name",type:"text",category:"System"},isValid:!0}],filters:[{id:"filter-1",sensor:"Operating System",operator:"contains",value:"Windows",dataType:"text"}]},confidence:.5,explanation:"Show Windows computers"})),{query:b,confidence:e,alternatives:c,interpretation:g}}finally{b(!1)}},[]),d=(0,e.useCallback)(a=>{let b=[],c=a.toLowerCase();for(let[a,d]of Object.entries(ak))for(let e of d)if(c.includes(e)){b.push(a);break}return b.length>0?b:["Computer Name"]},[]),f=(0,e.useCallback)(a=>{let b=[],c=[],e=a.toLowerCase();for(let[f,g]of Object.entries(al))for(let h of g)if(e.includes(h)){let e=RegExp(`(\\w+(?:\\s+\\w+)*?)\\s+${h}\\s+["']?([^"']+)["']?`,"i"),g=a.match(e);if(g){let a=d(g[1])[0]||"Computer Name";b.push({id:`filter-${Date.now()}`,sensor:a,operator:f,value:g[2].trim(),dataType:"text"}),c.push({sensor:{name:a,key:a.toLowerCase().replace(/\s+/g,"_"),type:"text",category:"General"},isValid:!0})}}return{filters:b,sensors:c}},[d]);return{parse:c,getSuggestions:(0,e.useCallback)((a,b)=>{let c=[],d=a.toLowerCase();if(a.length<2)return c;for(let[a,b]of Object.entries(ak))b.some(a=>a.includes(d)||d.includes(a))&&c.push({id:`sensor-${a}`,type:"sensor",text:`Get ${a} from all machines`,displayText:a,description:`Add ${a} sensor to query`,confidence:.8,category:"Sensors"});return(d.includes("cpu")||d.includes("high"))&&c.push({id:"template-high-cpu",type:"template",text:"Get Computer Name and CPU Percent from all machines where CPU Percent greater than 80",displayText:"High CPU usage",description:"Find machines with CPU > 80%",confidence:.9,category:"Templates",runtime:150}),(d.includes("disk")||d.includes("space"))&&c.push({id:"template-low-disk",type:"template",text:"Get Computer Name and Disk Free GB from all machines where Disk Free GB less than 50",displayText:"Low disk space",description:"Find machines with < 50GB free",confidence:.9,category:"Templates",runtime:120}),d.includes("windows")&&c.push({id:"filter-windows",type:"filter",text:'where Operating System contains "Windows"',displayText:"Filter Windows machines",description:"Add Windows filter",confidence:.85,category:"Filters"}),c.sort((a,b)=>b.confidence-a.confidence),c.slice(0,10)},[]),isProcessing:a}}(),{catalog:L,search:M,categories:N,popularSensors:O}=function(){let a=(0,e.useMemo)(()=>Array.from(new Set(am.map(a=>a.category))).sort(),[]),b=(0,e.useMemo)(()=>am.filter(a=>a.popularity>.7).sort((a,b)=>b.popularity-a.popularity).slice(0,8),[]),c=(0,e.useCallback)(a=>{if(!a||""===a.trim())return am;let b=a.toLowerCase();return am.filter(a=>{let c="name"in a.sensor&&a.sensor.name?.toLowerCase().includes(b),d=a.description?.toLowerCase().includes(b),e=a.category.toLowerCase().includes(b),f="key"in a.sensor&&a.sensor.key?.toLowerCase().includes(b);return c||d||e||f})},[]),d=(0,e.useCallback)(a=>"all"!==a&&a?am.filter(b=>b.category===a):am,[]);return{catalog:am,search:c,getByCategory:d,categories:a,popularSensors:b}}(),P=(0,e.useCallback)(async()=>{if(!q&&A.validation.isValid){B({type:"SET_EXECUTING",isExecuting:!0});try{let a=G(A.query),b=await C.query(a);B({type:"SET_RESULT",result:b});let c={id:`query-${Date.now()}`,query:a,timestamp:new Date().toISOString(),executionTime:b.execution?.totalTimeMs,resultCount:b.rowCount,success:b.ok};B({type:"ADD_TO_HISTORY",item:c}),f&&f(a,b)}catch(a){console.error("Query execution error:",a),B({type:"SET_RESULT",result:{ok:!1,error:a instanceof Error?a.message:"Query execution failed"}})}finally{B({type:"SET_EXECUTING",isExecuting:!1})}}},[A.query,A.validation.isValid,C,G,f,q]),Q=(0,e.useCallback)(async a=>{let b=await I(a);b.query&&(B({type:"RESET_QUERY"}),b.query.sensors.forEach(a=>{B({type:"ADD_SENSOR",sensor:a})}),b.query.filters.forEach(a=>{B({type:"ADD_FILTER",filter:a})}),b.query.scope&&B({type:"SET_SCOPE",scope:b.query.scope}))},[I]),R=(0,e.useCallback)(a=>{B({type:"SET_RAW_QUERY",query:a.query}),"advanced"===A.mode&&P(),E(!1)},[A.mode,P]),S=A.validation.errors.length>0?{icon:l.A,color:"text-red-500",text:"Invalid query"}:A.validation.warnings.length>0?{icon:m.A,color:"text-yellow-500",text:"Query has warnings"}:A.validation.isValid?{icon:n.A,color:"text-green-500",text:"Valid query"}:{icon:l.A,color:"text-gray-500",text:"Incomplete query"};return(0,d.jsxs)(g.Zp,{className:`glass border-white/10 ${z}`,children:[(0,d.jsx)(g.aR,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)(g.ZB,{className:"flex items-center text-white",children:[(0,d.jsx)(o.A,{className:"mr-2 h-5 w-5 text-tanium-accent"}),"Tanium Question Builder"]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,d.jsx)(S.icon,{className:`h-4 w-4 ${S.color}`}),(0,d.jsx)("span",{className:`text-sm ${S.color}`,children:S.text})]}),(0,d.jsx)(i.$,{size:"sm",variant:"ghost",onClick:()=>B({type:"RESET_QUERY"}),disabled:q,children:(0,d.jsx)(p.A,{className:"h-4 w-4"})}),x&&(0,d.jsxs)(i.$,{size:"sm",variant:"ghost",onClick:()=>E(!D),children:[(0,d.jsx)(r,{className:"h-4 w-4"}),(0,d.jsx)(j.E,{variant:"secondary",className:"ml-1",children:A.history.length})]}),(0,d.jsx)(i.$,{size:"sm",onClick:P,disabled:q||!A.validation.isValid||A.isExecuting,className:"bg-tanium-accent hover:bg-blue-600",children:A.isExecuting?(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Executing..."]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.A,{className:"mr-1 h-4 w-4"}),"Execute Query"]})})]})]})}),(0,d.jsxs)(g.Wu,{className:"space-y-4",style:{maxHeight:y,overflow:"auto"},children:[(0,d.jsxs)(h.tU,{value:A.mode,onValueChange:a=>B({type:"SET_MODE",mode:a}),children:[(0,d.jsxs)(h.j7,{className:"grid w-full grid-cols-3 bg-gray-800",children:[(0,d.jsxs)(h.Xi,{value:"guided",className:"flex items-center",children:[(0,d.jsx)(t.A,{className:"mr-2 h-4 w-4"}),"Guided"]}),(0,d.jsxs)(h.Xi,{value:"natural-language",className:"flex items-center",children:[(0,d.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Natural Language"]}),(0,d.jsxs)(h.Xi,{value:"advanced",className:"flex items-center",children:[(0,d.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Advanced"]})]}),(0,d.jsx)(h.av,{value:"guided",className:"space-y-4",children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)(H,{selectedSensors:A.query.sensors,onAdd:a=>B({type:"ADD_SENSOR",sensor:a}),onRemove:a=>B({type:"REMOVE_SENSOR",index:a}),onUpdate:(a,b)=>B({type:"UPDATE_SENSOR",index:a,sensor:b}),catalog:L,className:"mb-4"}),(0,d.jsx)(T,{filters:A.query.filters,onAdd:a=>B({type:"ADD_FILTER",filter:a}),onRemove:a=>B({type:"REMOVE_FILTER",filterId:a}),onUpdate:(a,b)=>B({type:"UPDATE_FILTER",filterId:a,filter:b}),availableSensors:L.map(a=>"name"in a.sensor?a.sensor.name:""),filterLogic:A.query.filterLogic,onLogicChange:a=>B({type:"SET_SCOPE",scope:{...A.query.scope,customFilter:A.query.filters}}),allowNested:!0,className:"mb-4"}),(0,d.jsx)(X,{query:A.query,validation:A.validation,syntaxHighlight:!0,showWarnings:!0,className:"mb-4"})]})}),(0,d.jsxs)(h.av,{value:"natural-language",className:"space-y-4",children:[(0,d.jsx)(e.Suspense,{fallback:(0,d.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-tanium-accent"}),(0,d.jsx)("span",{className:"text-gray-400",children:"Loading Natural Language mode..."})]})}),children:(0,d.jsx)(aI,{value:A.query.rawQuery||"",onChange:a=>B({type:"SET_RAW_QUERY",query:a}),onSubmit:Q,suggestions:A.suggestions,isProcessing:K,placeholder:"Type a natural language query (e.g., 'Show me all Windows servers with high CPU usage')",className:"mb-4"})}),A.query.sensors.length>0&&(0,d.jsx)(X,{query:A.query,validation:A.validation,syntaxHighlight:!0,showWarnings:!0,className:"mb-4"})]}),(0,d.jsx)(h.av,{value:"advanced",className:"space-y-4",children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("textarea",{className:"w-full h-32 p-3 bg-gray-800 border border-gray-600 rounded text-white font-mono text-sm",placeholder:"Enter Tanium query directly (e.g., Get Computer Name from all machines)",value:A.query.rawQuery,onChange:a=>B({type:"SET_RAW_QUERY",query:a.target.value}),disabled:q}),A.validation.errors.length>0&&(0,d.jsxs)(k.Fc,{className:"border-red-500 bg-red-500/10",children:[(0,d.jsx)(l.A,{className:"h-4 w-4 text-red-500"}),(0,d.jsx)(k.TN,{className:"text-red-400",children:A.validation.errors[0].message})]})]})})]}),w&&A.result&&(0,d.jsx)(ai,{result:A.result,isLoading:A.isExecuting,onExport:a=>{console.log("Export as:",a)},className:"mt-4"}),x&&D&&(0,d.jsxs)(g.Zp,{className:"glass border-white/10 mt-4",children:[(0,d.jsx)(g.aR,{children:(0,d.jsx)(g.ZB,{className:"text-white text-sm",children:"Query History"})}),(0,d.jsx)(g.Wu,{children:(0,d.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:A.history.map(a=>(0,d.jsxs)("div",{className:"p-2 bg-gray-800 rounded hover:bg-gray-700 cursor-pointer",onClick:()=>R(a),children:[(0,d.jsxs)("div",{className:"flex justify-between items-start",children:[(0,d.jsx)("div",{className:"flex-1",children:(0,d.jsx)("code",{className:"text-xs text-gray-300 block",children:a.query})}),(0,d.jsx)("div",{className:"text-xs text-gray-500 ml-2",children:new Date(a.timestamp).toLocaleTimeString()})]}),void 0!==a.resultCount&&(0,d.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[a.resultCount," results • ",a.executionTime,"ms"]})]},a.id))})})]})]})]})}function aO(){return(0,d.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"Tanium Query Builder"}),(0,d.jsx)("p",{className:"text-xl text-gray-400",children:"Learn to build Tanium queries interactively with guided assistance"})]}),(0,d.jsxs)(k.Fc,{className:"mb-6 border-blue-500 bg-blue-500/10",children:[(0,d.jsx)(m.A,{className:"h-4 w-4 text-blue-400"}),(0,d.jsxs)(k.TN,{className:"text-blue-300",children:[(0,d.jsx)("strong",{children:"Interactive Learning Mode:"})," This simulator helps you understand Tanium's natural language query system. Practice building queries using guided mode, natural language, or advanced syntax."]})]}),(0,d.jsxs)(g.Zp,{className:"glass border-white/10 mb-8",children:[(0,d.jsxs)(g.aR,{children:[(0,d.jsx)(g.ZB,{className:"text-white",children:"Quick Start Guide"}),(0,d.jsx)(g.BT,{className:"text-gray-400",children:"Three ways to build queries"})]}),(0,d.jsxs)(g.Wu,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,d.jsxs)("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[(0,d.jsx)("h3",{className:"font-semibold text-white mb-2",children:"\uD83D\uDDB1️ Guided Mode"}),(0,d.jsx)("p",{className:"text-sm text-gray-400",children:"Use visual components to select sensors, add filters, and build queries step-by-step with immediate feedback."})]}),(0,d.jsxs)("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[(0,d.jsx)("h3",{className:"font-semibold text-white mb-2",children:"✨ Natural Language"}),(0,d.jsx)("p",{className:"text-sm text-gray-400",children:'Type queries in plain English like "Show me all Windows servers with high CPU usage" and watch them convert to Tanium syntax.'})]}),(0,d.jsxs)("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[(0,d.jsx)("h3",{className:"font-semibold text-white mb-2",children:"⚡ Advanced Mode"}),(0,d.jsx)("p",{className:"text-sm text-gray-400",children:"Write Tanium queries directly with syntax highlighting and validation for experienced users."})]})]}),(0,d.jsx)("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/50 rounded",children:(0,d.jsxs)("p",{className:"text-sm text-yellow-300",children:[(0,d.jsx)("strong",{children:"Tip:"})," Start with Natural Language mode to see how everyday questions translate into Tanium queries, then explore Guided mode to understand the components."]})})]})]}),(0,d.jsx)(aN,{mode:"natural-language",showResults:!0,showHistory:!0,onExecute:(a,b)=>{console.log("Query executed:",a),console.log("Result:",b)}}),(0,d.jsxs)(g.Zp,{className:"glass border-white/10 mt-8",children:[(0,d.jsx)(g.aR,{children:(0,d.jsx)(g.ZB,{className:"text-white",children:"Learning Resources"})}),(0,d.jsxs)(g.Wu,{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,d.jsx)("span",{className:"text-tanium-accent",children:"•"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-white font-medium",children:"Common Sensors"}),(0,d.jsx)("p",{className:"text-sm text-gray-400",children:"Computer Name, Operating System, IP Address, CPU Percent, Disk Free GB"})]})]}),(0,d.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,d.jsx)("span",{className:"text-tanium-accent",children:"•"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-white font-medium",children:"Filter Operators"}),(0,d.jsx)("p",{className:"text-sm text-gray-400",children:"contains, equals, greater than, less than, starts with, ends with"})]})]}),(0,d.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,d.jsx)("span",{className:"text-tanium-accent",children:"•"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-white font-medium",children:"Aggregate Functions"}),(0,d.jsx)("p",{className:"text-sm text-gray-400",children:"count(), min(), max(), avg(), sum()"})]})]})]})]})]})}},14263:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},18310:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},20558:(a,b,c)=>{"use strict";c.d(b,{L7:()=>e,nV:()=>d});class d{static async updateQuestionProgress(a){return e.updateQuestionProgress(a)}static async updateAssessmentProgress(a){return e.updateAssessmentProgress(a)}static async getUserProgress(a,b){return e.getUserProgress(a,b)}static async getDomainProgress(a,b){return e.getDomainProgress(a,b)}static async getLearningAnalytics(a){return e.getLearningAnalytics(a)}async updateQuestionProgress(a){a.timestamp=new Date,console.log("Updating question progress in Supabase (placeholder)",a)}async updateAssessmentProgress(a){a.timestamp=new Date,console.log("Updating assessment progress in Supabase (placeholder)",a)}async getUserProgress(a,b){return console.log("Fetching user progress from Supabase (placeholder) for userId:",a,"moduleId:",b),null}async getDomainProgress(a,b){return console.log("Fetching domain progress from Supabase (placeholder) for userId:",a,"domain:",b),[]}async getCertificationProgress(a){return console.log("Fetching certification progress from Supabase (placeholder) for userId:",a),null}async getLearningAnalytics(a){return console.log("Generating learning analytics from Supabase (placeholder) for userId:",a),{overallProgress:0,domainBreakdown:{},studyPatterns:{averageSessionTime:0,peakPerformanceHours:[],consistencyScore:0},recommendations:[],nextMilestones:[]}}}let e=new d;d.updateQuestionProgress=e.updateQuestionProgress.bind(e),d.updateAssessmentProgress=e.updateAssessmentProgress.bind(e),d.getUserProgress=e.getUserProgress.bind(e),d.getDomainProgress=e.getDomainProgress.bind(e),d.getLearningAnalytics=e.getLearningAnalytics.bind(e)},20875:(a,b,c)=>{Promise.resolve().then(c.bind(c,71987))},23201:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]])},23227:(a,b,c)=>{"use strict";c.d(b,{Select:()=>i,SelectContent:()=>n,SelectItem:()=>o,SelectTrigger:()=>k,SelectValue:()=>j});var d=c(21124),e=c(38301),f=c(45693),g=c(44943),h=c(11729);let i=f.bL;f.YJ;let j=f.WT,k=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(f.l9,{ref:e,className:(0,g.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[placeholder]:text-muted-foreground [&>span]:line-clamp-1",a),...c,children:[b,(0,d.jsx)(f.In,{asChild:!0,children:(0,d.jsx)(h.D3D,{className:"h-4 w-4 opacity-50"})})]}));k.displayName=f.l9.displayName;let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.PP,{ref:c,className:(0,g.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,d.jsx)(h.Mtm,{className:"h-4 w-4"})}));l.displayName=f.PP.displayName;let m=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.wn,{ref:c,className:(0,g.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,d.jsx)(h.D3D,{className:"h-4 w-4"})}));m.displayName=f.wn.displayName;let n=e.forwardRef(({className:a,children:b,position:c="popper",...e},h)=>(0,d.jsx)(f.ZL,{children:(0,d.jsxs)(f.UC,{ref:h,className:(0,g.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] origin-[--radix-select-content-transform-origin] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===c&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:c,...e,children:[(0,d.jsx)(l,{}),(0,d.jsx)(f.LM,{className:(0,g.cn)("p-1","popper"===c&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:b}),(0,d.jsx)(m,{})]})}));n.displayName=f.UC.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.JU,{ref:c,className:(0,g.cn)("px-2 py-1.5 text-sm font-semibold",a),...b})).displayName=f.JU.displayName;let o=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(f.q7,{ref:e,className:(0,g.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,d.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(f.VF,{children:(0,d.jsx)(h.Srz,{className:"h-4 w-4"})})}),(0,d.jsx)(f.p4,{children:b})]}));o.displayName=f.q7.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.wv,{ref:c,className:(0,g.cn)("-mx-1 my-1 h-px bg-muted",a),...b})).displayName=f.wv.displayName},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},27910:a=>{"use strict";a.exports=require("stream")},28093:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>g,metadata:()=>f});var d=c(75338),e=c(71987);let f={title:"Learn | Tanium TCO"};function g({children:a}){return(0,d.jsx)("div",{className:"mx-auto w-full max-w-7xl px-4 py-6 md:py-8",children:(0,d.jsxs)("div",{className:"md:grid md:grid-cols-[16rem,1fr] md:gap-6",children:[(0,d.jsx)("div",{className:"mb-4 md:mb-0",children:(0,d.jsx)(e.default,{})}),(0,d.jsx)("main",{className:"min-w-0",children:a})]})})}},28354:a=>{"use strict";a.exports=require("util")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30733:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},30887:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},33204:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("code",[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]])},33873:a=>{"use strict";a.exports=require("path")},40068:(a,b,c)=>{"use strict";c.d(b,{Cf:()=>m,Es:()=>o,L3:()=>p,c7:()=>n,lG:()=>i,rr:()=>q,zM:()=>j});var d=c(21124),e=c(38301),f=c(39641),g=c(44943),h=c(11729);let i=f.bL,j=f.l9,k=f.ZL;f.bm;let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.hJ,{ref:c,className:(0,g.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b}));l.displayName=f.hJ.displayName;let m=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(k,{children:[(0,d.jsx)(l,{}),(0,d.jsxs)(f.UC,{ref:e,className:(0,g.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...c,children:[b,(0,d.jsxs)(f.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,d.jsx)(h.MKb,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));m.displayName=f.UC.displayName;let n=({className:a,...b})=>(0,d.jsx)("div",{className:(0,g.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...b});n.displayName="DialogHeader";let o=({className:a,...b})=>(0,d.jsx)("div",{className:(0,g.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...b});o.displayName="DialogFooter";let p=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.hE,{ref:c,className:(0,g.cn)("text-lg font-semibold leading-none tracking-tight",a),...b}));p.displayName=f.hE.displayName;let q=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.VY,{ref:c,className:(0,g.cn)("text-sm text-muted-foreground",a),...b}));q.displayName=f.VY.displayName},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},44928:(a,b,c)=>{"use strict";c.d(b,{Xi:()=>j,av:()=>k,j7:()=>i,tU:()=>h});var d=c(21124),e=c(38301),f=c(89989),g=c(44943);let h=f.bL,i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.B8,{ref:c,className:(0,g.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",a),...b}));i.displayName=f.B8.displayName;let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.l9,{ref:c,className:(0,g.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",a),...b}));j.displayName=f.l9.displayName;let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.UC,{ref:c,className:(0,g.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...b}));k.displayName=f.UC.displayName},45583:(a,b,c)=>{"use strict";c.d(b,{U:()=>f,k:()=>h});var d=c(20558),e=c(70798);async function f(a,b){try{let{data:c,error:f}=await e.N.from("user_module_progress").select("completed_sections,total_sections,last_updated").eq("user_id",a).eq("module_id",b).limit(1);if(f)throw f;let h=Array.isArray(c)?c[0]:c;if(h){let a=Number(h.completed_sections??0),c=Number(h.total_sections??0),d=c>0?g(a/c):0;return{moduleId:b,percentage:d,completed:a,total:c,updatedAt:h.last_updated?new Date(h.last_updated):void 0}}let i=await d.nV.getUserProgress(a,b),j=function(a){if(!a)return 0;if("number"==typeof a.averageScore)return g(a.averageScore);let b=Number(a.completedQuestions??a.questionsCompleted??0),c=Number(a.totalQuestions??a.questionsTotal??a.questionsAttempted??0);return c>0?g(b/c):0}(i);return{moduleId:b,percentage:j,completed:i?.completedQuestions??void 0,total:i?.totalQuestions??void 0,updatedAt:i?.lastActivity??void 0}}catch{return{moduleId:b,percentage:0}}}function g(a){return Number.isNaN(a)?0:Math.max(0,Math.min(1,a))}async function h(a,b=10){try{return await d.nV.getLearningAnalytics(a),[]}catch{return[]}}},50802:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(49754),e=c(9117),f=c(46595),g=c(32324),h=c(39326),i=c(38928),j=c(20175),k=c(12),l=c(54290),m=c(12696),n=c(82802),o=c(77533),p=c(45229),q=c(32822),r=c(261),s=c(26453),t=c(52474),u=c(26713),v=c(51356),w=c(62685),x=c(36225),y=c(63446),z=c(2762),A=c(45742),B=c(86439),C=c(81170),D=c.n(C),E=c(62506),F=c(91203),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["learn",{children:["query-builder",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,69795)),"/home/robne/projects/active/tanium-tco/modern-tco/src/app/learn/query-builder/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,28093)),"/home/robne/projects/active/tanium-tco/modern-tco/src/app/learn/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(c.bind(c,51472)),"/home/robne/projects/active/tanium-tco/modern-tco/src/app/layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,81170,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"]}]}.children,I=["/home/robne/projects/active/tanium-tco/modern-tco/src/app/learn/query-builder/page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/learn/query-builder/page",pathname:"/learn/query-builder",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/learn/query-builder/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw aF||b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},62186:(a,b,c)=>{"use strict";c.d(b,{BT:()=>j,Wu:()=>k,ZB:()=>i,Zp:()=>g,aR:()=>h,wL:()=>l});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,variant:b="cyberpunk",...c},e)=>(0,d.jsx)("div",{ref:e,className:(0,f.cn)("rounded-xl border text-card-foreground shadow",{default:"bg-card",cyberpunk:"relative bg-black/20 backdrop-blur-xl border-cyan-500/20 text-cyan-100 shadow-[0_0_50px_rgba(34,211,238,0.1)] transition-all duration-200 ease-out hover:shadow-[0_0_80px_rgba(34,211,238,0.15)] hover:scale-[1.03] hover:-translate-y-0.5 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400/50"}[b],a),...c}));g.displayName="Card";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex flex-col space-y-1.5 p-6",a),...b}));h.displayName="CardHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("font-semibold leading-none tracking-tight",a),...b}));i.displayName="CardTitle";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("text-sm text-muted-foreground",a),...b}));j.displayName="CardDescription";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("p-6 pt-0",a),...b}));k.displayName="CardContent";let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex items-center p-6 pt-0",a),...b}));l.displayName="CardFooter"},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64772:(a,b,c)=>{"use strict";c.d(b,{Fc:()=>i,TN:()=>j});var d=c(21124),e=c(38301),f=c(26691),g=c(44943);let h=(0,f.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),i=e.forwardRef(({className:a,variant:b,...c},e)=>(0,d.jsx)("div",{ref:e,role:"alert",className:(0,g.cn)(h({variant:b}),a),...c}));i.displayName="Alert",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h5",{ref:c,className:(0,g.cn)("mb-1 font-medium leading-none tracking-tight",a),...b})).displayName="AlertTitle";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,g.cn)("text-sm [&_p]:leading-relaxed",a),...b}));j.displayName="AlertDescription"},65828:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},69795:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/robne/projects/active/tanium-tco/modern-tco/src/app/learn/query-builder/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/robne/projects/active/tanium-tco/modern-tco/src/app/learn/query-builder/page.tsx","default")},71117:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},71987:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/robne/projects/active/tanium-tco/modern-tco/src/components/SideNav.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/robne/projects/active/tanium-tco/modern-tco/src/components/SideNav.tsx","default")},72380:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},72567:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},72954:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("mouse-pointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]])},74075:a=>{"use strict";a.exports=require("zlib")},75219:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},75234:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]])},77274:(a,b,c)=>{Promise.resolve().then(c.bind(c,14153))},77598:a=>{"use strict";a.exports=require("node:crypto")},79202:(a,b,c)=>{"use strict";c.d(b,{A0:()=>h,BF:()=>i,Hj:()=>j,XI:()=>g,nA:()=>l,nd:()=>k});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{className:"relative w-full overflow-auto",children:(0,d.jsx)("table",{ref:c,className:(0,f.cn)("w-full caption-bottom text-sm",a),...b})}));g.displayName="Table";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("thead",{ref:c,className:(0,f.cn)("[&_tr]:border-b",a),...b}));h.displayName="TableHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("tbody",{ref:c,className:(0,f.cn)("[&_tr:last-child]:border-0",a),...b}));i.displayName="TableBody",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("tfoot",{ref:c,className:(0,f.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...b})).displayName="TableFooter";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("tr",{ref:c,className:(0,f.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...b}));j.displayName="TableRow";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("th",{ref:c,className:(0,f.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...b}));k.displayName="TableHead";let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("td",{ref:c,className:(0,f.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...b}));l.displayName="TableCell",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("caption",{ref:c,className:(0,f.cn)("mt-4 text-sm text-muted-foreground",a),...b})).displayName="TableCaption"},79551:a=>{"use strict";a.exports=require("url")},80665:(a,b,c)=>{"use strict";c.d(b,{$:()=>i,F:()=>h});var d=c(21124),e=c(38301),f=c(84550),g=c(44943);let h=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(f.bL,{ref:e,className:(0,g.cn)("relative overflow-hidden",a),...c,children:[(0,d.jsx)(f.LM,{className:"h-full w-full rounded-[inherit]",children:b}),(0,d.jsx)(i,{}),(0,d.jsx)(f.OK,{})]}));h.displayName=f.bL.displayName;let i=e.forwardRef(({className:a,orientation:b="vertical",...c},e)=>(0,d.jsx)(f.VM,{ref:e,orientation:b,className:(0,g.cn)("flex touch-none select-none transition-colors","vertical"===b&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===b&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...c,children:(0,d.jsx)(f.lr,{className:"relative flex-1 rounded-full bg-border"})}));i.displayName=f.VM.displayName},81630:a=>{"use strict";a.exports=require("http")},81925:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},82042:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},85351:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},87890:(a,b,c)=>{Promise.resolve().then(c.bind(c,69795))},88285:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},88617:(a,b,c)=>{"use strict";c.d(b,{RG:()=>v,bL:()=>E,q7:()=>F});var d=c(38301),e=c(87868),f=c(825),g=c(92808),h=c(2332),i=c(75656),j=c(6406),k=c(71700),l=c(11720),m=c(10498),n=c(21124),o="rovingFocusGroup.onEntryFocus",p={bubbles:!1,cancelable:!0},q="RovingFocusGroup",[r,s,t]=(0,f.N)(q),[u,v]=(0,h.A)(q,[t]),[w,x]=u(q),y=d.forwardRef((a,b)=>(0,n.jsx)(r.Provider,{scope:a.__scopeRovingFocusGroup,children:(0,n.jsx)(r.Slot,{scope:a.__scopeRovingFocusGroup,children:(0,n.jsx)(z,{...a,ref:b})})}));y.displayName=q;var z=d.forwardRef((a,b)=>{let{__scopeRovingFocusGroup:c,orientation:f,loop:h=!1,dir:i,currentTabStopId:r,defaultCurrentTabStopId:t,onCurrentTabStopIdChange:u,onEntryFocus:v,preventScrollOnEntryFocus:x=!1,...y}=a,z=d.useRef(null),A=(0,g.s)(b,z),B=(0,m.jH)(i),[C,E]=(0,l.i)({prop:r,defaultProp:t??null,onChange:u,caller:q}),[F,G]=d.useState(!1),H=(0,k.c)(v),I=s(c),J=d.useRef(!1),[K,L]=d.useState(0);return d.useEffect(()=>{let a=z.current;if(a)return a.addEventListener(o,H),()=>a.removeEventListener(o,H)},[H]),(0,n.jsx)(w,{scope:c,orientation:f,dir:B,loop:h,currentTabStopId:C,onItemFocus:d.useCallback(a=>E(a),[E]),onItemShiftTab:d.useCallback(()=>G(!0),[]),onFocusableItemAdd:d.useCallback(()=>L(a=>a+1),[]),onFocusableItemRemove:d.useCallback(()=>L(a=>a-1),[]),children:(0,n.jsx)(j.sG.div,{tabIndex:F||0===K?-1:0,"data-orientation":f,...y,ref:A,style:{outline:"none",...a.style},onMouseDown:(0,e.mK)(a.onMouseDown,()=>{J.current=!0}),onFocus:(0,e.mK)(a.onFocus,a=>{let b=!J.current;if(a.target===a.currentTarget&&b&&!F){let b=new CustomEvent(o,p);if(a.currentTarget.dispatchEvent(b),!b.defaultPrevented){let a=I().filter(a=>a.focusable);D([a.find(a=>a.active),a.find(a=>a.id===C),...a].filter(Boolean).map(a=>a.ref.current),x)}}J.current=!1}),onBlur:(0,e.mK)(a.onBlur,()=>G(!1))})})}),A="RovingFocusGroupItem",B=d.forwardRef((a,b)=>{let{__scopeRovingFocusGroup:c,focusable:f=!0,active:g=!1,tabStopId:h,children:k,...l}=a,m=(0,i.B)(),o=h||m,p=x(A,c),q=p.currentTabStopId===o,t=s(c),{onFocusableItemAdd:u,onFocusableItemRemove:v,currentTabStopId:w}=p;return d.useEffect(()=>{if(f)return u(),()=>v()},[f,u,v]),(0,n.jsx)(r.ItemSlot,{scope:c,id:o,focusable:f,active:g,children:(0,n.jsx)(j.sG.span,{tabIndex:q?0:-1,"data-orientation":p.orientation,...l,ref:b,onMouseDown:(0,e.mK)(a.onMouseDown,a=>{f?p.onItemFocus(o):a.preventDefault()}),onFocus:(0,e.mK)(a.onFocus,()=>p.onItemFocus(o)),onKeyDown:(0,e.mK)(a.onKeyDown,a=>{if("Tab"===a.key&&a.shiftKey)return void p.onItemShiftTab();if(a.target!==a.currentTarget)return;let b=function(a,b,c){var d;let e=(d=a.key,"rtl"!==c?d:"ArrowLeft"===d?"ArrowRight":"ArrowRight"===d?"ArrowLeft":d);if(!("vertical"===b&&["ArrowLeft","ArrowRight"].includes(e))&&!("horizontal"===b&&["ArrowUp","ArrowDown"].includes(e)))return C[e]}(a,p.orientation,p.dir);if(void 0!==b){if(a.metaKey||a.ctrlKey||a.altKey||a.shiftKey)return;a.preventDefault();let c=t().filter(a=>a.focusable).map(a=>a.ref.current);if("last"===b)c.reverse();else if("prev"===b||"next"===b){"prev"===b&&c.reverse();let d=c.indexOf(a.currentTarget);c=p.loop?function(a,b){return a.map((c,d)=>a[(b+d)%a.length])}(c,d+1):c.slice(d+1)}setTimeout(()=>D(c))}}),children:"function"==typeof k?k({isCurrentTabStop:q,hasTabStop:null!=w}):k})})});B.displayName=A;var C={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function D(a,b=!1){let c=document.activeElement;for(let d of a)if(d===c||(d.focus({preventScroll:b}),document.activeElement!==c))return}var E=y,F=B},89989:(a,b,c)=>{"use strict";c.d(b,{B8:()=>D,UC:()=>F,bL:()=>C,l9:()=>E});var d=c(38301),e=c(87868),f=c(2332),g=c(88617),h=c(29988),i=c(6406),j=c(10498),k=c(11720),l=c(75656),m=c(21124),n="Tabs",[o,p]=(0,f.A)(n,[g.RG]),q=(0,g.RG)(),[r,s]=o(n),t=d.forwardRef((a,b)=>{let{__scopeTabs:c,value:d,onValueChange:e,defaultValue:f,orientation:g="horizontal",dir:h,activationMode:o="automatic",...p}=a,q=(0,j.jH)(h),[s,t]=(0,k.i)({prop:d,onChange:e,defaultProp:f??"",caller:n});return(0,m.jsx)(r,{scope:c,baseId:(0,l.B)(),value:s,onValueChange:t,orientation:g,dir:q,activationMode:o,children:(0,m.jsx)(i.sG.div,{dir:q,"data-orientation":g,...p,ref:b})})});t.displayName=n;var u="TabsList",v=d.forwardRef((a,b)=>{let{__scopeTabs:c,loop:d=!0,...e}=a,f=s(u,c),h=q(c);return(0,m.jsx)(g.bL,{asChild:!0,...h,orientation:f.orientation,dir:f.dir,loop:d,children:(0,m.jsx)(i.sG.div,{role:"tablist","aria-orientation":f.orientation,...e,ref:b})})});v.displayName=u;var w="TabsTrigger",x=d.forwardRef((a,b)=>{let{__scopeTabs:c,value:d,disabled:f=!1,...h}=a,j=s(w,c),k=q(c),l=A(j.baseId,d),n=B(j.baseId,d),o=d===j.value;return(0,m.jsx)(g.q7,{asChild:!0,...k,focusable:!f,active:o,children:(0,m.jsx)(i.sG.button,{type:"button",role:"tab","aria-selected":o,"aria-controls":n,"data-state":o?"active":"inactive","data-disabled":f?"":void 0,disabled:f,id:l,...h,ref:b,onMouseDown:(0,e.mK)(a.onMouseDown,a=>{f||0!==a.button||!1!==a.ctrlKey?a.preventDefault():j.onValueChange(d)}),onKeyDown:(0,e.mK)(a.onKeyDown,a=>{[" ","Enter"].includes(a.key)&&j.onValueChange(d)}),onFocus:(0,e.mK)(a.onFocus,()=>{let a="manual"!==j.activationMode;o||f||!a||j.onValueChange(d)})})})});x.displayName=w;var y="TabsContent",z=d.forwardRef((a,b)=>{let{__scopeTabs:c,value:e,forceMount:f,children:g,...j}=a,k=s(y,c),l=A(k.baseId,e),n=B(k.baseId,e),o=e===k.value,p=d.useRef(o);return d.useEffect(()=>{let a=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(a)},[]),(0,m.jsx)(h.C,{present:f||o,children:({present:c})=>(0,m.jsx)(i.sG.div,{"data-state":o?"active":"inactive","data-orientation":k.orientation,role:"tabpanel","aria-labelledby":l,hidden:!c,id:n,tabIndex:0,...j,ref:b,style:{...a.style,animationDuration:p.current?"0s":void 0},children:c&&g})})});function A(a,b){return`${a}-trigger-${b}`}function B(a,b){return`${a}-content-${b}`}z.displayName=y;var C=t,D=v,E=x,F=z},90477:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("type",[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]])},93758:(a,b,c)=>{"use strict";c.d(b,{p:()=>g});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,type:b,...c},e)=>(0,d.jsx)("input",{type:b,className:(0,f.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:e,...c}));g.displayName="Input"},96899:(a,b,c)=>{Promise.resolve().then(c.bind(c,3625))}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[4586,2236,5409,5693,4550,2838],()=>b(b.s=50802));module.exports=c})();