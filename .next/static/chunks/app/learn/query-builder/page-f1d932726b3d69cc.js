(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2942],{3730:(e,t,s)=>{"use strict";s.d(t,{Ke:()=>n,Nt:()=>a,R6:()=>i});var r=s(57259);let a=r.bL,{R6:i}=r,{Ke:n}=r},3998:(e,t,s)=>{"use strict";s.d(t,{$:()=>c});var r=s(95155),a=s(12115),i=s(32467),n=s(83101),l=s(64269);let o=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all duration-200 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400/50 focus-visible:shadow-[0_0_20px_rgba(34,211,238,0.15)] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-cyan-600 text-white shadow-[0_0_20px_rgba(34,211,238,0.1)] hover:bg-cyan-500 hover:shadow-[0_0_30px_rgba(34,211,238,0.15)] hover:scale-105 border border-cyan-500/50",destructive:"bg-red-600 text-white shadow-[0_0_20px_rgba(239,68,68,0.1)] hover:bg-red-500 hover:shadow-[0_0_30px_rgba(239,68,68,0.15)] border border-red-500/50",outline:"border border-cyan-500/30 bg-black/20 backdrop-blur-xl text-cyan-100 shadow-[0_0_20px_rgba(34,211,238,0.05)] hover:bg-cyan-500/10 hover:text-cyan-400 hover:shadow-[0_0_30px_rgba(34,211,238,0.1)]",secondary:"bg-slate-600 text-slate-100 shadow-[0_0_20px_rgba(71,85,105,0.1)] hover:bg-slate-500 hover:shadow-[0_0_30px_rgba(71,85,105,0.15)] border border-slate-500/50",ghost:"text-cyan-100 hover:bg-cyan-500/10 hover:text-cyan-400",link:"text-cyan-400 underline-offset-4 hover:underline hover:text-cyan-300"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:s,variant:a,size:n,asChild:c=!1,...d}=e,u=c?i.DX:"button";return(0,r.jsx)(u,{className:(0,l.cn)(o({variant:a,size:n,className:s})),ref:t,...d})});c.displayName="Button"},11186:(e,t,s)=>{"use strict";s.d(t,{Select:()=>o,SelectContent:()=>h,SelectItem:()=>p,SelectTrigger:()=>d,SelectValue:()=>c});var r=s(95155),a=s(12115),i=s(47887),n=s(64269),l=s(31719);let o=i.bL;i.YJ;let c=i.WT,d=a.forwardRef((e,t)=>{let{className:s,children:a,...o}=e;return(0,r.jsxs)(i.l9,{ref:t,className:(0,n.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[placeholder]:text-muted-foreground [&>span]:line-clamp-1",s),...o,children:[a,(0,r.jsx)(i.In,{asChild:!0,children:(0,r.jsx)(l.D3D,{className:"h-4 w-4 opacity-50"})})]})});d.displayName=i.l9.displayName;let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.PP,{ref:t,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(l.Mtm,{className:"h-4 w-4"})})});u.displayName=i.PP.displayName;let m=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.wn,{ref:t,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(l.D3D,{className:"h-4 w-4"})})});m.displayName=i.wn.displayName;let h=a.forwardRef((e,t)=>{let{className:s,children:a,position:l="popper",...o}=e;return(0,r.jsx)(i.ZL,{children:(0,r.jsxs)(i.UC,{ref:t,className:(0,n.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] origin-[--radix-select-content-transform-origin] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...o,children:[(0,r.jsx)(u,{}),(0,r.jsx)(i.LM,{className:(0,n.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(m,{})]})})});h.displayName=i.UC.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.JU,{ref:t,className:(0,n.cn)("px-2 py-1.5 text-sm font-semibold",s),...a})}).displayName=i.JU.displayName;let p=a.forwardRef((e,t)=>{let{className:s,children:a,...o}=e;return(0,r.jsxs)(i.q7,{ref:t,className:(0,n.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...o,children:[(0,r.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(i.VF,{children:(0,r.jsx)(l.Srz,{className:"h-4 w-4"})})}),(0,r.jsx)(i.p4,{children:a})]})});p.displayName=i.q7.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.wv,{ref:t,className:(0,n.cn)("-mx-1 my-1 h-px bg-muted",s),...a})}).displayName=i.wv.displayName},11647:(e,t,s)=>{"use strict";s.d(t,{E:()=>l});var r=s(95155);s(12115);var a=s(83101),i=s(64269);let n=(0,a.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)(n({variant:s}),t),...a})}},13406:(e,t,s)=>{"use strict";s.d(t,{Xi:()=>c,av:()=>d,j7:()=>o,tU:()=>l});var r=s(95155),a=s(12115),i=s(25667),n=s(64269);let l=i.bL,o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.B8,{ref:t,className:(0,n.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",s),...a})});o.displayName=i.B8.displayName;let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.l9,{ref:t,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",s),...a})});c.displayName=i.l9.displayName;let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.UC,{ref:t,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a})});d.displayName=i.UC.displayName},17037:(e,t,s)=>{"use strict";s.d(t,{$:()=>o,F:()=>l});var r=s(95155),a=s(12115),i=s(59034),n=s(64269);let l=a.forwardRef((e,t)=>{let{className:s,children:a,...l}=e;return(0,r.jsxs)(i.bL,{ref:t,className:(0,n.cn)("relative overflow-hidden",s),...l,children:[(0,r.jsx)(i.LM,{className:"h-full w-full rounded-[inherit]",children:a}),(0,r.jsx)(o,{}),(0,r.jsx)(i.OK,{})]})});l.displayName=i.bL.displayName;let o=a.forwardRef((e,t)=>{let{className:s,orientation:a="vertical",...l}=e;return(0,r.jsx)(i.VM,{ref:t,orientation:a,className:(0,n.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...l,children:(0,r.jsx)(i.lr,{className:"relative flex-1 rounded-full bg-border"})})});o.displayName=i.VM.displayName},18332:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>o,TN:()=>c});var r=s(95155),a=s(12115),i=s(83101),n=s(64269);let l=(0,i.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=a.forwardRef((e,t)=>{let{className:s,variant:a,...i}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,n.cn)(l({variant:a}),s),...i})});o.displayName="Alert",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",s),...a})}).displayName="AlertTitle";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",s),...a})});c.displayName="AlertDescription"},51834:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>m,Es:()=>p,L3:()=>g,c7:()=>h,lG:()=>o,rr:()=>x,zM:()=>c});var r=s(95155),a=s(12115),i=s(89511),n=s(64269),l=s(31719);let o=i.bL,c=i.l9,d=i.ZL;i.bm;let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.hJ,{ref:t,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a})});u.displayName=i.hJ.displayName;let m=a.forwardRef((e,t)=>{let{className:s,children:a,...o}=e;return(0,r.jsxs)(d,{children:[(0,r.jsx)(u,{}),(0,r.jsxs)(i.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...o,children:[a,(0,r.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(l.MKb,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=i.UC.displayName;let h=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};h.displayName="DialogHeader";let p=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};p.displayName="DialogFooter";let g=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",s),...a})});g.displayName=i.hE.displayName;let x=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...a})});x.displayName=i.VY.displayName},64269:(e,t,s)=>{"use strict";s.d(t,{J8:()=>n,cn:()=>i});var r=s(2821),a=s(75889);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}function n(e){switch(e.toLowerCase()){case"beginner":return"text-green-600 dark:text-green-400";case"intermediate":return"text-yellow-600 dark:text-yellow-400";case"advanced":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}}},65142:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var r=s(95155),a=s(12115),i=s(64269);let n=a.forwardRef((e,t)=>{let{className:s,type:a,...n}=e;return(0,r.jsx)("input",{type:a,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});n.displayName="Input"},74470:(e,t,s)=>{Promise.resolve().then(s.bind(s,76237))},76237:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eB});var r=s(95155),a=s(12115),i=s(86948),n=s(13406),l=s(3998),o=s(11647),c=s(18332),d=s(6132),u=s(23327),m=s(42529),h=s(86651),p=s(48314),g=s(54485),x=s(85921),y=s(49238),f=s(95740),v=s(9602),b=s(65142),N=s(17037),w=s(51834),j=s(26983),_=s(85710),S=s(6191),k=s(39347),E=s(15870),C=s(27937),T=s(66955),A=s(65229);let R=(0,a.memo)(function(e){let{selectedSensors:t,onAdd:s,onRemove:c,onUpdate:u,catalog:m,maxSensors:p=10,className:g=""}=e,[x,y]=(0,a.useState)(""),[f,v]=(0,a.useState)("all"),[R,O]=(0,a.useState)(!1),[I,L]=(0,a.useState)(null),M=(0,a.useMemo)(()=>["all",...new Set(m.map(e=>e.category))],[m]),D=(0,a.useMemo)(()=>{let e=m;if("all"!==f&&(e=e.filter(e=>e.category===f)),x){let t=x.toLowerCase();e=e.filter(e=>{var s,r;return"name"in e.sensor&&(null==(s=e.sensor.name)?void 0:s.toLowerCase().includes(t))||(null==(r=e.description)?void 0:r.toLowerCase().includes(t))||e.category.toLowerCase().includes(t)})}return e.sort((e,t)=>{if(e.popularity!==t.popularity)return t.popularity-e.popularity;let s={fast:1,medium:2,slow:3};return(s[e.runtime]||4)-(s[t.runtime]||4)}),e},[m,x,f]),P=(0,a.useMemo)(()=>m.filter(e=>e.popularity>.7).sort((e,t)=>t.popularity-e.popularity).slice(0,6),[m]),B=(0,a.useCallback)(e=>{var r;if(t.length>=p)return void alert("Maximum ".concat(p," sensors allowed"));s({sensor:e.sensor,parameters:null==(r=e.parameters)?void 0:r.reduce((e,t)=>(void 0!==t.default&&(e[t.name]=t.default),e),{}),isValid:!0}),O(!1)},[t.length,p,s]),q=(e,t)=>{let s={fast:"border-green-500 text-green-400",medium:"border-yellow-500 text-yellow-400",slow:"border-red-500 text-red-400"};return(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs ".concat(s[e]||s.slow),children:[(0,r.jsx)(j.A,{className:"h-3 w-3 mr-1"}),t?"".concat(t,"ms"):e]})};return(0,r.jsxs)(i.Zp,{className:"glass border-white/10 ".concat(g),children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(i.ZB,{className:"flex items-center text-white",children:[(0,r.jsx)(_.A,{className:"mr-2 h-5 w-5"}),"Select Sensors",(0,r.jsxs)(o.E,{variant:"secondary",className:"ml-2",children:[t.length," / ",p]})]}),(0,r.jsxs)(w.lG,{open:R,onOpenChange:O,children:[(0,r.jsx)(w.zM,{asChild:!0,children:(0,r.jsxs)(l.$,{size:"sm",disabled:t.length>=p,className:"bg-tanium-accent hover:bg-blue-600",children:[(0,r.jsx)(S.A,{className:"mr-1 h-4 w-4"}),"Add Sensor"]})}),(0,r.jsxs)(w.Cf,{className:"max-w-3xl bg-gray-900 border-gray-700",children:[(0,r.jsxs)(w.c7,{children:[(0,r.jsx)(w.L3,{className:"text-white",children:"Browse Sensors"}),(0,r.jsx)(w.rr,{className:"text-gray-400",children:"Select sensors to include in your query"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)(b.p,{type:"text",placeholder:"Search sensors...",value:x,onChange:e=>y(e.target.value),className:"pl-10 bg-gray-800 border-gray-600 text-white"})]}),(0,r.jsxs)(n.tU,{value:f,onValueChange:v,children:[(0,r.jsx)(n.j7,{className:"bg-gray-800",children:M.map(e=>(0,r.jsx)(n.Xi,{value:e,children:"all"===e?"All":e},e))}),(0,r.jsxs)(n.av,{value:f,className:"mt-4",children:["all"===f&&""===x&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("h4",{className:"text-sm font-medium text-gray-400 mb-2 flex items-center",children:[(0,r.jsx)(k.A,{className:"mr-1 h-4 w-4"}),"Popular Sensors"]}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:P.map(e=>(0,r.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>B(e),className:"justify-start text-left",children:(0,r.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,r.jsx)("span",{className:"text-white",children:"name"in e.sensor?e.sensor.name:""}),q(e.runtime,e.runtimeMs)]})},e.sensor.key||("name"in e.sensor?e.sensor.name:"")))})]}),(0,r.jsx)(N.F,{className:"h-96",children:(0,r.jsx)("div",{className:"space-y-2",children:D.map(e=>(0,r.jsx)("div",{className:"p-3 border border-gray-700 rounded hover:border-gray-600 cursor-pointer",onClick:()=>B(e),children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"font-medium text-white",children:"name"in e.sensor?e.sensor.name:""}),e.parameters&&e.parameters.length>0&&(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs",children:[(0,r.jsx)(E.A,{className:"h-3 w-3 mr-1"}),"Parameterized"]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:e.description}),e.examples&&e.examples.length>0&&(0,r.jsxs)("div",{className:"mt-1 text-xs text-gray-500",children:["Example: ",e.examples[0]]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[q(e.runtime,e.runtimeMs),(0,r.jsx)(C.A,{className:"h-4 w-4 text-gray-400"})]})]})},e.sensor.key||("name"in e.sensor?e.sensor.name:"")))})})]})]})]})]})]})]})}),(0,r.jsx)(i.Wu,{children:0===t.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,r.jsx)(_.A,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,r.jsx)("p",{children:"No sensors selected"}),(0,r.jsx)("p",{className:"text-sm mt-1",children:'Click "Add Sensor" to get started'})]}):(0,r.jsx)("div",{className:"space-y-2",children:t.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-gray-800 rounded border border-gray-700",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"font-medium text-white",children:"name"in e.sensor?e.sensor.name:""}),e.filter&&(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs",children:[(0,r.jsx)(T.A,{className:"h-3 w-3 mr-1"}),"Filtered"]}),!e.isValid&&(0,r.jsxs)(o.E,{variant:"destructive",className:"text-xs",children:[(0,r.jsx)(d.A,{className:"h-3 w-3 mr-1"}),"Invalid"]})]}),e.parameters&&Object.keys(e.parameters).length>0&&(0,r.jsx)("div",{className:"mt-2 space-y-2",children:Object.entries(e.parameters).map(e=>{let[a,i]=e;return(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("label",{className:"text-sm text-gray-400 w-24",children:[a,":"]}),(0,r.jsx)(b.p,{type:"text",value:i,onChange:e=>((e,s,r)=>{let a=t[e];u(e,{...a,parameters:{...a.parameters,[s]:r}})})(s,a,e.target.value),className:"flex-1 h-8 bg-gray-700 border-gray-600 text-white"})]},a)})}),e.filter&&(0,r.jsxs)("div",{className:"mt-2 text-sm text-gray-400",children:["Filter: ",e.filter.operator,' "',e.filter.value,'"']})]}),(0,r.jsx)(l.$,{size:"sm",variant:"ghost",onClick:()=>c(s),className:"text-gray-400 hover:text-white",children:(0,r.jsx)(A.A,{className:"h-4 w-4"})})]},s))})})]})});var O=s(11186),I=s(3730),L=s(40583),M=s(37107),D=s(16485),P=s(64347),B=s(24033),q=s(79397);let F={text:[{value:"contains",label:"Contains"},{value:"does_not_contain",label:"Does not contain"},{value:"equals",label:"Equals"},{value:"not_equals",label:"Not equals"},{value:"starts_with",label:"Starts with"},{value:"ends_with",label:"Ends with"},{value:"matches",label:"Matches (regex)"}],number:[{value:"equals",label:"Equals"},{value:"not_equals",label:"Not equals"},{value:"greater_than",label:"Greater than"},{value:"less_than",label:"Less than"},{value:"greater_or_equal",label:"Greater or equal"},{value:"less_or_equal",label:"Less or equal"}],date:[{value:"equals",label:"On"},{value:"not_equals",label:"Not on"},{value:"greater_than",label:"After"},{value:"less_than",label:"Before"},{value:"greater_or_equal",label:"On or after"},{value:"less_or_equal",label:"On or before"}],boolean:[{value:"equals",label:"Is"},{value:"not_equals",label:"Is not"}]},U={"Computer Name":"text","Operating System":"text","IP Address":"text","CPU Percent":"number","Disk Free GB":"number","Memory GB":"number","Last Reboot":"date","Is Virtual":"boolean","Compliance Score":"number","Last Logged In User":"text"};function G(e){let{filters:t,parentId:s,depth:i=0,logic:n,onAdd:c,onRemove:d,onUpdate:u,onLogicChange:m,availableSensors:h,allowNested:p}=e,[g,x]=(0,a.useState)(!0),y=t.filter(e=>s?e.parentId===s:!e.parentId),f=[...new Set(t.filter(e=>e.isNested&&e.parentId===s).map(e=>e.id))];return(0,r.jsxs)("div",{className:"space-y-2 ".concat(i>0?"pl-8 border-l-2 border-gray-700":""),children:[i>0&&(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)(I.Nt,{open:g,onOpenChange:x,children:(0,r.jsx)(I.R6,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"ghost",size:"sm",className:"p-1",children:g?(0,r.jsx)(B.A,{className:"h-4 w-4"}):(0,r.jsx)(C.A,{className:"h-4 w-4"})})})}),(0,r.jsx)(o.E,{variant:"secondary",className:"text-xs",children:"Group"}),(0,r.jsxs)(O.Select,{value:n,onValueChange:e=>m(e,s),children:[(0,r.jsx)(O.SelectTrigger,{className:"w-20 h-6 bg-gray-700 border-gray-600",children:(0,r.jsx)(O.SelectValue,{})}),(0,r.jsxs)(O.SelectContent,{children:[(0,r.jsx)(O.SelectItem,{value:"AND",children:"AND"}),(0,r.jsx)(O.SelectItem,{value:"OR",children:"OR"})]})]})]}),(!i||g)&&(0,r.jsxs)(r.Fragment,{children:[y.filter(e=>!e.isNested).map((e,t)=>(0,r.jsxs)("div",{className:"flex items-start space-x-2",children:[t>0&&(0,r.jsx)("div",{className:"w-12 pt-2 text-center",children:(0,r.jsx)(o.E,{variant:"outline",className:"text-xs ".concat("AND"===n?"border-blue-500 text-blue-400":"border-orange-500 text-orange-400"),children:n})}),(0,r.jsxs)("div",{className:"flex-1 flex items-start space-x-2 p-2 bg-gray-800 rounded border border-gray-700 ".concat(0===t?"":"ml-12"),children:[(0,r.jsxs)(O.Select,{value:e.sensor,onValueChange:t=>{let s=U[t]||"text";u(e.id,{...e,sensor:t,dataType:s})},children:[(0,r.jsx)(O.SelectTrigger,{className:"w-48 bg-gray-700 border-gray-600",children:(0,r.jsx)(O.SelectValue,{placeholder:"Select sensor"})}),(0,r.jsx)(O.SelectContent,{children:h.map(e=>(0,r.jsx)(O.SelectItem,{value:e,children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(e=>{switch(e){case"text":return(0,r.jsx)(L.A,{className:"h-3 w-3"});case"number":return(0,r.jsx)(M.A,{className:"h-3 w-3"});case"date":return(0,r.jsx)(D.A,{className:"h-3 w-3"});case"boolean":return(0,r.jsx)(P.A,{className:"h-3 w-3"});default:return null}})(U[e]||"text"),(0,r.jsx)("span",{children:e})]})},e))})]}),(0,r.jsxs)(O.Select,{value:e.operator,onValueChange:t=>u(e.id,{...e,operator:t}),children:[(0,r.jsx)(O.SelectTrigger,{className:"w-40 bg-gray-700 border-gray-600",children:(0,r.jsx)(O.SelectValue,{})}),(0,r.jsx)(O.SelectContent,{children:F[e.dataType].map(e=>(0,r.jsx)(O.SelectItem,{value:e.value,children:e.label},e.value))})]}),"boolean"===e.dataType?(0,r.jsxs)(O.Select,{value:e.value.toString(),onValueChange:t=>u(e.id,{...e,value:"true"===t}),children:[(0,r.jsx)(O.SelectTrigger,{className:"flex-1 bg-gray-700 border-gray-600",children:(0,r.jsx)(O.SelectValue,{})}),(0,r.jsxs)(O.SelectContent,{children:[(0,r.jsx)(O.SelectItem,{value:"true",children:"True"}),(0,r.jsx)(O.SelectItem,{value:"false",children:"False"})]})]}):(0,r.jsx)(b.p,{type:"number"===e.dataType?"number":"date"===e.dataType?"date":"text",value:"boolean"==typeof e.value?String(e.value):e.value,onChange:t=>u(e.id,{...e,value:t.target.value}),placeholder:"Enter ".concat(e.dataType," value"),className:"flex-1 bg-gray-700 border-gray-600 text-white"}),(0,r.jsx)(l.$,{size:"sm",variant:"ghost",onClick:()=>d(e.id),className:"text-gray-400 hover:text-white",children:(0,r.jsx)(A.A,{className:"h-4 w-4"})})]})]},e.id)),f.map(e=>{let s=t.find(t=>t.id===e);return s?(0,r.jsx)(G,{filters:t,parentId:e,depth:i+1,logic:s.logic||"AND",onAdd:c,onRemove:d,onUpdate:u,onLogicChange:m,availableSensors:h,allowNested:p},e):null}),(0,r.jsxs)("div",{className:"flex space-x-2 ".concat(y.length>0?"ml-12":""),children:[(0,r.jsxs)(l.$,{size:"sm",variant:"outline",onClick:()=>{c({id:"filter-".concat(Date.now()),sensor:h[0]||"Computer Name",operator:"contains",value:"",dataType:"text",...s&&{parentId:s},logic:"AND"})},className:"text-gray-400 hover:text-white",children:[(0,r.jsx)(S.A,{className:"mr-1 h-3 w-3"}),"Add Filter"]}),p&&i<2&&(0,r.jsxs)(l.$,{size:"sm",variant:"outline",onClick:()=>{c({id:"group-".concat(Date.now()),sensor:"",operator:"equals",value:"",dataType:"text",isNested:!0,...s&&{parentId:s},logic:"AND"})},className:"text-gray-400 hover:text-white",children:[(0,r.jsx)(q.A,{className:"mr-1 h-3 w-3"}),"Add Group"]})]})]})]})}function W(e){let{filters:t,onAdd:s,onRemove:a,onUpdate:n,availableSensors:o,filterLogic:c,onLogicChange:d,allowNested:u=!1,className:m=""}=e;return(0,r.jsxs)(i.Zp,{className:"glass border-white/10 ".concat(m),children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(i.ZB,{className:"flex items-center text-white",children:[(0,r.jsx)(T.A,{className:"mr-2 h-5 w-5"}),"Filter Conditions"]}),t.length>1&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm text-gray-400",children:"Logic:"}),(0,r.jsxs)(O.Select,{value:c,onValueChange:e=>d(e),children:[(0,r.jsx)(O.SelectTrigger,{className:"w-20 h-8 bg-gray-700 border-gray-600",children:(0,r.jsx)(O.SelectValue,{})}),(0,r.jsxs)(O.SelectContent,{children:[(0,r.jsx)(O.SelectItem,{value:"AND",children:"AND"}),(0,r.jsx)(O.SelectItem,{value:"OR",children:"OR"})]})]})]})]})}),(0,r.jsx)(i.Wu,{children:0===t.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,r.jsx)(T.A,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,r.jsx)("p",{children:"No filters applied"}),(0,r.jsx)("p",{className:"text-sm mt-1",children:"Add filters to narrow down results"}),(0,r.jsxs)(l.$,{size:"sm",variant:"outline",onClick:()=>{s({id:"filter-".concat(Date.now()),sensor:o[0]||"Computer Name",operator:"contains",value:"",dataType:"text",logic:"AND"})},className:"mt-4",children:[(0,r.jsx)(S.A,{className:"mr-1 h-3 w-3"}),"Add First Filter"]})]}):(0,r.jsx)(G,{filters:t,depth:0,logic:c,onAdd:s,onRemove:a,onUpdate:n,onLogicChange:d,availableSensors:o,allowNested:u})})]})}var V=s(57828),Q=s(70532),H=s(75426);function z(e){let{query:t,validation:s,syntaxHighlight:n=!0,showWarnings:h=!0,className:p=""}=e,[g,x]=a.useState(!1),[y,f]=a.useState(!1),b=(0,a.useMemo)(()=>{if(t.rawQuery&&t.rawQuery.trim())return t.rawQuery;let e=[];if(t.sensors.length>0||t.aggregates.length>0){e.push("Get");let s=t.sensors.map(e=>{let t="name"in e.sensor&&e.sensor.name||"";return e.filter&&(t+=" ".concat(e.filter.operator,' "').concat(e.filter.value,'"')),t}),r=t.aggregates.map(e=>"".concat(e.function,"(").concat(e.sensor||"",")"));e.push([...s,...r].join(" and "))}if(e.push("from"),"all"===t.scope.type?e.push("all machines"):"group"===t.scope.type&&t.scope.computerGroup?e.push('group "'.concat(t.scope.computerGroup,'"')):"custom"===t.scope.type&&t.scope.customFilter&&e.push("all machines"),t.filters.length>0){e.push("where");let s=t.filters.map(e=>"".concat(e.sensor," ").concat(e.operator.replace("_"," "),' "').concat(e.value,'"'));e.push(s.join(" ".concat(t.filterLogic.toLowerCase()," ")))}if(t.groupBy.length>0&&(e.push("group by"),e.push(t.groupBy.join(", "))),t.orderBy.length>0){e.push("order by");let s=t.orderBy.map(e=>"".concat(e.sensor," ").concat(e.direction));e.push(s.join(", "))}return t.limit&&e.push("limit ".concat(t.limit)),e.join(" ")},[t]),N=(0,a.useMemo)(()=>{if(!n||g)return b;let e=b;return["Get","from","where","with","group by","order by","limit","and","or","all machines","group"].forEach(t=>{let s=RegExp("\\b(".concat(t,")\\b"),"gi");e=e.replace(s,'<span class="text-blue-400 font-semibold">$1</span>')}),["contains","does not contain","equals","not equals","greater than","less than","starts with","ends with","matches"].forEach(t=>{let s=RegExp("\\b(".concat(t,")\\b"),"gi");e=e.replace(s,'<span class="text-purple-400">$1</span>')}),["count","min","max","avg","sum"].forEach(t=>{let s=RegExp("\\b(".concat(t,")\\("),"gi");e=e.replace(s,'<span class="text-green-400">$1</span>(')}),e=(e=e.replace(/"([^"]*)"/g,'<span class="text-yellow-400">"$1"</span>')).replace(/\b(\d+)\b/g,'<span class="text-orange-400">$1</span>'),["Computer Name","Operating System","IP Address","CPU Percent","Disk Free GB","Memory GB","Last Reboot","Last Logged In User"].forEach(t=>{let s=RegExp("\\b(".concat(t,")\\b"),"gi");e=e.replace(s,'<span class="text-cyan-400">$1</span>')}),e},[b,n,g]);return(0,r.jsxs)(i.Zp,{className:"glass border-white/10 ".concat(p),children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(i.ZB,{className:"flex items-center text-white",children:[(0,r.jsx)(v.A,{className:"mr-2 h-5 w-5"}),"Query Preview"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[s.isValid?s.warnings.length>0?(0,r.jsx)(u.A,{className:"h-4 w-4 text-yellow-500"}):(0,r.jsx)(m.A,{className:"h-4 w-4 text-green-500"}):(0,r.jsx)(d.A,{className:"h-4 w-4 text-red-500"}),(0,r.jsx)(l.$,{size:"sm",variant:"ghost",onClick:()=>x(!g),className:"text-gray-400 hover:text-white",children:g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(V.A,{className:"mr-1 h-3 w-3"}),"Formatted"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Q.A,{className:"mr-1 h-3 w-3"}),"Raw"]})}),(0,r.jsx)(l.$,{size:"sm",variant:"ghost",onClick:()=>{navigator.clipboard.writeText(b),f(!0),setTimeout(()=>f(!1),2e3)},className:"text-gray-400 hover:text-white",children:y?(0,r.jsx)(m.A,{className:"h-4 w-4 text-green-400"}):(0,r.jsx)(H.A,{className:"h-4 w-4"})})]})]})}),(0,r.jsxs)(i.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"p-4 bg-gray-900 rounded border border-gray-700 font-mono text-sm overflow-x-auto",style:{minHeight:"60px"},children:b?g?(0,r.jsx)("pre",{className:"text-gray-300 whitespace-pre-wrap",children:b}):(0,r.jsx)("div",{className:"text-gray-300",dangerouslySetInnerHTML:{__html:N}}):(0,r.jsx)("span",{className:"text-gray-500 italic",children:"Start building your query above..."})}),!b&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,r.jsx)(o.E,{variant:"outline",className:"border-gray-600 text-gray-400",children:"Empty Query"})})]}),s.errors.length>0&&(0,r.jsxs)(c.Fc,{className:"border-red-500 bg-red-500/10",children:[(0,r.jsx)(d.A,{className:"h-4 w-4 text-red-500"}),(0,r.jsxs)(c.TN,{className:"text-red-400",children:[(0,r.jsx)("div",{className:"font-semibold mb-1",children:"Query Errors:"}),(0,r.jsx)("ul",{className:"list-disc list-inside space-y-1",children:s.errors.map((e,t)=>(0,r.jsxs)("li",{className:"text-sm",children:[e.field&&(0,r.jsxs)("span",{className:"font-mono",children:[e.field,": "]}),e.message]},t))})]})]}),h&&s.warnings.length>0&&(0,r.jsxs)(c.Fc,{className:"border-yellow-500 bg-yellow-500/10",children:[(0,r.jsx)(u.A,{className:"h-4 w-4 text-yellow-500"}),(0,r.jsxs)(c.TN,{className:"text-yellow-400",children:[(0,r.jsx)("div",{className:"font-semibold mb-1",children:"Warnings:"}),(0,r.jsx)("ul",{className:"list-disc list-inside space-y-1",children:s.warnings.map((e,t)=>(0,r.jsxs)("li",{className:"text-sm",children:[e.field&&(0,r.jsxs)("span",{className:"font-mono",children:[e.field,": "]}),e.message,e.suggestion&&(0,r.jsxs)("div",{className:"ml-4 text-xs text-yellow-300 mt-0.5",children:["\uD83D\uDCA1 ",e.suggestion]})]},t))})]})]}),s.isValid&&b&&(0,r.jsxs)(c.Fc,{className:"border-green-500 bg-green-500/10",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 text-green-500"}),(0,r.jsx)(c.TN,{className:"text-green-400",children:"Query is valid and ready to execute"})]}),b&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[t.sensors.length>0&&(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs",children:[t.sensors.length," sensor",1!==t.sensors.length?"s":""]}),t.aggregates.length>0&&(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs",children:[t.aggregates.length," aggregate",1!==t.aggregates.length?"s":""]}),t.filters.length>0&&(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs",children:[t.filters.length," filter",1!==t.filters.length?"s":""]}),t.groupBy.length>0&&(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs",children:["Grouped by ",t.groupBy.length," field",1!==t.groupBy.length?"s":""]}),t.orderBy.length>0&&(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs",children:["Sorted by ",t.orderBy.length," field",1!==t.orderBy.length?"s":""]}),t.limit&&(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs",children:["Limited to ",t.limit," rows"]})]})]})]})}var Y=s(87270),Z=s(93341),$=s(20562),X=s(8803),K=s(35299),J=s(89715),ee=s(35202),et=s(41669),es=s(80534),er=s(90368),ea=s(12108);function ei(e){let{data:t,columns:s,rowHeight:n=48,containerHeight:c=600,onRowClick:u,className:m="",emptyMessage:h="No results found",loading:p=!1,striped:g=!0,highlightOnHover:x=!0}=e,y=(0,a.useRef)(null),[f,v]=(0,a.useState)(0),[b,N]=(0,a.useState)({key:null,direction:"asc"}),w=(0,a.useCallback)(()=>{y.current&&v(y.current.scrollTop)},[]);(0,a.useEffect)(()=>{let e=y.current;if(e)return e.addEventListener("scroll",w,{passive:!0}),()=>e.removeEventListener("scroll",w)},[w]);let j=(0,a.useMemo)(()=>b.key?[...t].sort((e,t)=>{let s=e[b.key],r=t[b.key];if(null==s)return 1;if(null==r)return -1;if("string"==typeof s){let e=s.localeCompare(r);return"asc"===b.direction?e:-e}return s<r?"asc"===b.direction?-1:1:s>r?"asc"===b.direction?1:-1:0}):t,[t,b]),{visibleItems:S,startIndex:k,offsetY:E,totalHeight:C}=(0,a.useMemo)(()=>(function(e,t,s,r){let a=e.length*s,i=Math.floor(r/s),n=Math.min(e.length-1,Math.floor((r+t)/s)),l=Math.max(0,i-5),o=Math.min(e.length-1,n+5);return{visibleItems:e.slice(l,o+1),startIndex:l,endIndex:o,offsetY:l*s,totalHeight:a}})(j,c,n,f),[j,c,n,f]),T=(0,a.useCallback)((e,t,s)=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),null==u||u(t,s))},[u]);return p?(0,r.jsx)(i.Zp,{className:"glass border-white/10 ".concat(m),children:(0,r.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-tanium-accent mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-400",children:"Loading results..."})]})})}):0===t.length?(0,r.jsx)(i.Zp,{className:"glass border-white/10 ".concat(m),children:(0,r.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,r.jsxs)("div",{className:"text-center text-gray-400",children:[(0,r.jsx)(_.A,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,r.jsx)("p",{children:h})]})})}):(0,r.jsxs)(i.Zp,{className:"glass border-white/10 overflow-hidden ".concat(m),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(_.A,{className:"h-5 w-5 text-tanium-accent"}),(0,r.jsx)("span",{className:"font-medium text-white",children:"Query Results"}),(0,r.jsxs)(o.E,{variant:"secondary",children:[t.length.toLocaleString()," rows"]})]}),S.length<t.length&&(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs",children:["Showing ",k+1,"-",k+S.length," of ",t.length]})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"sticky top-0 z-10 bg-gray-800 border-b border-gray-700",children:(0,r.jsx)(Y.XI,{children:(0,r.jsx)(Y.A0,{children:(0,r.jsx)(Y.Hj,{className:"hover:bg-transparent",children:s.map(e=>(0,r.jsx)(Y.nd,{style:{width:e.width},className:"text-gray-300",children:!1!==e.sortable?(0,r.jsxs)(l.$,{variant:"ghost",size:"sm",onClick:()=>{var t;return t=e.key,void N(e=>({key:t,direction:e.key===t&&"asc"===e.direction?"desc":"asc"}))},className:"h-auto p-0 font-medium text-gray-300 hover:text-white",children:[e.label,b.key===e.key&&(0,r.jsx)("span",{className:"ml-2",children:"asc"===b.direction?(0,r.jsx)(ea.A,{className:"h-3 w-3"}):(0,r.jsx)(B.A,{className:"h-3 w-3"})})]}):e.label},e.key))})})})}),(0,r.jsx)("div",{ref:y,className:"overflow-auto",style:{height:c},role:"region","aria-label":"Query results table",children:(0,r.jsx)("div",{style:{height:C,position:"relative"},children:(0,r.jsx)("div",{style:{transform:"translateY(".concat(E,"px)"),position:"absolute",top:0,left:0,right:0},children:(0,r.jsx)(Y.XI,{children:(0,r.jsx)(Y.BF,{children:S.map((e,t)=>{let a=k+t;return(0,r.jsx)(Y.Hj,{className:"\n                          ".concat(g&&a%2==0?"bg-gray-800/50":"","\n                          ").concat(x?"hover:bg-gray-700/50":"","\n                          ").concat(u?"cursor-pointer":"","\n                          transition-colors\n                        "),style:{height:n},onClick:()=>null==u?void 0:u(e,a),onKeyDown:t=>T(t,e,a),tabIndex:u?0:void 0,role:u?"button":void 0,"aria-label":u?"Row ".concat(a+1):void 0,children:s.map(t=>{var s;return(0,r.jsx)(Y.nA,{style:{width:t.width},className:"text-gray-300",children:t.render?t.render(e[t.key],e):(null==(s=e[t.key])?void 0:s.toString())||"-"},t.key)})},a)})})})})})})]}),t.length>1e3&&(0,r.jsx)("div",{className:"p-2 border-t border-gray-700 bg-gray-800/50",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[(0,r.jsx)(d.A,{className:"h-3 w-3"}),(0,r.jsxs)("span",{children:["Virtual scrolling enabled for optimal performance with ",t.length.toLocaleString()," rows"]})]})})]})}function en(e){var t,s;let{result:u,isLoading:p=!1,onExport:g,onSort:x,pageSize:y=50,className:f=""}=e,[v,w]=(0,a.useState)(1),[j,S]=(0,a.useState)(""),[k,E]=(0,a.useState)(null),[T,A]=(0,a.useState)("asc"),[R,I]=(0,a.useState)("table"),[L,M]=(0,a.useState)(!1),D=(0,a.useMemo)(()=>{if(!u||!u.rows)return[];let e=[...u.rows];if(j){let t=j.toLowerCase();e=e.filter(e=>e.some(e=>String(e).toLowerCase().includes(t)))}if(null!==k&&u.headers){let t=u.headers.indexOf(k);t>=0&&e.sort((e,s)=>{let r=e[t],a=s[t];if(null==r)return 1;if(null==a)return -1;let i=r<a?-1:+(r>a);return"asc"===T?i:-i})}return e},[u,j,k,T]);(0,a.useMemo)(()=>{D.length>1e3&&!L&&(M(!0),I("virtual"))},[D.length,L]);let P=(0,a.useMemo)(()=>u&&u.headers&&D?D.map(e=>{var t;let s={};return null==(t=u.headers)||t.forEach((t,r)=>{s[t]=e[r]}),s}):[],[u,D]),B=(0,a.useMemo)(()=>u&&u.headers?u.headers.map(e=>({key:e,label:e,sortable:!0,render:e=>null==e?(0,r.jsx)("span",{className:"text-gray-500 italic",children:"null"}):"boolean"==typeof e?(0,r.jsx)(o.E,{variant:"outline",className:e?"border-green-500 text-green-400":"border-red-500 text-red-400",children:String(e)}):String(e)})):[],[u]),q=Math.ceil(D.length/y),F=(0,a.useMemo)(()=>{let e=(v-1)*y;return D.slice(e,e+y)},[D,v,y]),U=(0,a.useCallback)(e=>{k===e?A(e=>"asc"===e?"desc":"asc"):(E(e),A("asc")),x&&x(e,"asc"===T?"desc":"asc")},[k,T,x]),G=(0,a.useCallback)(e=>{if(u&&u.rows&&g)if("csv"===e&&u.csv){let e=new Blob([u.csv],{type:"text/csv"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="query-results-".concat(Date.now(),".csv"),s.click(),URL.revokeObjectURL(t)}else g(e)},[u,g]);return p?(0,r.jsx)(i.Zp,{className:"glass border-white/10 ".concat(f),children:(0,r.jsx)(i.Wu,{className:"flex items-center justify-center py-12",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(K.A,{className:"h-8 w-8 animate-spin text-tanium-accent mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Executing query..."})]})})}):u&&!u.ok?(0,r.jsxs)(i.Zp,{className:"glass border-white/10 ".concat(f),children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{className:"flex items-center text-white",children:[(0,r.jsx)(_.A,{className:"mr-2 h-5 w-5"}),"Query Results"]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsxs)(c.Fc,{className:"border-red-500 bg-red-500/10",children:[(0,r.jsx)(d.A,{className:"h-4 w-4 text-red-500"}),(0,r.jsxs)(c.TN,{className:"text-red-400",children:[(0,r.jsx)("div",{className:"font-semibold",children:"Query execution failed"}),(0,r.jsx)("div",{className:"mt-1 text-sm",children:u.error})]})]})})]}):u&&u.rows&&0!==u.rows.length?(0,r.jsxs)(i.Zp,{className:"glass border-white/10 ".concat(f),children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(i.ZB,{className:"flex items-center text-white",children:[(0,r.jsx)(_.A,{className:"mr-2 h-5 w-5"}),"Query Results",(0,r.jsxs)(o.E,{variant:"secondary",className:"ml-2",children:[D.length," ",1===D.length?"row":"rows"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(h.A,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)(b.p,{type:"text",placeholder:"Search results...",value:j,onChange:e=>{S(e.target.value),w(1)},className:"pl-8 w-48 h-8 bg-gray-800 border-gray-600 text-white"})]}),g&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l.$,{size:"sm",variant:"ghost",onClick:()=>G("csv"),className:"text-gray-400 hover:text-white",children:[(0,r.jsx)(J.A,{className:"mr-1 h-3 w-3"}),"CSV"]}),(0,r.jsxs)(l.$,{size:"sm",variant:"ghost",onClick:()=>G("json"),className:"text-gray-400 hover:text-white",children:[(0,r.jsx)(ee.A,{className:"mr-1 h-3 w-3"}),"JSON"]})]})]})]})}),(0,r.jsxs)(i.Wu,{className:"space-y-4",children:[u.execution&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs border-green-500 text-green-400",children:[(0,r.jsx)(m.A,{className:"mr-1 h-3 w-3"}),"Success"]}),(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs",children:["Execution: ",u.execution.totalTimeMs,"ms"]}),u.execution.cacheHit&&(0,r.jsx)(o.E,{variant:"outline",className:"text-xs border-blue-500 text-blue-400",children:"Cached"}),void 0!==u.execution.rowsExamined&&(0,r.jsxs)(o.E,{variant:"outline",className:"text-xs",children:["Examined: ",u.execution.rowsExamined," rows"]})]}),D.length>100&&(0,r.jsx)(n.tU,{value:R,onValueChange:e=>I(e),children:(0,r.jsxs)(n.j7,{className:"bg-gray-800",children:[(0,r.jsxs)(n.Xi,{value:"table",children:[(0,r.jsx)(et.A,{className:"h-4 w-4 mr-2"}),"Paginated"]}),(0,r.jsxs)(n.Xi,{value:"virtual",children:[(0,r.jsx)(es.A,{className:"h-4 w-4 mr-2"}),"Virtual Scroll",D.length>1e3&&(0,r.jsx)(o.E,{variant:"secondary",className:"ml-2 text-xs",children:"Recommended"})]}),(0,r.jsxs)(n.Xi,{value:"summary",children:[(0,r.jsx)(V.A,{className:"h-4 w-4 mr-2"}),"Summary"]})]})}),"table"===R&&(0,r.jsxs)(N.F,{className:"w-full",children:[(0,r.jsxs)(Y.XI,{children:[(0,r.jsx)(Y.A0,{children:(0,r.jsx)(Y.Hj,{className:"border-gray-700",children:null==(t=u.headers)?void 0:t.map((e,t)=>(0,r.jsx)(Y.nd,{className:"text-gray-300 cursor-pointer hover:text-white",onClick:()=>U(e),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("span",{children:e}),k!==e?(0,r.jsx)(Z.A,{className:"h-3 w-3 opacity-50"}):"asc"===T?(0,r.jsx)($.A,{className:"h-3 w-3"}):(0,r.jsx)(X.A,{className:"h-3 w-3"})]})},t))})}),(0,r.jsx)(Y.BF,{children:F.map((e,t)=>(0,r.jsx)(Y.Hj,{className:"border-gray-700",children:e.map((e,t)=>(0,r.jsx)(Y.nA,{className:"text-gray-300",children:null==e?(0,r.jsx)("span",{className:"text-gray-500 italic",children:"null"}):"boolean"==typeof e?(0,r.jsx)(o.E,{variant:"outline",className:e?"border-green-500 text-green-400":"border-red-500 text-red-400",children:String(e)}):String(e)},t))},t))})]}),(0,r.jsx)(N.$,{orientation:"horizontal"})]}),"virtual"===R&&(0,r.jsx)(ei,{data:P,columns:B,rowHeight:48,containerHeight:600,striped:!0,highlightOnHover:!0}),"summary"===R&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,r.jsx)(i.Zp,{className:"glass border-white/10",children:(0,r.jsxs)(i.Wu,{className:"p-4",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-white",children:D.length}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:"Total Rows"})]})}),(0,r.jsx)(i.Zp,{className:"glass border-white/10",children:(0,r.jsxs)(i.Wu,{className:"p-4",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-white",children:(null==(s=u.headers)?void 0:s.length)||0}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:"Columns"})]})}),u.execution&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Zp,{className:"glass border-green-500/50",children:(0,r.jsxs)(i.Wu,{className:"p-4",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-green-400",children:[u.execution.totalTimeMs,"ms"]}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:"Query Time"})]})}),void 0!==u.execution.rowsExamined&&(0,r.jsx)(i.Zp,{className:"glass border-blue-500/50",children:(0,r.jsxs)(i.Wu,{className:"p-4",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:u.execution.rowsExamined}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:"Rows Examined"})]})})]})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Data Preview (First 10 rows)"}),(0,r.jsx)("div",{className:"bg-gray-800 rounded-lg p-4 overflow-auto max-h-64",children:(0,r.jsx)("pre",{className:"text-xs text-gray-300 font-mono",children:JSON.stringify(P.slice(0,10),null,2)})})]})]}),"table"===R&&q>1&&(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-400",children:["Showing ",(v-1)*y+1," to"," ",Math.min(v*y,D.length)," of"," ",D.length," results"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(l.$,{size:"sm",variant:"ghost",onClick:()=>w(e=>Math.max(1,e-1)),disabled:1===v,children:(0,r.jsx)(er.A,{className:"h-4 w-4"})}),(0,r.jsxs)(O.Select,{value:String(v),onValueChange:e=>w(Number(e)),children:[(0,r.jsx)(O.SelectTrigger,{className:"w-20 h-8 bg-gray-800 border-gray-600",children:(0,r.jsx)(O.SelectValue,{})}),(0,r.jsx)(O.SelectContent,{children:Array.from({length:q},(e,t)=>t+1).map(e=>(0,r.jsx)(O.SelectItem,{value:String(e),children:e},e))})]}),(0,r.jsxs)("span",{className:"text-sm text-gray-400",children:["of ",q]}),(0,r.jsx)(l.$,{size:"sm",variant:"ghost",onClick:()=>w(e=>Math.min(q,e+1)),disabled:v===q,children:(0,r.jsx)(C.A,{className:"h-4 w-4"})})]})]})]})]}):(0,r.jsxs)(i.Zp,{className:"glass border-white/10 ".concat(f),children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)(i.ZB,{className:"flex items-center text-white",children:[(0,r.jsx)(_.A,{className:"mr-2 h-5 w-5"}),"Query Results"]})}),(0,r.jsx)(i.Wu,{children:(0,r.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,r.jsx)(_.A,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,r.jsx)("p",{children:"No results found"}),u&&u.execution&&(0,r.jsxs)("p",{className:"text-sm mt-2",children:["Query executed in ",u.execution.totalTimeMs,"ms"]})]})})]})}let el=[{pattern:/show\s+(?:me\s+)?all\s+(.+)/i,type:"list"},{pattern:/get\s+(.+)\s+from\s+(.+)/i,type:"query"},{pattern:/find\s+(.+)\s+where\s+(.+)/i,type:"filter"},{pattern:/count\s+(.+)/i,type:"aggregate"},{pattern:/how\s+many\s+(.+)/i,type:"count"},{pattern:/top\s+(\d+)\s+(.+)/i,type:"limit"},{pattern:/(.+)\s+with\s+(.+)\s+(?:greater|more|higher)\s+than\s+(.+)/i,type:"comparison"},{pattern:/(.+)\s+(?:contains|containing)\s+(.+)/i,type:"contains"}],eo={"Computer Name":["computer","machine","endpoint","device","name","hostname"],"Operating System":["os","operating system","windows","linux","mac","platform"],"IP Address":["ip","address","network","ip address"],"CPU Percent":["cpu","processor","cpu usage","processor usage","cpu percent"],"Memory GB":["memory","ram","mem","memory usage"],"Disk Free GB":["disk","storage","disk space","free space","available space"],"Last Logged In User":["user","logged in","last user","username"],"Last Reboot":["reboot","restart","boot time","uptime"],"Compliance Score":["compliance","score","compliance score","security score"],"Is Virtual":["virtual","vm","virtual machine","virtualized"]},ec={contains:["contains","containing","includes","including","with"],equals:["equals","is","equal to","exactly"],greater_than:["greater than","more than","higher than","above",">"],less_than:["less than","lower than","below","under","<"],starts_with:["starts with","beginning with","starting"],ends_with:["ends with","ending with","ending"]},ed=[{sensor:{name:"Computer Name",key:"computer_name",type:"text",category:"System"},category:"System",description:"The name of the computer or endpoint",examples:["PC-001","SERVER-WEB-01"],runtime:"fast",runtimeMs:10,popularity:.95,columns:["Computer Name"]},{sensor:{name:"Operating System",key:"os_platform",type:"text",category:"System"},category:"System",description:"The operating system platform",examples:["Windows 10","Windows Server 2019","macOS","Linux"],runtime:"fast",runtimeMs:15,popularity:.9,columns:["Operating System"]},{sensor:{name:"IP Address",key:"ip_address",type:"text",category:"Network"},category:"Network",description:"The IP address of the endpoint",examples:["192.168.1.100","10.0.0.50"],runtime:"fast",runtimeMs:20,popularity:.85,columns:["IP Address"]},{sensor:{name:"CPU Percent",key:"cpu_percent",type:"number",category:"Performance"},category:"Performance",description:"Current CPU usage percentage",examples:["25.5","80.3"],runtime:"medium",runtimeMs:100,popularity:.75,columns:["CPU Percent"]},{sensor:{name:"Memory GB",key:"memory_gb",type:"number",category:"Performance"},category:"Performance",description:"Total memory in gigabytes",examples:["16","32","8"],runtime:"fast",runtimeMs:25,popularity:.7,columns:["Memory GB"]},{sensor:{name:"Disk Free GB",key:"disk_free_gb",type:"number",category:"Storage"},category:"Storage",description:"Available disk space in gigabytes",examples:["250.5","45.2"],runtime:"medium",runtimeMs:150,popularity:.8,columns:["Disk Free GB"]},{sensor:{name:"Last Logged In User",key:"last_logged_in_user",type:"text",category:"Security"},category:"Security",description:"The username of the last logged in user",examples:["john.doe","admin"],runtime:"fast",runtimeMs:30,popularity:.65,columns:["Last Logged In User"]},{sensor:{name:"Last Reboot",key:"last_reboot",type:"date",category:"System"},category:"System",description:"Date and time of last system reboot",examples:["2024-01-15 10:30:00"],runtime:"fast",runtimeMs:35,popularity:.6,columns:["Last Reboot"]},{sensor:{name:"Compliance Score",key:"compliance_score",type:"number",category:"Security"},category:"Security",description:"Security compliance score (0-1)",examples:["0.85","0.92"],runtime:"slow",runtimeMs:500,popularity:.55,columns:["Compliance Score"]},{sensor:{name:"Is Virtual",key:"is_virtual",type:"boolean",category:"System"},category:"System",description:"Whether the machine is a virtual machine",examples:["true","false"],runtime:"fast",runtimeMs:15,popularity:.5,columns:["Is Virtual"]},{sensor:{name:"Installed Applications",key:"installed_apps",type:"text",category:"Software"},category:"Software",description:"List of installed applications",examples:["Microsoft Office","Google Chrome"],runtime:"slow",runtimeMs:800,popularity:.7,columns:["Name","Version","Publisher"],parameters:[{name:"filter",type:"text",required:!1,description:"Filter applications by name",default:""}]},{sensor:{name:"Running Processes",key:"processes",type:"text",category:"Performance"},category:"Performance",description:"List of currently running processes",runtime:"medium",runtimeMs:200,popularity:.45,columns:["Process Name","PID","CPU %","Memory MB"],parameters:[{name:"top",type:"number",required:!1,description:"Limit to top N processes by CPU",default:10}]},{sensor:{name:"Network Connections",key:"network_connections",type:"text",category:"Network"},category:"Network",description:"Active network connections",runtime:"medium",runtimeMs:250,popularity:.4,columns:["Protocol","Local Address","Remote Address","State"]},{sensor:{name:"Windows Updates",key:"windows_updates",type:"text",category:"Software"},category:"Software",description:"Windows update status and history",runtime:"slow",runtimeMs:600,popularity:.65,columns:["Update Name","Status","Date"],parameters:[{name:"days",type:"number",required:!1,description:"Updates from last N days",default:30}]},{sensor:{name:"Service Status",key:"service_status",type:"text",category:"System"},category:"System",description:"Status of Windows services",runtime:"medium",runtimeMs:180,popularity:.35,columns:["Service Name","Display Name","Status","Startup Type"],parameters:[{name:"service",type:"text",required:!0,description:"Service name to check"}]},{sensor:{name:"Registry Value",key:"registry_value",type:"text",category:"System"},category:"System",description:"Read Windows registry values",runtime:"fast",runtimeMs:50,popularity:.3,columns:["Key","Value Name","Value"],parameters:[{name:"key",type:"text",required:!0,description:"Registry key path"},{name:"value",type:"text",required:!1,description:"Value name (optional)"}]},{sensor:{name:"File Hash",key:"file_hash",type:"text",category:"Security"},category:"Security",description:"Calculate file hash (MD5, SHA1, SHA256)",runtime:"medium",runtimeMs:300,popularity:.25,columns:["File Path","MD5","SHA1","SHA256"],parameters:[{name:"path",type:"text",required:!0,description:"File path"},{name:"algorithm",type:"select",required:!1,description:"Hash algorithm",default:"SHA256",options:[{value:"MD5",label:"MD5"},{value:"SHA1",label:"SHA1"},{value:"SHA256",label:"SHA256"}]}]}];var eu=function(e){return e.GET="GET",e.FROM="FROM",e.WHERE="WHERE",e.WITH="WITH",e.GROUP_BY="GROUP_BY",e.ORDER_BY="ORDER_BY",e.LIMIT="LIMIT",e.AND="AND",e.CONTAINS="CONTAINS",e.DOES_NOT_CONTAIN="DOES_NOT_CONTAIN",e.EQUALS="EQUALS",e.IS_GREATER_THAN="IS_GREATER_THAN",e.IS_LESS_THAN="IS_LESS_THAN",e.STARTS_WITH="STARTS_WITH",e.ENDS_WITH="ENDS_WITH",e.COUNT="COUNT",e.MIN="MIN",e.MAX="MAX",e.AVG="AVG",e.SUM="SUM",e.IDENTIFIER="IDENTIFIER",e.STRING="STRING",e.NUMBER="NUMBER",e.COMMA="COMMA",e.LPAREN="LPAREN",e.RPAREN="RPAREN",e.DOT="DOT",e.EOF="EOF",e.UNKNOWN="UNKNOWN",e}({});class em extends Error{constructor(e,t,s,r,a="error"){super(e),this.position=t,this.line=s,this.column=r,this.severity=a,this.name="QueryError"}}class eh extends em{constructor(e,t){super(e,null==t?void 0:t.position,null==t?void 0:t.line,null==t?void 0:t.column),this.name="ParseError"}}class ep extends em{constructor(e,t){super(e),this.code=t,this.name="ExecutionError"}}class eg{tokenize(){for(this.tokens=[],this.position=0,this.line=1,this.column=1;!this.isEOF()&&(this.skipWhitespace(),!this.isEOF());){let e=this.nextToken();e.type!==eu.UNKNOWN&&this.tokens.push(e)}return this.tokens.push(this.createToken(eu.EOF,"")),this.tokens}nextToken(){let e=this.position,t=this.line,s=this.column;for(let{pattern:r,type:a}of eg.OPERATOR_PATTERNS){let i=this.input.slice(this.position).match(r);if(i&&0===i.index){let r=i[0];return this.advance(r.length),this.createTokenAt(a,r,e,t,s)}}let r=this.peek();if('"'===r||"'"===r)return this.readString();if(this.isDigit(r))return this.readNumber();if(this.isAlpha(r))return this.readIdentifier();switch(r){case",":return this.advance(),this.createTokenAt(eu.COMMA,",",e,t,s);case"(":return this.advance(),this.createTokenAt(eu.LPAREN,"(",e,t,s);case")":return this.advance(),this.createTokenAt(eu.RPAREN,")",e,t,s);case".":return this.advance(),this.createTokenAt(eu.DOT,".",e,t,s);default:return this.advance(),this.createTokenAt(eu.UNKNOWN,r,e,t,s)}}readString(){let e=this.position,t=this.line,s=this.column,r=this.peek();this.advance();let a="",i=!1;for(;!this.isEOF()&&(i||this.peek()!==r);){let e=this.peek();if(i){switch(e){case"n":a+="\n";break;case"t":a+="	";break;case"r":a+="\r";break;case"\\":a+="\\";break;case'"':a+='"';break;case"'":a+="'";break;default:a+=e}i=!1}else"\\"===e?i=!0:a+=e;this.advance()}if(this.isEOF())throw new em("Unterminated string literal",e,t,s);return this.advance(),this.createTokenAt(eu.STRING,a,e,t,s)}readNumber(){let e=this.position,t=this.line,s=this.column,r="";for(;!this.isEOF()&&this.isDigit(this.peek());)r+=this.peek(),this.advance();if(!this.isEOF()&&"."===this.peek()&&this.isDigit(this.peek(1)))for(r+=this.peek(),this.advance();!this.isEOF()&&this.isDigit(this.peek());)r+=this.peek(),this.advance();return this.createTokenAt(eu.NUMBER,r,e,t,s)}readIdentifier(){let e=this.position,t=this.line,s=this.column,r="";for(;!this.isEOF()&&(this.isAlphaNumeric(this.peek())||"_"===this.peek()||" "===this.peek());){let e=this.peek();if(" "===e){let t=this.peek(1);if(!t||!this.isAlpha(t))break;let s=this.input.slice(this.position).match(/^[A-Za-z\s]+/);if(s&&this.isKnownField(s[0].trim()))r+=e,this.advance();else break}else r+=e,this.advance()}let a=(r=r.trim()).toLowerCase(),i=eg.KEYWORDS.get(a);return i?([eu.COUNT,eu.MIN,eu.MAX,eu.AVG,eu.SUM].includes(i)&&(this.skipWhitespace(),this.peek()),this.createTokenAt(i,r,e,t,s)):this.createTokenAt(eu.IDENTIFIER,r,e,t,s)}isKnownField(e){return["computer name","computer role","operating system","os platform","os version","disk free gb","memory gb","cpu percent","compliance score","group name","group","location","last reboot","last seen","service status","ip address","mac address","serial number","manufacturer","model"].includes(e.toLowerCase())}skipWhitespace(){for(;!this.isEOF()&&this.isWhitespace(this.peek());)"\n"===this.peek()?(this.line++,this.column=1):this.column++,this.position++}isWhitespace(e){return/\s/.test(e)}isDigit(e){return/\d/.test(e)}isAlpha(e){return/[a-zA-Z]/.test(e)}isAlphaNumeric(e){return/[a-zA-Z0-9]/.test(e)}peek(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.position+e;return t>=this.input.length?"\0":this.input[t]}advance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;for(let t=0;t<e;t++)this.position<this.input.length&&("\n"===this.input[this.position]?(this.line++,this.column=1):this.column++,this.position++)}isEOF(){return this.position>=this.input.length}createToken(e,t){return{type:e,value:t,position:this.position,line:this.line,column:this.column}}createTokenAt(e,t,s,r,a){return{type:e,value:t,position:s,line:r,column:a}}getTokens(){return this.tokens}formatTokens(){return this.tokens.map(e=>"".concat(e.type,"(").concat(e.value,") @ ").concat(e.line,":").concat(e.column)).join("\n")}constructor(e){this.position=0,this.line=1,this.column=1,this.tokens=[],this.input=e}}eg.KEYWORDS=new Map([["get",eu.GET],["from",eu.FROM],["where",eu.WHERE],["with",eu.WITH],["group",eu.GROUP_BY],["by",eu.GROUP_BY],["order",eu.ORDER_BY],["limit",eu.LIMIT],["and",eu.AND],["contains",eu.CONTAINS],["does",eu.DOES_NOT_CONTAIN],["not",eu.DOES_NOT_CONTAIN],["contain",eu.DOES_NOT_CONTAIN],["equals",eu.EQUALS],["is",eu.IS_GREATER_THAN],["greater",eu.IS_GREATER_THAN],["less",eu.IS_LESS_THAN],["than",eu.IS_GREATER_THAN],["starts",eu.STARTS_WITH],["ends",eu.ENDS_WITH],["count",eu.COUNT],["min",eu.MIN],["max",eu.MAX],["avg",eu.AVG],["sum",eu.SUM]]),eg.OPERATOR_PATTERNS=[{pattern:/^does\s+not\s+contain/i,type:eu.DOES_NOT_CONTAIN},{pattern:/^is\s+greater\s+than/i,type:eu.IS_GREATER_THAN},{pattern:/^is\s+less\s+than/i,type:eu.IS_LESS_THAN},{pattern:/^starts\s+with/i,type:eu.STARTS_WITH},{pattern:/^ends\s+with/i,type:eu.ENDS_WITH},{pattern:/^group\s+by/i,type:eu.GROUP_BY},{pattern:/^order\s+by/i,type:eu.ORDER_BY}];class ex{parse(e){let t=new eg(e);this.tokens=t.tokenize(),this.current=0;let s=this.parseQuery();return this.options.validateSemantics&&this.validateQuery(s),s}parseQuery(){var e,t;let s,r,a,i,n=this.peek();if(!this.match(eu.GET))throw new eh('Query must start with "Get"',this.peek());let l=this.parseSelect();if(!this.match(eu.FROM))throw new eh('Expected "from" after column list',this.peek());let o=this.parseFrom();return(this.match(eu.WHERE)||this.match(eu.WITH))&&(s=this.parseWhere()),(this.matchSequence([eu.GROUP_BY])||this.check(eu.IDENTIFIER)&&(null==(e=this.peekValue())?void 0:e.toLowerCase())==="group")&&(r=this.parseGroupBy()),(this.matchSequence([eu.ORDER_BY])||this.check(eu.IDENTIFIER)&&(null==(t=this.peekValue())?void 0:t.toLowerCase())==="order")&&(a=this.parseOrderBy()),this.match(eu.LIMIT)&&(i=this.parseLimit()),{type:"Query",select:l,from:o,where:s,groupBy:r,orderBy:a,limit:i,location:this.createLocation(n,this.previous())}}parseSelect(){var e;let t=this.peek(),s=[],r=[];do if(this.checkAggregate())r.push(this.parseAggregate());else{let e=this.parseColumn();e&&s.push(e)}while(this.match(eu.COMMA)||this.check(eu.IDENTIFIER)&&(null==(e=this.peekValue())?void 0:e.toLowerCase())==="and"&&!this.checkAhead(eu.FROM));if(0===s.length&&0===r.length)throw new eh("Expected at least one column or aggregate",this.peek());return{type:"Select",columns:s,aggregates:r,location:this.createLocation(t,this.previous())}}parseColumn(){let e=this.peek(),t="";for(;this.check(eu.IDENTIFIER)&&(t&&(t+=" "),t+=this.advance().value,this.checkColumnContinuation()););return t?{type:"Column",name:t,location:this.createLocation(e,this.previous())}:null}parseAggregate(){let e,t,s=this.peek(),r=this.advance();switch(r.type){case eu.COUNT:e="count";break;case eu.MIN:e="min";break;case eu.MAX:e="max";break;case eu.AVG:e="avg";break;case eu.SUM:e="sum";break;default:throw new eh("Unknown aggregate function: ".concat(r.value),r)}if(this.match(eu.LPAREN)){if(!this.check(eu.RPAREN)){let e=this.parseColumn();e&&(t=e.name)}this.consume(eu.RPAREN,"Expected closing parenthesis")}return{type:"Aggregate",function:e,column:t,location:this.createLocation(s,this.previous())}}parseFrom(){let e=this.peek();return{type:"From",scope:this.parseScope(),location:this.createLocation(e,this.previous())}}parseScope(){let e=this.peek();if(this.check(eu.IDENTIFIER)){var t,s;let r=null==(t=this.peekValue())?void 0:t.toLowerCase();if("all"===r)return this.advance(),this.check(eu.IDENTIFIER)&&(null==(s=this.peekValue())?void 0:s.toLowerCase())==="machines"&&this.advance(),{type:"Scope",scopeType:"all",location:this.createLocation(e,this.previous())};if("group"===r){this.advance();let t="";if(this.check(eu.STRING))t=this.advance().value;else for(;this.check(eu.IDENTIFIER)&&(t&&(t+=" "),t+=this.advance().value,this.checkGroupNameContinuation()););return{type:"Scope",scopeType:"group",value:t,location:this.createLocation(e,this.previous())}}}return{type:"Scope",scopeType:"all",location:this.createLocation(e,e)}}parseWhere(){let e=this.previous(),t=[];do t.push(this.parseFilter());while(this.match(eu.AND));return{type:"Where",filters:t,location:this.createLocation(e,this.previous())}}parseFilter(){let e,t=this.peek(),s=this.parseColumn();if(!s)throw new eh("Expected field name in filter",this.peek());let r=this.parseOperator();if(this.check(eu.STRING))e=this.advance().value;else if(this.check(eu.NUMBER))e=parseFloat(this.advance().value);else{let t="";for(;this.check(eu.IDENTIFIER)&&(t&&(t+=" "),t+=this.advance().value,this.checkFilterValueContinuation()););e=t}return{type:"Filter",field:s.name,operator:r,value:e,location:this.createLocation(t,this.previous())}}parseOperator(){if(this.match(eu.CONTAINS))return"contains";if(this.match(eu.DOES_NOT_CONTAIN))return"does_not_contain";if(this.match(eu.EQUALS))return"equals";if(this.match(eu.IS_GREATER_THAN))return"greater_than";if(this.match(eu.IS_LESS_THAN))return"less_than";if(this.match(eu.STARTS_WITH))return"starts_with";if(this.match(eu.ENDS_WITH))return"ends_with";throw new eh("Expected comparison operator",this.peek())}parseGroupBy(){var e,t;let s=this.peek();this.check(eu.IDENTIFIER)&&(null==(e=this.peekValue())?void 0:e.toLowerCase())==="group"?(this.advance(),this.check(eu.IDENTIFIER)&&(null==(t=this.peekValue())?void 0:t.toLowerCase())==="by"&&this.advance()):this.check(eu.GROUP_BY)&&this.advance();let r=[];do{let e=this.parseColumn();e&&r.push(e.name)}while(this.match(eu.COMMA));return{type:"GroupBy",columns:r,location:this.createLocation(s,this.previous())}}parseOrderBy(){var e,t,s;let r=this.peek();this.check(eu.IDENTIFIER)&&(null==(e=this.peekValue())?void 0:e.toLowerCase())==="order"?(this.advance(),this.check(eu.IDENTIFIER)&&(null==(t=this.peekValue())?void 0:t.toLowerCase())==="by"&&this.advance()):this.check(eu.ORDER_BY)&&this.advance();let a=[];do{let e=this.parseColumn();if(e){let t="asc";if(this.check(eu.IDENTIFIER)){let e=null==(s=this.peekValue())?void 0:s.toLowerCase();("asc"===e||"desc"===e)&&(t=e,this.advance())}a.push({column:e.name,direction:t})}}while(this.match(eu.COMMA));return{type:"OrderBy",columns:a,location:this.createLocation(r,this.previous())}}parseLimit(){let e=this.previous();if(!this.check(eu.NUMBER))throw new eh("Expected number after LIMIT",this.peek());return{type:"Limit",value:parseInt(this.advance().value),location:this.createLocation(e,this.previous())}}validateQuery(e){if(e.groupBy){for(let t of e.groupBy.columns)if(!e.select.columns.some(e=>e.name===t)&&0===e.select.aggregates.length)throw new eh('GROUP BY column "'.concat(t,'" must appear in SELECT clause'))}if(e.orderBy)for(let s of e.orderBy.columns){var t;let r=e.select.columns.some(e=>e.name===s.column),a=null==(t=e.groupBy)?void 0:t.columns.includes(s.column);if(!r&&!a)throw new eh('ORDER BY column "'.concat(s.column,'" must appear in SELECT or GROUP BY clause'))}}check(e){return!this.isAtEnd()&&this.peek().type===e}checkAggregate(){return[eu.COUNT,eu.MIN,eu.MAX,eu.AVG,eu.SUM].includes(this.peek().type)}checkAhead(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=this.current+t;return!(s>=this.tokens.length)&&this.tokens[s].type===e}match(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];for(let e of t)if(this.check(e))return this.advance(),!0;return!1}matchSequence(e){for(let t=0;t<e.length;t++)if(!this.checkAhead(e[t],t))return!1;for(let t=0;t<e.length;t++)this.advance();return!0}consume(e,t){if(this.check(e))return this.advance();throw new eh(t,this.peek())}advance(){return!this.isAtEnd()&&this.current++,this.previous()}isAtEnd(){return this.peek().type===eu.EOF}peek(){return this.tokens[this.current]}peekValue(){var e;return null==(e=this.tokens[this.current])?void 0:e.value}previous(){return this.tokens[this.current-1]}checkColumnContinuation(){return![eu.FROM,eu.WHERE,eu.WITH,eu.GROUP_BY,eu.ORDER_BY,eu.LIMIT,eu.AND,eu.COMMA].includes(this.peek().type)}checkGroupNameContinuation(){return![eu.WHERE,eu.WITH,eu.GROUP_BY,eu.ORDER_BY,eu.LIMIT].includes(this.peek().type)}checkFilterValueContinuation(){return![eu.AND,eu.GROUP_BY,eu.ORDER_BY,eu.LIMIT,eu.EOF].includes(this.peek().type)}createLocation(e,t){return{start:e.position,end:t.position+t.value.length,line:e.line,column:e.column}}constructor(e={}){this.tokens=[],this.current=0,this.options={strictMode:!1,allowPartialQueries:!1,maxDepth:100,validateSemantics:!0,...e}}}let ey=new Map([["computer name",{key:"computer_name",type:"text",dbColumn:"computer_name",description:"Endpoint hostname",category:"Core"}],["hostname",{key:"computer_name",type:"text",dbColumn:"computer_name",description:"Endpoint hostname (alias)",category:"Core"}],["computer role",{key:"role",type:"text",dbColumn:"role",description:"Computer role (Workstation, Server, etc.)",category:"Core"}],["role",{key:"role",type:"text",dbColumn:"role",description:"Computer role (alias)",category:"Core"}],["operating system",{key:"os_platform",type:"text",dbColumn:"os_platform",description:"Operating system platform",category:"Core"}],["os platform",{key:"os_platform",type:"text",dbColumn:"os_platform",description:"OS platform (Windows, macOS, Linux)",category:"Core"}],["os version",{key:"os_version",type:"text",dbColumn:"os_version",description:"Operating system version",category:"Core"}],["disk free gb",{key:"disk_free_gb",type:"number",dbColumn:"disk_free_gb",description:"Available disk space in GB",category:"Performance"}],["disk space",{key:"disk_free_gb",type:"number",dbColumn:"disk_free_gb",description:"Available disk space (alias)",category:"Performance"}],["memory gb",{key:"memory_gb",type:"number",dbColumn:"memory_gb",description:"Physical memory in GB",category:"Performance"}],["ram",{key:"memory_gb",type:"number",dbColumn:"memory_gb",description:"RAM in GB (alias)",category:"Performance"}],["cpu percent",{key:"cpu_percent",type:"number",dbColumn:"cpu_percent",description:"CPU utilization percentage",category:"Performance"}],["cpu usage",{key:"cpu_percent",type:"number",dbColumn:"cpu_percent",description:"CPU usage percentage (alias)",category:"Performance"}],["compliance score",{key:"compliance_score",type:"number",dbColumn:"compliance_score",description:"Compliance score (0-1)",category:"Governance"}],["compliance",{key:"compliance_score",type:"number",dbColumn:"compliance_score",description:"Compliance score (alias)",category:"Governance"}],["group",{key:"group_name",type:"text",dbColumn:"group_name",description:"Computer group membership",category:"Metadata"}],["group name",{key:"group_name",type:"text",dbColumn:"group_name",description:"Computer group name",category:"Metadata"}],["location",{key:"location",type:"text",dbColumn:"location",description:"Geographic or network location",category:"Metadata"}],["last reboot",{key:"last_reboot",type:"date",dbColumn:"last_reboot",description:"Last system reboot timestamp",category:"Core"}],["last seen",{key:"last_seen",type:"date",dbColumn:"last_seen",description:"Last time endpoint was seen",category:"Core"}],["ip address",{key:"ip_address",type:"text",dbColumn:"ip_address",description:"Primary IP address",category:"Network"}],["mac address",{key:"mac_address",type:"text",dbColumn:"mac_address",description:"Primary MAC address",category:"Network"}],["serial number",{key:"serial_number",type:"text",dbColumn:"serial_number",description:"Hardware serial number",category:"Asset"}],["manufacturer",{key:"manufacturer",type:"text",dbColumn:"manufacturer",description:"Hardware manufacturer",category:"Asset"}],["model",{key:"model",type:"text",dbColumn:"model",description:"Hardware model",category:"Asset"}]]),ef=new Map([["laptops","Laptops"],["servers","Data Center Servers"],["data center servers","Data Center Servers"],["finance","Finance Workstations"],["finance workstations","Finance Workstations"],["canary","Canary Cohort"],["canary cohort","Canary Cohort"],["engineering","Engineering Lab"],["engineering lab","Engineering Lab"],["operations","Operations"],["ops","Operations"],["production","Production Servers"],["prod","Production Servers"],["development","Development Workstations"],["dev","Development Workstations"],["staging","Staging Servers"],["test","Test Environment"]]),ev=[{name:"Computer Name",key:"computer_name",category:"Core",type:"text",description:"Returns the endpoint hostname"},{name:"Operating System",key:"os_platform",category:"Core",type:"text",description:"Human-readable OS platform string"},{name:"OS Platform",key:"os_platform",category:"Core",type:"text",description:"Normalized OS platform (Windows, macOS, Linux)"},{name:"OS Version",key:"os_version",category:"Core",type:"text",description:"Version information for the current OS"},{name:"CPU Percent",key:"cpu_percent",category:"Performance",type:"number",description:"Current CPU utilization percentage"},{name:"Memory GB",key:"memory_gb",category:"Performance",type:"number",description:"Physical memory in gigabytes"},{name:"Disk Free GB",key:"disk_free_gb",category:"Performance",type:"number",description:"Available disk capacity in gigabytes"},{name:"Compliance Score",key:"compliance_score",category:"Governance",type:"number",description:"Composite score for patching and configuration compliance"},{name:"Service Status",key:"service_status",category:"Core",type:"text",description:"Status of a given service on the endpoint",parameters:{serviceName:"string"}},{name:"Last Reboot",key:"last_reboot",category:"Core",type:"date",description:"Timestamp of the last reboot"},{name:"Group",key:"group_name",category:"Metadata",type:"text",description:"Logical group membership for the endpoint"},{name:"Location",key:"location",category:"Metadata",type:"text",description:"Geographic or network zone indicator"}],eb=["count()","min()","max()","avg()","sum()"];function eN(e){return ey.get(e.toLowerCase().trim())}function ew(e){let t=eN(e);return null==t?void 0:t.dbColumn}class ej{initMetrics(){return{parseTimeMs:0,planTimeMs:0,executeTimeMs:0,totalTimeMs:0,scoped:0,filtered:0,rowsExamined:0,cacheHit:!1}}async execute(e){let t=performance.now();this.warnings=[],this.metrics=this.initMetrics();try{let s=performance.now(),r=this.generateQueryPlan(e);if(this.metrics.planTimeMs=performance.now()-s,this.options.explainOnly)return this.createExplainResult(r);let a=performance.now(),i=await this.executePlan(e,r);return this.metrics.executeTimeMs=performance.now()-a,this.metrics.totalTimeMs=performance.now()-t,i.execution={...this.metrics},i.warnings=this.warnings,i}catch(e){if(e instanceof ep)throw e;throw new ep("Query execution failed: ".concat(e))}}generateQueryPlan(e){var t,s,r,a,i;let n={type:"scan",cost:this.data.length,rows:this.data.length,width:100,children:[]};if("group"===e.from.scope.scopeType&&e.from.scope.value&&(null==(t=n.children)||t.push({type:"filter",cost:.1*n.rows,rows:Math.floor(.3*n.rows),width:n.width,details:{scope:e.from.scope.value}})),e.where&&e.where.filters.length>0){let t=.5**e.where.filters.length;null==(s=n.children)||s.push({type:"filter",cost:.2*n.rows,rows:Math.floor(n.rows*t),width:n.width,details:{filters:e.where.filters.length}})}if(e.groupBy&&e.groupBy.columns.length>0&&(null==(r=n.children)||r.push({type:"aggregate",cost:.5*n.rows,rows:Math.floor(.1*n.rows),width:50,details:{groupBy:e.groupBy.columns}})),e.orderBy&&e.orderBy.columns.length>0){let t=n.rows*Math.log2(n.rows);null==(a=n.children)||a.push({type:"sort",cost:t,rows:n.rows,width:n.width,details:{orderBy:e.orderBy.columns}})}return e.limit&&(null==(i=n.children)||i.push({type:"limit",cost:1,rows:Math.min(e.limit.value,n.rows),width:n.width,details:{limit:e.limit.value}})),n}async executePlan(e,t){let s=[...this.data];this.metrics.rowsExamined=s.length,s=this.applyScope(s,e),this.metrics.scoped=s.length,e.where?(s=this.applyFilters(s,e.where.filters),this.metrics.filtered=s.length):this.metrics.filtered=this.metrics.scoped;let r=[],a=[];if(e.groupBy||e.select.aggregates.length>0){let t=this.executeAggregates(s,e);r=t.headers,a=t.rows}else{let t=this.executeSelect(s,e);r=t.headers,a=t.rows}e.orderBy&&(a=this.applyOrderBy(a,r,e.orderBy)),e.limit&&(a=a.slice(0,e.limit.value));let i={ok:!0,headers:r,rows:a,rowCount:a.length,metadata:this.buildMetadata(e)};return"csv"===this.options.format&&(i.csv=this.formatAsCSV(r,a)),i}applyScope(e,t){let s=t.from.scope;if("all"===s.scopeType)return e;if("group"===s.scopeType&&s.value){var r;let t=(r=s.value,ef.get(r.toLowerCase().trim())||r);return e.filter(e=>e.group_name===t)}return e}applyFilters(e,t){let s=e;for(let e of t){let t=ew(e.field);if(!t){this.warnings.push({message:"Unknown field: ".concat(e.field),severity:"warning"});continue}!function(e,t){let s=function(e){let t=eN(e);return null==t?void 0:t.type}(e);return!!s&&!!(["equals","not_equals"].includes(t)||"number"===s&&["greater_than","less_than","greater_or_equal","less_or_equal"].includes(t)||"text"===s&&["contains","does_not_contain","starts_with","ends_with"].includes(t))}(e.field,e.operator)&&this.warnings.push({message:"Operator '".concat(e.operator,"' may not be compatible with field '").concat(e.field,"'"),severity:"warning"}),s=s.filter(s=>this.evaluateFilter(s,e,t))}return s}evaluateFilter(e,t,s){let r=e[s];if(null==r)return!1;let a=String(r).toLowerCase(),i=String(t.value).toLowerCase();switch(t.operator){case"contains":return a.includes(i);case"does_not_contain":return!a.includes(i);case"equals":return a===i;case"not_equals":return a!==i;case"starts_with":return a.startsWith(i);case"ends_with":return a.endsWith(i);case"greater_than":return Number(r)>Number(t.value);case"less_than":return Number(r)<Number(t.value);case"greater_or_equal":return Number(r)>=Number(t.value);case"less_or_equal":return Number(r)<=Number(t.value);default:return!1}}executeSelect(e,t){let s=t.select.columns,r=s.length>0?s.map(e=>e.name):["Computer Name"],a=e.map(e=>r.map(t=>{let s=ew(t);if(!s)return null;let r=e[s];return this.formatValue(r)}));return{headers:r,rows:a}}executeAggregates(e,t){var s;let r=[],a=t.select.aggregates,i=null==(s=t.groupBy)?void 0:s.columns[0];if(i&&r.push(i),a.length>0?a.forEach(e=>{r.push("".concat(e.function,"(").concat(e.column||"",")"))}):r.push("count()"),i){let t=this.groupData(e,i),s=[];for(let[e,r]of t.entries()){let t=[e];a.length>0?a.forEach(e=>{t.push(this.calculateAggregate(r,e))}):t.push(r.length),s.push(t)}return{headers:r,rows:s}}{let t=[];return a.length>0?a.forEach(s=>{t.push(this.calculateAggregate(e,s))}):t.push(e.length),{headers:r,rows:[t]}}}groupData(e,t){let s=new Map,r=ew(t);if(!r)return this.warnings.push({message:"Unknown group by column: ".concat(t),severity:"error"}),s;for(let t of e){let e=String(t[r]||"null");s.has(e)||s.set(e,[]),s.get(e).push(t)}return s}calculateAggregate(e,t){if("count"===t.function){if(!t.column)return e.length;let s=ew(t.column);return s?e.filter(e=>null!=e[s]).length:0}if(!t.column)return null;let s=ew(t.column);if(!s)return null;let r=e.map(e=>e[s]).filter(e=>null!=e&&!isNaN(Number(e))).map(Number);if(0===r.length)return null;switch(t.function){case"min":return Math.min(...r);case"max":return Math.max(...r);case"avg":return Math.round(r.reduce((e,t)=>e+t,0)/r.length*100)/100;case"sum":return Math.round(100*r.reduce((e,t)=>e+t,0))/100;default:return null}}applyOrderBy(e,t,s){if(!s)return e;let r=[...e],a=s.columns;return r.sort((e,s)=>{for(let r of a){let a=t.indexOf(r.column);if(-1===a)continue;let i=e[a],n=s[a];if(null===i&&null===n)continue;if(null===i)return"asc"===r.direction?-1:1;if(null===n)return"asc"===r.direction?1:-1;let l=0;if(0!==(l="number"==typeof i&&"number"==typeof n?i-n:String(i).localeCompare(String(n))))return"asc"===r.direction?l:-l}return 0}),r}formatValue(e){return null==e?null:"number"==typeof e?Math.round(1e3*e)/1e3:e instanceof Date?e.toISOString():String(e)}formatAsCSV(e,t){let s=[];for(let r of(s.push(e.map(e=>this.escapeCSV(e)).join(",")),t))s.push(r.map(e=>this.escapeCSV(e)).join(","));return s.join("\n")}escapeCSV(e){if(null==e)return"";let t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")?'"'.concat(t.replace(/"/g,'""'),'"'):t}buildMetadata(e){var t,s,r,a,i,n,l;return{aggregations:e.select.aggregates.map(e=>e.function),groupBy:(null==(t=e.groupBy)?void 0:t.columns[0])||null,orderBy:(null==(r=e.orderBy)||null==(s=r.columns[0])?void 0:s.column)||null,orderDir:(null==(i=e.orderBy)||null==(a=i.columns[0])?void 0:a.direction)||"asc",limit:(null==(n=e.limit)?void 0:n.value)||null,scope:e.from.scope.value||e.from.scope.scopeType,filters:(null==(l=e.where)?void 0:l.filters.length)||0}}createExplainResult(e){return{ok:!0,headers:["Operation","Cost","Rows","Details"],rows:this.planToRows(e),rowCount:1,metadata:{aggregations:[],groupBy:null,orderBy:null,orderDir:"asc",limit:null,scope:"all",filters:0}}}planToRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=[],r="  ".repeat(t);if(s.push(["".concat(r).concat(e.type),e.cost,e.rows,e.details?JSON.stringify(e.details):null]),e.children)for(let r of e.children)s.push(...this.planToRows(r,t+1));return s}setData(e){this.data=e}getData(){return this.data}constructor(e=[],t={}){this.data=[],this.warnings=[],this.data=e,this.options={timeout:5e3,maxRows:1e4,useCache:!0,cacheTTL:6e4,explainOnly:!1,format:"json",...t},this.metrics=this.initMetrics()}}var e_=s(33018);class eS{generateKey(e,t){let s="string"==typeof e?e:JSON.stringify(e),r=t?JSON.stringify(t):"";return(0,e_.createHash)("sha256").update(s+r).digest("hex").substring(0,16)}get(e,t){let s=this.generateKey(e,t),r=this.cache.get(s);return r?Date.now()>r.timestamp+r.ttl?(this.delete(s),this.stats.misses++,null):(this.updateAccessOrder(s),r.hits++,this.stats.hits++,r.value):(this.stats.misses++,null)}set(e,t,s){let r=this.generateKey(e),a=(null==s?void 0:s.ttl)||this.defaultTTL,i=(null==s?void 0:s.size)||this.estimateSize(t);this.cache.size>=this.maxSize&&this.evictLRU();let n={value:t,timestamp:Date.now(),ttl:a,hits:0,size:i};this.cache.set(r,n),this.updateAccessOrder(r),this.stats.size=this.cache.size}delete(e){let t=this.cache.delete(e);if(t){let t=this.accessOrder.indexOf(e);t>-1&&this.accessOrder.splice(t,1),this.stats.size=this.cache.size}return t}clear(){this.cache.clear(),this.accessOrder=[],this.stats.size=0,this.stats.evictions=0}getStats(){return{...this.stats}}getHitRate(){let e=this.stats.hits+this.stats.misses;return 0===e?0:this.stats.hits/e}evictLRU(){if(0===this.accessOrder.length)return;let e=this.accessOrder[0];this.cache.delete(e),this.accessOrder.shift(),this.stats.evictions++,this.stats.size=this.cache.size}updateAccessOrder(e){let t=this.accessOrder.indexOf(e);t>-1&&this.accessOrder.splice(t,1),this.accessOrder.push(e)}estimateSize(e){return null==e?0:"string"==typeof e?e.length:"number"==typeof e?8:"boolean"==typeof e?1:e instanceof Date?8:Array.isArray(e)?e.reduce((e,t)=>e+this.estimateSize(t),0):"object"==typeof e?Object.entries(e).reduce((e,t)=>{let[s,r]=t;return e+s.length+this.estimateSize(r)},0):0}pruneExpired(){let e=Date.now(),t=0;for(let[s,r]of this.cache.entries())e>r.timestamp+r.ttl&&(this.delete(s),t++);return t}getSizeInBytes(){let e=0;for(let t of this.cache.values())e+=t.size;return e}export(){return JSON.stringify({entries:Array.from(this.cache.entries()),stats:this.stats,accessOrder:this.accessOrder})}import(e){try{let t=JSON.parse(e);this.cache=new Map(t.entries),this.stats=t.stats,this.accessOrder=t.accessOrder||[],this.pruneExpired()}catch(e){console.error("Failed to import cache:",e)}}constructor(e=1e3,t=3e5){this.accessOrder=[],this.cache=new Map,this.maxSize=e,this.defaultTTL=t,this.stats={hits:0,misses:0,evictions:0,size:0,maxSize:e}}}class ek extends eS{getAST(e){return this.get(e)}setAST(e,t){this.set(e,t,{size:JSON.stringify(t).length})}constructor(e=500){super(e,36e5)}}class eE extends eS{getResult(e,t){return this.get(e,t?{userId:t}:void 0)}setResult(e,t,s){let r=this.estimateResultSize(t);this.set(e,t,{size:r,metadata:s?{userId:s}:void 0})}estimateResultSize(e){let t=100;return e.headers&&(t+=e.headers.join("").length),e.rows&&(t+=50*e.rows.length),e.csv&&(t+=e.csv.length),t}invalidateUser(e){let t=[];for(let[a,i]of this.cache.entries()){var s,r;(null==(r=i.value)||null==(s=r.metadata)?void 0:s.userId)===e&&t.push(a)}t.forEach(e=>this.delete(e))}constructor(e=100,t=6e4){super(e,t)}}class eC{getParsedQuery(e){return this.globalEnabled?this.parsedCache.getAST(e):null}setParsedQuery(e,t){this.globalEnabled&&this.parsedCache.setAST(e,t)}getQueryResult(e,t){return this.globalEnabled?this.resultCache.getResult(e,t):null}setQueryResult(e,t,s){this.globalEnabled&&(t.cached=!0,this.resultCache.setResult(e,t,s))}clearAll(){this.parsedCache.clear(),this.resultCache.clear()}getStatistics(){let e=this.parsedCache.getStats(),t=this.resultCache.getStats(),s=e.hits+t.hits,r=e.misses+t.misses;return{parsed:e,results:t,totalHitRate:s+r===0?0:s/(s+r)}}pruneExpired(){return{parsed:this.parsedCache.pruneExpired(),results:this.resultCache.pruneExpired()}}setEnabled(e){this.globalEnabled=e,e||this.clearAll()}isEnabled(){return this.globalEnabled}constructor(e){var t;this.globalEnabled=!0,this.parsedCache=new ek((null==e?void 0:e.maxParsedQueries)||500),this.resultCache=new eE((null==e?void 0:e.maxResults)||100,(null==e?void 0:e.resultTTL)||6e4),this.globalEnabled=null==(t=null==e?void 0:e.enabled)||t}}let eT=new eC,eA=[{computer_name:"LAPTOP-001",role:"Workstation",os_platform:"Windows 11",os_version:"22H2",group_name:"Laptops",location:"NA-US",disk_free_gb:68.2,memory_gb:16,cpu_percent:32.5,compliance_score:.87,last_reboot:"2024-05-18",last_seen:"2024-05-20"},{computer_name:"LAPTOP-002",role:"Workstation",os_platform:"Windows 10",os_version:"21H2",group_name:"Laptops",location:"NA-US",disk_free_gb:45.4,memory_gb:8,cpu_percent:74.3,compliance_score:.62,last_reboot:"2024-05-16",last_seen:"2024-05-19"},{computer_name:"LAPTOP-003",role:"Workstation",os_platform:"Windows 11",os_version:"23H1",group_name:"Finance Workstations",location:"NA-US",disk_free_gb:120.1,memory_gb:16,cpu_percent:18.9,compliance_score:.92,last_reboot:"2024-05-14",last_seen:"2024-05-18"},{computer_name:"SERVER-API-01",role:"Server",os_platform:"Windows Server 2019",os_version:"2019",group_name:"Data Center Servers",location:"NA-US",disk_free_gb:512.4,memory_gb:64,cpu_percent:42.1,compliance_score:.95,last_reboot:"2024-05-12",last_seen:"2024-05-17"},{computer_name:"SERVER-SQL-01",role:"Server",os_platform:"Windows Server 2022",os_version:"2022",group_name:"Data Center Servers",location:"NA-US",disk_free_gb:312.9,memory_gb:128,cpu_percent:55.3,compliance_score:.89,last_reboot:"2024-05-13",last_seen:"2024-05-17"},{computer_name:"SRV-LNX-01",role:"Server",os_platform:"Linux",os_version:"RHEL 9",group_name:"Data Center Servers",location:"EU-DE",disk_free_gb:212.5,memory_gb:32,cpu_percent:21.7,compliance_score:.91,last_reboot:"2024-05-11",last_seen:"2024-05-15"},{computer_name:"MAC-OPS-01",role:"Workstation",os_platform:"macOS",os_version:"14.4",group_name:"Operations",location:"NA-US",disk_free_gb:180.7,memory_gb:32,cpu_percent:23.4,compliance_score:.88,last_reboot:"2024-05-18",last_seen:"2024-05-20"},{computer_name:"MAC-FIN-02",role:"Workstation",os_platform:"macOS",os_version:"13.6",group_name:"Finance Workstations",location:"NA-US",disk_free_gb:102.6,memory_gb:16,cpu_percent:26.1,compliance_score:.93,last_reboot:"2024-05-15",last_seen:"2024-05-18"},{computer_name:"ENG-LAB-01",role:"Workstation",os_platform:"Windows 11",os_version:"22H2",group_name:"Engineering Lab",location:"NA-US",disk_free_gb:250.8,memory_gb:32,cpu_percent:65.2,compliance_score:.77,last_reboot:"2024-05-15",last_seen:"2024-05-18"},{computer_name:"ENG-LAB-02",role:"Workstation",os_platform:"Windows 11",os_version:"22H2",group_name:"Engineering Lab",location:"NA-US",disk_free_gb:198.4,memory_gb:32,cpu_percent:58.4,compliance_score:.75,last_reboot:"2024-05-15",last_seen:"2024-05-18"},{computer_name:"CANARY-EDGE",role:"Workstation",os_platform:"Windows 11",os_version:"23H1",group_name:"Canary Cohort",location:"NA-US",disk_free_gb:156.4,memory_gb:16,cpu_percent:12.4,compliance_score:.98,last_reboot:"2024-05-19",last_seen:"2024-05-20"}];class eR{async query(e,t){let s=performance.now();try{if(!e||"string"!=typeof e)throw new em("Question is required and must be a string");let r=this.normalizeQuery(e);if((null==t?void 0:t.useCache)!==!1){let e=this.cache.getQueryResult(r);if(e)return e.execution={...e.execution,cacheHit:!0,totalTimeMs:performance.now()-s},e}let a=this.cache.getParsedQuery(r);if(!a){let e=performance.now();a=this.parser.parse(r);let t=performance.now()-e;this.cache.setParsedQuery(r,a),a&&(a.parseTimeMs=t)}let i=await this.executor.execute(a);return i.execution={...i.execution,totalTimeMs:performance.now()-s},(null==t?void 0:t.useCache)!==!1&&this.cache.setQueryResult(r,i),i}catch(e){return{ok:!1,error:e instanceof Error?e.message:String(e),errorPosition:e instanceof eh?e.position:void 0,execution:{parseTimeMs:0,planTimeMs:0,executeTimeMs:0,totalTimeMs:performance.now()-s,scoped:0,filtered:0,rowsExamined:0,cacheHit:!1}}}}parse(e){let t=this.normalizeQuery(e),s=this.cache.getParsedQuery(t);if(s)return s;let r=this.parser.parse(t);return this.cache.setParsedQuery(t,r),r}async explain(e){let t=this.parse(e);return this.executor.execute(t)}normalizeQuery(e){return e.trim().replace(/\s+/g," ").replace(/^get\s+/i,"Get ")}saveQuery(e,t,s){let r={id:"saved_".concat(Date.now()),name:e,question:t,description:s,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),executionCount:0};return this.savedQueries.set(e.toLowerCase(),r),r}getSavedQuery(e){return this.savedQueries.get(e.toLowerCase())}listSavedQueries(){return Array.from(this.savedQueries.values())}async runSavedQuery(e){let t=this.getSavedQuery(e);if(!t)throw new em("No saved query found with name: ".concat(e));t.executionCount=(t.executionCount||0)+1,t.lastExecuted=new Date().toISOString();let s=performance.now(),r=await this.query(t.question),a=performance.now()-s;return t.averageTimeMs?t.averageTimeMs=(t.averageTimeMs+a)/2:t.averageTimeMs=a,r}initializeTemplates(){this.addTemplate({id:"all-machines",name:"All Machines",description:"List all machines",template:"Get Computer Name, OS Platform, Group from all machines",parameters:[],category:"Basic",difficulty:1}),this.addTemplate({id:"high-cpu",name:"High CPU Usage",description:"Find machines with high CPU usage",template:'Get Computer Name, CPU Percent from all machines where CPU Percent is greater than "${threshold}" order by CPU Percent desc',parameters:[{name:"threshold",type:"number",required:!0,default:80}],category:"Performance",difficulty:2}),this.addTemplate({id:"low-disk",name:"Low Disk Space",description:"Find machines with low disk space",template:'Get Computer Name, Disk Free GB from all machines where Disk Free GB is less than "${threshold}" order by Disk Free GB',parameters:[{name:"threshold",type:"number",required:!0,default:50}],category:"Performance",difficulty:2}),this.addTemplate({id:"compliance-check",name:"Compliance Check",description:"Check compliance scores by group",template:"Get avg(Compliance Score), min(Compliance Score), count() from all machines group by Group",parameters:[],category:"Governance",difficulty:3})}addTemplate(e){this.templates.set(e.id,e)}getTemplate(e){return this.templates.get(e)}listTemplates(){return Array.from(this.templates.values())}applyTemplate(e,t){let s=this.getTemplate(e);if(!s)throw new em("Template not found: ".concat(e));let r=s.template;for(let e of s.parameters){var a;let s=null!=(a=t[e.name])?a:e.default;if(e.required&&void 0===s)throw new em("Required parameter missing: ".concat(e.name));r=r.replace("${".concat(e.name,"}"),String(s))}return r}setData(e){this.data=e,this.executor.setData(e),this.cache.clearAll()}getData(){return this.data}getFieldSuggestions(){return Array.from(ey.keys())}getSensorsCatalog(){return ev}getAggregateFunctions(){return eb}clearCache(){this.cache.clearAll()}getCacheStatistics(){return this.cache.getStatistics()}export(){return JSON.stringify({savedQueries:Array.from(this.savedQueries.entries()),templates:Array.from(this.templates.entries())},null,2)}import(e){try{let t=JSON.parse(e);t.savedQueries&&(this.savedQueries=new Map(t.savedQueries)),t.templates&&(this.templates=new Map(t.templates))}catch(e){throw new em("Failed to import data: ".concat(e))}}constructor(e){this.savedQueries=new Map,this.templates=new Map,this.parser=new ex(null==e?void 0:e.parserOptions),this.data=(null==e?void 0:e.data)||eA,this.executor=new ej(this.data,null==e?void 0:e.executorOptions),this.cache=(null==e?void 0:e.cacheEnabled)!==!1?eT:new eC({enabled:!1}),this.initializeTemplates()}}new eR;let eO=(0,a.lazy)(()=>s.e(5059).then(s.bind(s,75059)).then(e=>({default:e.NaturalLanguageInput})));function eI(e,t){switch(t.type){case"SET_MODE":return{...e,mode:t.mode};case"ADD_SENSOR":return{...e,query:{...e.query,sensors:[...e.query.sensors,t.sensor]}};case"REMOVE_SENSOR":return{...e,query:{...e.query,sensors:e.query.sensors.filter((e,s)=>s!==t.index)}};case"UPDATE_SENSOR":return{...e,query:{...e.query,sensors:e.query.sensors.map((e,s)=>s===t.index?t.sensor:e)}};case"ADD_FILTER":return{...e,query:{...e.query,filters:[...e.query.filters,t.filter]}};case"REMOVE_FILTER":return{...e,query:{...e.query,filters:e.query.filters.filter(e=>e.id!==t.filterId)}};case"UPDATE_FILTER":return{...e,query:{...e.query,filters:e.query.filters.map(e=>e.id===t.filterId?t.filter:e)}};case"SET_SCOPE":return{...e,query:{...e.query,scope:t.scope}};case"SET_GROUP_BY":return{...e,query:{...e.query,groupBy:t.groupBy}};case"SET_ORDER_BY":return{...e,query:{...e.query,orderBy:t.orderBy}};case"SET_LIMIT":return{...e,query:{...e.query,limit:t.limit}};case"SET_RAW_QUERY":return{...e,query:{...e.query,rawQuery:t.query}};case"SET_VALIDATION":return{...e,validation:t.validation};case"SET_SUGGESTIONS":return{...e,suggestions:t.suggestions};case"SET_RESULT":return{...e,result:t.result};case"SET_EXECUTING":return{...e,isExecuting:t.isExecuting};case"ADD_TO_HISTORY":return{...e,history:[t.item,...e.history].slice(0,50)};case"RESET_QUERY":return{...e,query:eL,validation:eM,result:void 0};default:return e}}let eL={sensors:[],aggregates:[],scope:{type:"all"},filters:[],filterLogic:"AND",groupBy:[],orderBy:[],limit:void 0,rawQuery:""},eM={isValid:!1,errors:[],warnings:[],syntaxValid:!1,semanticValid:!1},eD={mode:"guided",query:eL,validation:eM,suggestions:[],isExecuting:!1,result:void 0,history:[]};function eP(e){let{initialQuery:t,mode:s="guided",onQueryChange:b,onExecute:N,readOnly:w=!1,showResults:j=!0,showHistory:_=!0,maxHeight:S="800px",className:k=""}=e,[E,C]=(0,a.useReducer)(eI,{...eD,mode:s,query:t||eL}),[T]=(0,a.useState)(()=>new eR),[A,O]=(0,a.useState)(!1),{validate:I,getQueryString:L}=function(){let e=(0,a.useCallback)(e=>{let t=[],s=[];if(0===e.sensors.length&&0===e.aggregates.length&&t.push({field:"sensors",message:"Query must have at least one sensor or aggregate function",severity:"error"}),e.sensors.forEach((e,r)=>{let a="name"in e.sensor?e.sensor.name:void 0;a&&""!==a.trim()||t.push({field:"sensor[".concat(r,"]"),message:"Sensor name cannot be empty",severity:"error"}),e.parameters&&Object.entries(e.parameters).forEach(e=>{let[t,a]=e;(void 0===a||""===a)&&s.push({field:"sensor[".concat(r,"].").concat(t),message:'Parameter "'.concat(t,'" is empty'),suggestion:"Provide a value or use default",severity:"warning"})})}),e.filters.forEach(e=>{e.sensor&&""!==e.sensor.trim()||t.push({field:"filter[".concat(e.id,"]"),message:"Filter must have a sensor selected",severity:"error"}),(""===e.value||void 0===e.value)&&t.push({field:"filter[".concat(e.id,"]"),message:"Filter value cannot be empty",severity:"error"}),"number"===e.dataType&&isNaN(Number(e.value))&&t.push({field:"filter[".concat(e.id,"]"),message:"Filter value must be a valid number",severity:"error"})}),e.groupBy.length>0){let s=new Set(e.groupBy);e.sensors.some(e=>!s.has("name"in e.sensor&&e.sensor.name||""))&&0===e.aggregates.length&&t.push({field:"groupBy",message:"Non-grouped sensors must be aggregated when using GROUP BY",severity:"error"})}e.orderBy.length>0&&e.orderBy.forEach((e,s)=>{e.sensor&&""!==e.sensor.trim()||t.push({field:"orderBy[".concat(s,"]"),message:"ORDER BY must specify a sensor",severity:"error"})}),void 0!==e.limit&&(e.limit<=0&&t.push({field:"limit",message:"LIMIT must be greater than 0",severity:"error"}),e.limit>1e4&&s.push({field:"limit",message:"LIMIT is very high",suggestion:"Consider using a smaller limit for better performance",severity:"warning"})),e.sensors.length>10&&s.push({field:"sensors",message:"Many sensors selected",suggestion:"Consider reducing sensors for better performance",severity:"warning"}),0===e.filters.length&&"all"===e.scope.type&&s.push({field:"filters",message:"No filters applied",suggestion:"Consider adding filters to reduce result set",severity:"info"});let r=0===t.length,a=0===t.filter(e=>"critical"===e.severity).length;return{isValid:r,errors:t,warnings:s,syntaxValid:a,semanticValid:r}},[]),t=(0,a.useCallback)(e=>{let t="name"in e.sensor?e.sensor.name:void 0;return!(!t||""===t.trim()||e.parameters&&Object.entries(e.parameters).some(e=>{let[t,s]=e;return void 0===s||""===s}))&&!0},[]);return{validate:e,validateSensor:t,validateFilter:(0,a.useCallback)(e=>!(!e.sensor||""===e.sensor.trim()||""===e.value||void 0===e.value||"number"===e.dataType&&isNaN(Number(e.value))),[]),getQueryString:(0,a.useCallback)(e=>{let t=[];if(e.rawQuery&&e.rawQuery.trim())return e.rawQuery;if(e.sensors.length>0||e.aggregates.length>0){t.push("Get");let s=[];e.sensors.forEach(e=>{let t="name"in e.sensor&&e.sensor.name||"";if(e.parameters&&Object.keys(e.parameters).length>0){let s=Object.entries(e.parameters).map(e=>{let[t,s]=e;return"".concat(t,'="').concat(s,'"')}).join(", ");t+="[".concat(s,"]")}e.filter&&(t+=" ".concat(e.filter.operator.replace(/_/g," "),' "').concat(e.filter.value,'"')),s.push(t)}),e.aggregates.forEach(e=>{let t=e.sensor?"".concat(e.function,"(").concat(e.sensor,")"):"".concat(e.function,"()");s.push(t)}),t.push(s.join(" and "))}else t.push("Get Computer Name");if(t.push("from"),"all"===e.scope.type?t.push("all machines"):"group"===e.scope.type&&e.scope.computerGroup?t.push('group "'.concat(e.scope.computerGroup,'"')):t.push("all machines"),e.filters.length>0){t.push("where");let s=(t,r)=>{let a=t.filter(e=>r?e.parentId===r:!e.parentId&&!e.isNested).map(e=>{let t=e.operator.replace(/_/g," ");return"".concat(e.sensor," ").concat(t,' "').concat(e.value,'"')});return t.filter(e=>e.isNested&&e.parentId===r).forEach(e=>{let r=s(t,e.id);r&&a.push("(".concat(r,")"))}),a.join(" ".concat(e.filterLogic.toLowerCase()," "))};t.push(s(e.filters))}if(e.groupBy.length>0&&(t.push("group by"),t.push(e.groupBy.join(", "))),e.orderBy.length>0){t.push("order by");let s=e.orderBy.map(e=>"".concat(e.sensor," ").concat(e.direction));t.push(s.join(", "))}return e.limit&&t.push("limit ".concat(e.limit)),t.join(" ")},[])}}(),{parse:M,getSuggestions:D,isProcessing:P}=function(){let[e,t]=(0,a.useState)(!1),s=(0,a.useCallback)(async e=>{t(!0);try{await new Promise(e=>setTimeout(e,500));let t={sensors:[],aggregates:[],scope:{type:"all"},filters:[],filterLogic:"AND",groupBy:[],orderBy:[],limit:void 0},s=[],a=0,n="";for(let{pattern:s,type:l}of el){let o=e.match(s);if(o){switch(l){case"list":case"query":let s=o[1]||o[2],c=r(s);c.forEach(e=>{t.sensors.push({sensor:{name:e,key:e.toLowerCase().replace(/\s+/g,"_"),type:"text",category:"General"},isValid:!0})}),a=.8,n="Query for ".concat(c.join(", "));break;case"filter":case"contains":case"comparison":let d=i(e);t.filters=d.filters,t.sensors=d.sensors,a=.75,n="Filter by ".concat(d.filters.map(e=>e.sensor).join(", "));break;case"count":case"aggregate":t.aggregates.push({function:"count"});let u=r(o[1]);u.forEach(e=>{t.sensors.push({sensor:{name:e,key:e.toLowerCase().replace(/\s+/g,"_"),type:"text",category:"General"},isValid:!0})}),a=.85,n="Count ".concat(u.join(", "));break;case"limit":t.limit=parseInt(o[1]);let m=r(o[2]);m.forEach(e=>{t.sensors.push({sensor:{name:e,key:e.toLowerCase().replace(/\s+/g,"_"),type:"text",category:"General"},isValid:!0})}),a=.9,n="Top ".concat(t.limit," ").concat(m.join(", "))}break}}if(0===t.sensors.length){let s=r(e);s.length>0?(s.forEach(e=>{t.sensors.push({sensor:{name:e,key:e.toLowerCase().replace(/\s+/g,"_"),type:"text",category:"General"},isValid:!0})}),a=.5,n="Query for ".concat(s.join(", "))):(t.sensors.push({sensor:{name:"Computer Name",key:"computer_name",type:"text",category:"System"},isValid:!0}),a=.3,n="Default query for Computer Name")}return a<.8&&(s.push({query:{...t,sensors:[{sensor:{name:"Computer Name",key:"computer_name",type:"text",category:"System"},isValid:!0},{sensor:{name:"Operating System",key:"os_platform",type:"text",category:"System"},isValid:!0}]},confidence:.6,explanation:"Show computer names and operating systems"}),s.push({query:{...t,sensors:[{sensor:{name:"Computer Name",key:"computer_name",type:"text",category:"System"},isValid:!0}],filters:[{id:"filter-1",sensor:"Operating System",operator:"contains",value:"Windows",dataType:"text"}]},confidence:.5,explanation:"Show Windows computers"})),{query:t,confidence:a,alternatives:s,interpretation:n}}finally{t(!1)}},[]),r=(0,a.useCallback)(e=>{let t=[],s=e.toLowerCase();for(let[e,r]of Object.entries(eo))for(let a of r)if(s.includes(a)){t.push(e);break}return t.length>0?t:["Computer Name"]},[]),i=(0,a.useCallback)(e=>{let t=[],s=[],a=e.toLowerCase();for(let[i,n]of Object.entries(ec))for(let l of n)if(a.includes(l)){let a=RegExp("(\\w+(?:\\s+\\w+)*?)\\s+".concat(l,"\\s+[\"']?([^\"']+)[\"']?"),"i"),n=e.match(a);if(n){let e=r(n[1])[0]||"Computer Name";t.push({id:"filter-".concat(Date.now()),sensor:e,operator:i,value:n[2].trim(),dataType:"text"}),s.push({sensor:{name:e,key:e.toLowerCase().replace(/\s+/g,"_"),type:"text",category:"General"},isValid:!0})}}return{filters:t,sensors:s}},[r]);return{parse:s,getSuggestions:(0,a.useCallback)((e,t)=>{let s=[],r=e.toLowerCase();if(e.length<2)return s;for(let[e,t]of Object.entries(eo))t.some(e=>e.includes(r)||r.includes(e))&&s.push({id:"sensor-".concat(e),type:"sensor",text:"Get ".concat(e," from all machines"),displayText:e,description:"Add ".concat(e," sensor to query"),confidence:.8,category:"Sensors"});return(r.includes("cpu")||r.includes("high"))&&s.push({id:"template-high-cpu",type:"template",text:"Get Computer Name and CPU Percent from all machines where CPU Percent greater than 80",displayText:"High CPU usage",description:"Find machines with CPU > 80%",confidence:.9,category:"Templates",runtime:150}),(r.includes("disk")||r.includes("space"))&&s.push({id:"template-low-disk",type:"template",text:"Get Computer Name and Disk Free GB from all machines where Disk Free GB less than 50",displayText:"Low disk space",description:"Find machines with < 50GB free",confidence:.9,category:"Templates",runtime:120}),r.includes("windows")&&s.push({id:"filter-windows",type:"filter",text:'where Operating System contains "Windows"',displayText:"Filter Windows machines",description:"Add Windows filter",confidence:.85,category:"Filters"}),s.sort((e,t)=>t.confidence-e.confidence),s.slice(0,10)},[]),isProcessing:e}}(),{catalog:B,search:q,categories:F,popularSensors:U}=function(){let e=(0,a.useMemo)(()=>Array.from(new Set(ed.map(e=>e.category))).sort(),[]),t=(0,a.useMemo)(()=>ed.filter(e=>e.popularity>.7).sort((e,t)=>t.popularity-e.popularity).slice(0,8),[]),s=(0,a.useCallback)(e=>{if(!e||""===e.trim())return ed;let t=e.toLowerCase();return ed.filter(e=>{var s,r,a;let i="name"in e.sensor&&(null==(s=e.sensor.name)?void 0:s.toLowerCase().includes(t)),n=null==(r=e.description)?void 0:r.toLowerCase().includes(t),l=e.category.toLowerCase().includes(t),o="key"in e.sensor&&(null==(a=e.sensor.key)?void 0:a.toLowerCase().includes(t));return i||n||l||o})},[]),r=(0,a.useCallback)(e=>"all"!==e&&e?ed.filter(t=>t.category===e):ed,[]);return{catalog:ed,search:s,getByCategory:r,categories:e,popularSensors:t}}();(0,a.useEffect)(()=>{C({type:"SET_VALIDATION",validation:I(E.query)})},[E.query,I]),(0,a.useEffect)(()=>{b&&b(E.query)},[E.query,b]);let G=(0,a.useCallback)(async()=>{if(!w&&E.validation.isValid){C({type:"SET_EXECUTING",isExecuting:!0});try{var e;let t=L(E.query),s=await T.query(t);C({type:"SET_RESULT",result:s});let r={id:"query-".concat(Date.now()),query:t,timestamp:new Date().toISOString(),executionTime:null==(e=s.execution)?void 0:e.totalTimeMs,resultCount:s.rowCount,success:s.ok};C({type:"ADD_TO_HISTORY",item:r}),N&&N(t,s)}catch(e){console.error("Query execution error:",e),C({type:"SET_RESULT",result:{ok:!1,error:e instanceof Error?e.message:"Query execution failed"}})}finally{C({type:"SET_EXECUTING",isExecuting:!1})}}},[E.query,E.validation.isValid,T,L,N,w]),V=(0,a.useCallback)(async e=>{let t=await M(e);t.query&&(C({type:"RESET_QUERY"}),t.query.sensors.forEach(e=>{C({type:"ADD_SENSOR",sensor:e})}),t.query.filters.forEach(e=>{C({type:"ADD_FILTER",filter:e})}),t.query.scope&&C({type:"SET_SCOPE",scope:t.query.scope}))},[M]),Q=(0,a.useCallback)(e=>{C({type:"SET_RAW_QUERY",query:e.query}),"advanced"===E.mode&&G(),O(!1)},[E.mode,G]),H=E.validation.errors.length>0?{icon:d.A,color:"text-red-500",text:"Invalid query"}:E.validation.warnings.length>0?{icon:u.A,color:"text-yellow-500",text:"Query has warnings"}:E.validation.isValid?{icon:m.A,color:"text-green-500",text:"Valid query"}:{icon:d.A,color:"text-gray-500",text:"Incomplete query"};return(0,r.jsxs)(i.Zp,{className:"glass border-white/10 ".concat(k),children:[(0,r.jsx)(i.aR,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(i.ZB,{className:"flex items-center text-white",children:[(0,r.jsx)(h.A,{className:"mr-2 h-5 w-5 text-tanium-accent"}),"Tanium Question Builder"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(H.icon,{className:"h-4 w-4 ".concat(H.color)}),(0,r.jsx)("span",{className:"text-sm ".concat(H.color),children:H.text})]}),(0,r.jsx)(l.$,{size:"sm",variant:"ghost",onClick:()=>C({type:"RESET_QUERY"}),disabled:w,children:(0,r.jsx)(p.A,{className:"h-4 w-4"})}),_&&(0,r.jsxs)(l.$,{size:"sm",variant:"ghost",onClick:()=>O(!A),children:[(0,r.jsx)(g.A,{className:"h-4 w-4"}),(0,r.jsx)(o.E,{variant:"secondary",className:"ml-1",children:E.history.length})]}),(0,r.jsx)(l.$,{size:"sm",onClick:G,disabled:w||!E.validation.isValid||E.isExecuting,className:"bg-tanium-accent hover:bg-blue-600",children:E.isExecuting?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-2"}),"Executing..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{className:"mr-1 h-4 w-4"}),"Execute Query"]})})]})]})}),(0,r.jsxs)(i.Wu,{className:"space-y-4",style:{maxHeight:S,overflow:"auto"},children:[(0,r.jsxs)(n.tU,{value:E.mode,onValueChange:e=>C({type:"SET_MODE",mode:e}),children:[(0,r.jsxs)(n.j7,{className:"grid w-full grid-cols-3 bg-gray-800",children:[(0,r.jsxs)(n.Xi,{value:"guided",className:"flex items-center",children:[(0,r.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Guided"]}),(0,r.jsxs)(n.Xi,{value:"natural-language",className:"flex items-center",children:[(0,r.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"Natural Language"]}),(0,r.jsxs)(n.Xi,{value:"advanced",className:"flex items-center",children:[(0,r.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Advanced"]})]}),(0,r.jsx)(n.av,{value:"guided",className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(R,{selectedSensors:E.query.sensors,onAdd:e=>C({type:"ADD_SENSOR",sensor:e}),onRemove:e=>C({type:"REMOVE_SENSOR",index:e}),onUpdate:(e,t)=>C({type:"UPDATE_SENSOR",index:e,sensor:t}),catalog:B,className:"mb-4"}),(0,r.jsx)(W,{filters:E.query.filters,onAdd:e=>C({type:"ADD_FILTER",filter:e}),onRemove:e=>C({type:"REMOVE_FILTER",filterId:e}),onUpdate:(e,t)=>C({type:"UPDATE_FILTER",filterId:e,filter:t}),availableSensors:B.map(e=>"name"in e.sensor?e.sensor.name:""),filterLogic:E.query.filterLogic,onLogicChange:e=>C({type:"SET_SCOPE",scope:{...E.query.scope,customFilter:E.query.filters}}),allowNested:!0,className:"mb-4"}),(0,r.jsx)(z,{query:E.query,validation:E.validation,syntaxHighlight:!0,showWarnings:!0,className:"mb-4"})]})}),(0,r.jsxs)(n.av,{value:"natural-language",className:"space-y-4",children:[(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-tanium-accent"}),(0,r.jsx)("span",{className:"text-gray-400",children:"Loading Natural Language mode..."})]})}),children:(0,r.jsx)(eO,{value:E.query.rawQuery||"",onChange:e=>C({type:"SET_RAW_QUERY",query:e}),onSubmit:V,suggestions:E.suggestions,isProcessing:P,placeholder:"Type a natural language query (e.g., 'Show me all Windows servers with high CPU usage')",className:"mb-4"})}),E.query.sensors.length>0&&(0,r.jsx)(z,{query:E.query,validation:E.validation,syntaxHighlight:!0,showWarnings:!0,className:"mb-4"})]}),(0,r.jsx)(n.av,{value:"advanced",className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("textarea",{className:"w-full h-32 p-3 bg-gray-800 border border-gray-600 rounded text-white font-mono text-sm",placeholder:"Enter Tanium query directly (e.g., Get Computer Name from all machines)",value:E.query.rawQuery,onChange:e=>C({type:"SET_RAW_QUERY",query:e.target.value}),disabled:w}),E.validation.errors.length>0&&(0,r.jsxs)(c.Fc,{className:"border-red-500 bg-red-500/10",children:[(0,r.jsx)(d.A,{className:"h-4 w-4 text-red-500"}),(0,r.jsx)(c.TN,{className:"text-red-400",children:E.validation.errors[0].message})]})]})})]}),j&&E.result&&(0,r.jsx)(en,{result:E.result,isLoading:E.isExecuting,onExport:e=>{console.log("Export as:",e)},className:"mt-4"}),_&&A&&(0,r.jsxs)(i.Zp,{className:"glass border-white/10 mt-4",children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{className:"text-white text-sm",children:"Query History"})}),(0,r.jsx)(i.Wu,{children:(0,r.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:E.history.map(e=>(0,r.jsxs)("div",{className:"p-2 bg-gray-800 rounded hover:bg-gray-700 cursor-pointer",onClick:()=>Q(e),children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)("code",{className:"text-xs text-gray-300 block",children:e.query})}),(0,r.jsx)("div",{className:"text-xs text-gray-500 ml-2",children:new Date(e.timestamp).toLocaleTimeString()})]}),void 0!==e.resultCount&&(0,r.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[e.resultCount," results  ",e.executionTime,"ms"]})]},e.id))})})]})]})]})}function eB(){return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"Tanium Query Builder"}),(0,r.jsx)("p",{className:"text-xl text-gray-400",children:"Learn to build Tanium queries interactively with guided assistance"})]}),(0,r.jsxs)(c.Fc,{className:"mb-6 border-blue-500 bg-blue-500/10",children:[(0,r.jsx)(u.A,{className:"h-4 w-4 text-blue-400"}),(0,r.jsxs)(c.TN,{className:"text-blue-300",children:[(0,r.jsx)("strong",{children:"Interactive Learning Mode:"})," This simulator helps you understand Tanium's natural language query system. Practice building queries using guided mode, natural language, or advanced syntax."]})]}),(0,r.jsxs)(i.Zp,{className:"glass border-white/10 mb-8",children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsx)(i.ZB,{className:"text-white",children:"Quick Start Guide"}),(0,r.jsx)(i.BT,{className:"text-gray-400",children:"Three ways to build queries"})]}),(0,r.jsxs)(i.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[(0,r.jsx)("h3",{className:"font-semibold text-white mb-2",children:"\uD83D\uDDB1 Guided Mode"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Use visual components to select sensors, add filters, and build queries step-by-step with immediate feedback."})]}),(0,r.jsxs)("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[(0,r.jsx)("h3",{className:"font-semibold text-white mb-2",children:" Natural Language"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:'Type queries in plain English like "Show me all Windows servers with high CPU usage" and watch them convert to Tanium syntax.'})]}),(0,r.jsxs)("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:[(0,r.jsx)("h3",{className:"font-semibold text-white mb-2",children:" Advanced Mode"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Write Tanium queries directly with syntax highlighting and validation for experienced users."})]})]}),(0,r.jsx)("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/50 rounded",children:(0,r.jsxs)("p",{className:"text-sm text-yellow-300",children:[(0,r.jsx)("strong",{children:"Tip:"})," Start with Natural Language mode to see how everyday questions translate into Tanium queries, then explore Guided mode to understand the components."]})})]})]}),(0,r.jsx)(eP,{mode:"natural-language",showResults:!0,showHistory:!0,onExecute:(e,t)=>{console.log("Query executed:",e),console.log("Result:",t)}}),(0,r.jsxs)(i.Zp,{className:"glass border-white/10 mt-8",children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{className:"text-white",children:"Learning Resources"})}),(0,r.jsxs)(i.Wu,{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("span",{className:"text-tanium-accent",children:""}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white font-medium",children:"Common Sensors"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"Computer Name, Operating System, IP Address, CPU Percent, Disk Free GB"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("span",{className:"text-tanium-accent",children:""}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white font-medium",children:"Filter Operators"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"contains, equals, greater than, less than, starts with, ends with"})]})]}),(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("span",{className:"text-tanium-accent",children:""}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white font-medium",children:"Aggregate Functions"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"count(), min(), max(), avg(), sum()"})]})]})]})]})]})}},86948:(e,t,s)=>{"use strict";s.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>o,Zp:()=>n,aR:()=>l,wL:()=>u});var r=s(95155),a=s(12115),i=s(64269);let n=a.forwardRef((e,t)=>{let{className:s,variant:a="cyberpunk",...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-xl border text-card-foreground shadow",{default:"bg-card",cyberpunk:"relative bg-black/20 backdrop-blur-xl border-cyan-500/20 text-cyan-100 shadow-[0_0_50px_rgba(34,211,238,0.1)] transition-all duration-200 ease-out hover:shadow-[0_0_80px_rgba(34,211,238,0.15)] hover:scale-[1.03] hover:-translate-y-0.5 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400/50"}[a],s),...n})});n.displayName="Card";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...a})});l.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("font-semibold leading-none tracking-tight",s),...a})});o.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",s),...a})});u.displayName="CardFooter"},87270:(e,t,s)=>{"use strict";s.d(t,{A0:()=>l,BF:()=>o,Hj:()=>c,XI:()=>n,nA:()=>u,nd:()=>d});var r=s(95155),a=s(12115),i=s(64269);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,i.cn)("w-full caption-bottom text-sm",s),...a})})});n.displayName="Table";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("thead",{ref:t,className:(0,i.cn)("[&_tr]:border-b",s),...a})});l.displayName="TableHeader";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,i.cn)("[&_tr:last-child]:border-0",s),...a})});o.displayName="TableBody",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a})}).displayName="TableFooter";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tr",{ref:t,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...a})});c.displayName="TableRow";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("th",{ref:t,className:(0,i.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})});d.displayName="TableHead";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("td",{ref:t,className:(0,i.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a})});u.displayName="TableCell",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("caption",{ref:t,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",s),...a})}).displayName="TableCaption"}},e=>{e.O(0,[5105,9268,4909,5376,2268,488,6093,7887,5667,9034,5741,5956,5891,8441,1255,7358],()=>e(e.s=74470)),_N_E=e.O()}]);