(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7486],{1524:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(71847).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},3998:(e,r,t)=>{"use strict";t.d(r,{$:()=>c});var s=t(95155),a=t(12115),o=t(32467),n=t(83101),i=t(64269);let l=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all duration-200 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400/50 focus-visible:shadow-[0_0_20px_rgba(34,211,238,0.15)] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-cyan-600 text-white shadow-[0_0_20px_rgba(34,211,238,0.1)] hover:bg-cyan-500 hover:shadow-[0_0_30px_rgba(34,211,238,0.15)] hover:scale-105 border border-cyan-500/50",destructive:"bg-red-600 text-white shadow-[0_0_20px_rgba(239,68,68,0.1)] hover:bg-red-500 hover:shadow-[0_0_30px_rgba(239,68,68,0.15)] border border-red-500/50",outline:"border border-cyan-500/30 bg-black/20 backdrop-blur-xl text-cyan-100 shadow-[0_0_20px_rgba(34,211,238,0.05)] hover:bg-cyan-500/10 hover:text-cyan-400 hover:shadow-[0_0_30px_rgba(34,211,238,0.1)]",secondary:"bg-slate-600 text-slate-100 shadow-[0_0_20px_rgba(71,85,105,0.1)] hover:bg-slate-500 hover:shadow-[0_0_30px_rgba(71,85,105,0.15)] border border-slate-500/50",ghost:"text-cyan-100 hover:bg-cyan-500/10 hover:text-cyan-400",link:"text-cyan-400 underline-offset-4 hover:underline hover:text-cyan-300"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,r)=>{let{className:t,variant:a,size:n,asChild:c=!1,...d}=e,u=c?o.DX:"button";return(0,s.jsx)(u,{className:(0,i.cn)(l({variant:a,size:n,className:t})),ref:r,...d})});c.displayName="Button"},6613:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(71847).A)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]])},11647:(e,r,t)=>{"use strict";t.d(r,{E:()=>i});var s=t(95155);t(12115);var a=t(83101),o=t(64269);let n=(0,a.F)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:r,variant:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)(n({variant:t}),r),...a})}},20508:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(71847).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},26983:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(71847).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},42529:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(71847).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},47937:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(71847).A)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},60235:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(71847).A)("bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]])},62890:(e,r,t)=>{"use strict";t.d(r,{N:()=>i});var s=t(65040),a=t(95704);let o="https://qnwcwoutgarhqxlgsjzs.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFud2N3b3V0Z2FyaHF4bGdzanpzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2NzM0MjgsImV4cCI6MjA3MjI0OTQyOH0.nooeC4pyNsoRok5zKat9iwUk9rgCfz_b5SWqZ7_dgtQ";if(!o)throw Error("NEXT_PUBLIC_SUPABASE_URL is required. Check your .env.local file.");if(!n)throw Error("NEXT_PUBLIC_SUPABASE_ANON_KEY is required. Check your .env.local file.");let i=(0,s.UU)(o||"",n||"");a.env.SUPABASE_SERVICE_ROLE_KEY&&(0,s.UU)(o||"",a.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})},64269:(e,r,t)=>{"use strict";t.d(r,{J8:()=>n,cn:()=>o});var s=t(2821),a=t(75889);function o(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.QP)((0,s.$)(r))}function n(e){switch(e.toLowerCase()){case"beginner":return"text-green-600 dark:text-green-400";case"intermediate":return"text-yellow-600 dark:text-yellow-400";case"advanced":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}}},65380:(e,r,t)=>{"use strict";t.d(r,{A:()=>i,O:()=>l});var s=t(95155),a=t(62890),o=t(12115);let n=(0,o.createContext)(void 0);function i(){let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function l(e){let{children:r}=e,[t,i]=(0,o.useState)({user:null,session:null,loading:!0,error:null});(0,o.useEffect)(()=>{(async()=>{try{let{data:{session:e},error:r}=await a.N.auth.getSession();if(r){console.error("Error getting initial session:",r),i(e=>({...e,error:r,loading:!1}));return}i(r=>{var t;return{...r,session:e,user:null!=(t=null==e?void 0:e.user)?t:null,loading:!1,error:null}})}catch(e){console.error("Unexpected error getting session:",e),i(r=>({...r,loading:!1,error:e}))}})();let{data:{subscription:e}}=a.N.auth.onAuthStateChange(async(e,r)=>{var t;console.log("Auth state changed:",e,null==r||null==(t=r.user)?void 0:t.id),i(e=>{var t;return{...e,session:r,user:null!=(t=null==r?void 0:r.user)?t:null,loading:!1,error:null}}),"SIGNED_IN"===e&&(null==r?void 0:r.user)||"SIGNED_OUT"===e&&(localStorage.removeItem("tco-progress"),localStorage.removeItem("tco-exam-session"),localStorage.removeItem("tco-incorrect-answers"),localStorage.removeItem("tco-settings"),localStorage.removeItem("tco-search-history"))});return()=>{e.unsubscribe()}},[]);let l=async(e,r)=>{i(e=>({...e,loading:!0,error:null}));try{let{error:t}=await a.N.auth.signInWithPassword({email:e,password:r});return t&&i(e=>({...e,error:t,loading:!1})),{error:t}}catch(e){return i(r=>({...r,error:e,loading:!1})),{error:e}}},c=async(e,r,t)=>{i(e=>({...e,loading:!0,error:null}));try{let{error:s}=await a.N.auth.signUp({email:e,password:r,options:{data:{first_name:(null==t?void 0:t.firstName)||"",last_name:(null==t?void 0:t.lastName)||""}}});return s&&i(e=>({...e,error:s,loading:!1})),{error:s}}catch(e){return i(r=>({...r,error:e,loading:!1})),{error:e}}},d=async()=>{i(e=>({...e,loading:!0,error:null}));try{let{error:e}=await a.N.auth.signOut();return e&&i(r=>({...r,error:e,loading:!1})),{error:e}}catch(e){return i(r=>({...r,error:e,loading:!1})),{error:e}}},u=async e=>{try{let{error:r}=await a.N.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin).concat("","/auth/reset-password")});return{error:r}}catch(e){return{error:e}}},m=async e=>{if(!t.user)return{error:{message:"No user logged in"}};try{let{error:r}=await a.N.auth.updateUser({data:{first_name:e.firstName,last_name:e.lastName}});if(r)return{error:r};return{error:null}}catch(e){return{error:e}}},g={...t,signIn:l,signUp:c,signOut:d,resetPassword:u,updateProfile:m};return(0,s.jsx)(n.Provider,{value:g,children:r})}},80991:(e,r,t)=>{"use strict";t.d(r,{k:()=>i});var s=t(95155),a=t(12115),o=t(9484),n=t(64269);let i=a.forwardRef((e,r)=>{let{className:t,value:a,...i}=e;return(0,s.jsx)(o.bL,{ref:r,className:(0,n.cn)("relative h-2 w-full overflow-hidden rounded-full bg-slate-800/60 border border-cyan-500/20 shadow-[0_0_10px_rgba(34,211,238,0.05)]",t),...i,children:(0,s.jsx)(o.C1,{className:"h-full w-full flex-1 bg-gradient-to-r from-cyan-500 to-sky-400 transition-all duration-300 ease-out shadow-[0_0_15px_rgba(34,211,238,0.3)]",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});i.displayName=o.bL.displayName},84926:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(71847).A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])},86948:(e,r,t)=>{"use strict";t.d(r,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>n,aR:()=>i,wL:()=>u});var s=t(95155),a=t(12115),o=t(64269);let n=a.forwardRef((e,r)=>{let{className:t,variant:a="cyberpunk",...n}=e;return(0,s.jsx)("div",{ref:r,className:(0,o.cn)("rounded-xl border text-card-foreground shadow",{default:"bg-card",cyberpunk:"relative bg-black/20 backdrop-blur-xl border-cyan-500/20 text-cyan-100 shadow-[0_0_50px_rgba(34,211,238,0.1)] transition-all duration-200 ease-out hover:shadow-[0_0_80px_rgba(34,211,238,0.15)] hover:scale-[1.03] hover:-translate-y-0.5 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-cyan-400/50"}[a],t),...n})});n.displayName="Card";let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",t),...a})});i.displayName="CardHeader";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,o.cn)("font-semibold leading-none tracking-tight",t),...a})});l.displayName="CardTitle";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,o.cn)("text-sm text-muted-foreground",t),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,o.cn)("p-6 pt-0",t),...a})});d.displayName="CardContent";let u=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,o.cn)("flex items-center p-6 pt-0",t),...a})});u.displayName="CardFooter"},91169:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(71847).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},94414:(e,r,t)=>{"use strict";t.d(r,{DashboardContent:()=>A});var s=t(95155),a=t(86948),o=t(11647),n=t(80991),i=t(3998),l=t(42529),c=t(26983),d=t(47937),u=t(91169),m=t(52619),g=t.n(m),h=t(1733);function x(e){var r;let{module:t,progress:m,className:x}=e,y=(null==m?void 0:m.percentage)||0,p=100===y,f=y>0;return(0,s.jsx)(h.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},whileHover:{scale:1.03,y:-2,transition:{duration:.2,ease:"easeOut"}},className:"group",children:(0,s.jsxs)(a.Zp,{className:"relative bg-black/20 backdrop-blur-xl border border-cyan-500/20 shadow-[0_0_50px_rgba(34,211,238,0.1)] hover:shadow-[0_0_80px_rgba(34,211,238,0.15)] transition-all duration-200 ease-out focus-visible:ring-2 focus-visible:ring-cyan-400/50 focus-visible:shadow-[0_0_80px_rgba(34,211,238,0.15)] ".concat(x),children:[(0,s.jsx)("div",{className:"absolute -inset-[1px] bg-gradient-to-r from-cyan-500/10 via-sky-400/10 to-cyan-500/10 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 blur-sm"}),(0,s.jsxs)(a.aR,{className:"pb-4 relative",children:[(0,s.jsx)("div",{className:"flex items-start justify-between",children:(0,s.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(a.ZB,{className:"text-lg font-semibold text-cyan-100 group-hover:text-cyan-400 transition-colors",children:t.title}),p?(0,s.jsxs)(o.E,{variant:"default",className:"gap-1 bg-cyan-100 text-cyan-800 hover:bg-cyan-200 border-cyan-500/20",children:[(0,s.jsx)(l.A,{className:"h-3 w-3"}),"Completed"]}):f?(0,s.jsxs)(o.E,{variant:"default",className:"gap-1 bg-sky-100 text-sky-800 hover:bg-sky-200 border-sky-500/20",children:[(0,s.jsx)(c.A,{className:"h-3 w-3"}),"In Progress"]}):(0,s.jsxs)(o.E,{variant:"secondary",className:"gap-1 bg-slate-100 text-slate-700 hover:bg-slate-200 border-slate-500/20",children:[(0,s.jsx)(d.A,{className:"h-3 w-3"}),"Not Started"]})]}),(0,s.jsx)(a.BT,{className:"text-sm text-cyan-100/70 line-clamp-2",children:t.description})]})}),m&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsxs)("span",{className:"text-cyan-100/60",children:["Progress: ",m.completed,"/",m.total," sections"]}),(0,s.jsxs)("span",{className:"font-medium text-cyan-400",children:[y,"%"]})]}),(0,s.jsx)(n.k,{value:y,className:"h-2"})]})]}),(0,s.jsxs)(a.Wu,{className:"space-y-4 relative",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-cyan-100/60",children:[(0,s.jsx)(d.A,{className:"h-4 w-4 text-cyan-400"}),(0,s.jsxs)("span",{children:[(null==(r=t.sections)?void 0:r.length)||0," sections"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-cyan-100/60",children:[(0,s.jsx)(c.A,{className:"h-4 w-4 text-cyan-400"}),(0,s.jsx)("span",{children:t.estimated_time_minutes?"".concat(t.estimated_time_minutes," min"):"TBD"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-cyan-100/60",children:[(0,s.jsx)(u.A,{className:"h-4 w-4 text-cyan-400"}),(0,s.jsx)("span",{children:t.domain})]})]}),t.learning_objectives&&t.learning_objectives.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-cyan-100",children:"Key Learning Objectives:"}),(0,s.jsxs)("ul",{className:"text-sm text-cyan-100/60 space-y-1",children:[t.learning_objectives.slice(0,2).map((e,r)=>(0,s.jsxs)("li",{className:"flex items-start gap-2",children:[(0,s.jsx)("span",{className:"text-cyan-400 mt-1",children:"•"}),(0,s.jsx)("span",{className:"line-clamp-1",children:e})]},r)),t.learning_objectives.length>2&&(0,s.jsxs)("li",{className:"text-xs text-cyan-100/40 italic",children:["+",t.learning_objectives.length-2," more objectives"]})]})]}),(0,s.jsx)("div",{className:"pt-2",children:(0,s.jsx)(i.$,{asChild:!0,className:"w-full bg-cyan-600 hover:bg-cyan-500 text-white border-cyan-500/50",children:(0,s.jsx)(g(),{href:"/study/modules/".concat(t.id),children:p?"Review Module":f?"Continue Learning":"Start Learning"})})})]})]})})}var y=t(65380),p=t(62890);class f{async getAllModules(){let{data:e,error:r}=await p.N.from("study_modules").select("\n        *,\n        sections:study_sections(*)\n      ").order("order_index");if(r)throw Error("Failed to fetch study modules: ".concat(r.message));return e?e.map(e=>({...e,learning_objectives:Array.isArray(e.learning_objectives)?e.learning_objectives:[],references:Array.isArray(e.references)?e.references:[],exam_prep:"object"==typeof e.exam_prep&&null!==e.exam_prep?e.exam_prep:{description:"",exam_focus:[],practice_labs:[]}})):[]}async getModuleById(e){let{data:r,error:t}=await p.N.from("study_modules").select("\n        *,\n        sections:study_sections(*)\n      ").eq("id",e).single();if(t){if("PGRST116"===t.code)return null;throw Error("Failed to fetch module: ".concat(t.message))}return r?{...r,learning_objectives:Array.isArray(r.learning_objectives)?r.learning_objectives:[],references:Array.isArray(r.references)?r.references:[],exam_prep:"object"==typeof r.exam_prep&&null!==r.exam_prep?r.exam_prep:{description:"",exam_focus:[],practice_labs:[]}}:null}async getModuleByDomain(e){let{data:r,error:t}=await p.N.from("study_modules").select("\n        *,\n        sections:study_sections(*)\n      ").eq("domain",e).single();if(t){if("PGRST116"===t.code)return null;throw Error("Failed to fetch module by domain: ".concat(t.message))}return r?{...r,learning_objectives:Array.isArray(r.learning_objectives)?r.learning_objectives:[],references:Array.isArray(r.references)?r.references:[],exam_prep:"object"==typeof r.exam_prep&&null!==r.exam_prep?r.exam_prep:{description:"",exam_focus:[],practice_labs:[]}}:null}async getModuleSections(e){let{data:r,error:t}=await p.N.from("study_sections").select("*").eq("module_id",e).order("order_index");if(t)throw Error("Failed to fetch module sections: ".concat(t.message));return r}async getSectionById(e){let{data:r,error:t}=await p.N.from("study_sections").select("\n        *,\n        module:study_modules(*)\n      ").eq("id",e).single();if(t){if("PGRST116"===t.code)return null;throw Error("Failed to fetch section: ".concat(t.message))}return r?{...r,content:"object"==typeof r.content&&null!==r.content?r.content:{overview:"",key_points:[],procedures:[],troubleshooting:[],references:[]},key_points:Array.isArray(r.key_points)?r.key_points:[],procedures:Array.isArray(r.procedures)?r.procedures:[],troubleshooting:Array.isArray(r.troubleshooting)?r.troubleshooting:[],references:Array.isArray(r.references)?r.references:[]}:null}async searchSections(e){let{data:r,error:t}=await p.N.from("study_sections").select("\n        *,\n        module:study_modules(*)\n      ").or("title.ilike.%".concat(e,"%,description.ilike.%").concat(e,"%")).order("module_id",{ascending:!0}).order("order_index",{ascending:!0});if(t)throw Error("Failed to search sections: ".concat(t.message));return r?r.map(e=>({...e,content:"object"==typeof e.content&&null!==e.content?e.content:{overview:"",key_points:[],procedures:[],troubleshooting:[],references:[]},key_points:Array.isArray(e.key_points)?e.key_points:[],procedures:Array.isArray(e.procedures)?e.procedures:[],troubleshooting:Array.isArray(e.troubleshooting)?e.troubleshooting:[],references:Array.isArray(e.references)?e.references:[]})):[]}async getUserProgress(e){let{data:r,error:t}=await p.N.from("user_study_progress").select("*").eq("user_id",e);if(t)throw Error("Failed to fetch user progress: ".concat(t.message));return r}async updateSectionProgress(e,r,t,s){let{data:a,error:o}=await p.N.from("study_sections").select("module_id").eq("id",r).single();if(o)throw Error("Failed to fetch section for progress update: ".concat(o.message));if(!a)throw Error("Section data not found for progress update.");let n={user_id:e,section_id:r,module_id:a.module_id,status:t,completion_percentage:s||100*("completed"===t),last_accessed:new Date().toISOString(),..."completed"===t&&{completed_at:new Date().toISOString()}},{data:i,error:l}=await p.N.from("user_study_progress").upsert(n,{onConflict:"user_id,section_id"}).select().single();if(l)throw Error("Failed to update progress: ".concat(l.message));return i}async getUserBookmarks(e){let{data:r,error:t}=await p.N.from("user_study_bookmarks").select("\n        *,\n        section:study_sections(*),\n        module:study_modules(*)\n      ").eq("user_id",e).order("created_at",{ascending:!1});if(t)throw Error("Failed to fetch bookmarks: ".concat(t.message));return r?r.map(e=>({...e,section:e.section?{...e.section,content:"object"==typeof e.section.content&&null!==e.section.content?e.section.content:{overview:"",key_points:[],procedures:[],troubleshooting:[],references:[]},key_points:Array.isArray(e.section.key_points)?e.section.key_points:[],procedures:Array.isArray(e.section.procedures)?e.section.procedures:[],troubleshooting:Array.isArray(e.section.troubleshooting)?e.section.troubleshooting:[],references:Array.isArray(e.section.references)?e.section.references:[]}:void 0})):[]}async addBookmark(e,r,t,s){let{data:a,error:o}=await p.N.from("user_study_bookmarks").insert({user_id:e,section_id:r,module_id:t,note:s||null}).select().single();if(o)throw Error("Failed to add bookmark: ".concat(o.message));return a}async removeBookmark(e,r){let{error:t}=await p.N.from("user_study_bookmarks").delete().eq("user_id",e).eq("section_id",r);if(t)throw Error("Failed to remove bookmark: ".concat(t.message))}async updateBookmarkNotes(e,r,t){let{data:s,error:a}=await p.N.from("user_study_bookmarks").update({note:t,updated_at:new Date().toISOString()}).eq("user_id",e).eq("section_id",r).select().single();if(a)throw Error("Failed to update bookmark notes: ".concat(a.message));return s}async getUserStats(e){let{count:r}=await p.N.from("study_sections").select("*",{count:"exact",head:!0}),{data:t}=await p.N.from("user_study_progress").select("status, section:study_sections(id, module_id)").eq("user_id",e),{count:s}=await p.N.from("user_study_bookmarks").select("*",{count:"exact",head:!0}).eq("user_id",e),{data:a}=await p.N.from("study_modules").select("\n        id,\n        title,\n        sections:study_sections(id)\n      "),o=(null==t?void 0:t.filter(e=>"completed"===e.status).length)||0,n=(null==t?void 0:t.filter(e=>"in_progress"===e.status).length)||0,i={};if(a)for(let e of a){let r=e.sections||[],s=(null==t?void 0:t.filter(e=>"completed"===e.status&&r.some(r=>{var t;return r.id===(null==(t=e.section)?void 0:t.id)})).length)||0;i[e.id]={completed:s,total:r.length}}return{totalSections:r||0,completedSections:o,inProgressSections:n,totalBookmarks:s||0,progressByModule:i}}}let b=new f;var v=t(12115),_=t(20508),k=t(84926),j=t(6613),N=t(60235),w=t(1524);function A(){let{user:e,signOut:r}=(0,y.A)(),{progress:t,getOverallStats:l}=function(){let{user:e}=(0,y.A)(),[r,t]=(0,v.useState)([]),[s,a]=(0,v.useState)(!0),[o,n]=(0,v.useState)(null);(0,v.useEffect)(()=>{if(!e){t([]),a(!1);return}(async()=>{try{a(!0),n(null);let r=await b.getUserProgress(e.id);t(r)}catch(e){n(e instanceof Error?e.message:"Failed to load progress"),console.error("Error loading user progress:",e)}finally{a(!1)}})()},[e]);let i=async(r,s,a)=>{if(e)try{let o=await b.updateSectionProgress(e.id,r,s,a);return t(e=>{let t=e.findIndex(e=>e.section_id===r);if(!(t>=0))return[...e,o];{let r=[...e];return r[t]=o,r}}),o}catch(r){let e=r instanceof Error?r.message:"Failed to update progress";throw n(e),Error(e)}},l=e=>r.find(r=>r.section_id===e)||null,c=e=>{let r=l(e);return(null==r?void 0:r.status)||"not_started"},d=async e=>i(e,"in_progress",0),u=async e=>i(e,"completed",100),m=async(e,r)=>i(e,r>=100?"completed":r>0?"in_progress":"not_started",r);return{progress:r,loading:s,error:o,updateSectionProgress:i,getSectionProgress:l,getSectionStatus:c,getSectionCompletion:e=>{let r=l(e);return(null==r?void 0:r.completion_percentage)||0},isSectionCompleted:e=>"completed"===c(e),isSectionInProgress:e=>"in_progress"===c(e),getOverallStats:()=>{let e=r.length,t=r.filter(e=>"completed"===e.status).length;return{total:e,completed:t,inProgress:r.filter(e=>"in_progress"===e.status).length,notStarted:r.filter(e=>"not_started"===e.status).length,completionRate:e>0?Math.round(t/e*100):0}},startSection:d,completeSection:u,updateSectionCompletion:m}}(),{getBookmarksCount:u,getRecentBookmarks:m}=function(){let{user:e}=(0,y.A)(),[r,t]=(0,v.useState)([]),[s,a]=(0,v.useState)(!0),[o,n]=(0,v.useState)(null);(0,v.useEffect)(()=>{if(!e){t([]),a(!1);return}(async()=>{try{a(!0),n(null);let r=await b.getUserBookmarks(e.id);t(r)}catch(e){n(e instanceof Error?e.message:"Failed to load bookmarks"),console.error("Error loading user bookmarks:",e)}finally{a(!1)}})()},[e]);let i=async(r,s,a)=>{if(e)try{let o=await b.addBookmark(e.id,r,s,a);return t(e=>[o,...e]),o}catch(r){let e=r instanceof Error?r.message:"Failed to add bookmark";throw n(e),Error(e)}},l=async r=>{if(e)try{await b.removeBookmark(e.id,r),t(e=>e.filter(e=>e.section_id!==r))}catch(r){let e=r instanceof Error?r.message:"Failed to remove bookmark";throw n(e),Error(e)}},c=e=>r.some(r=>r.section_id===e),d=async(e,r,t)=>c(e)?(await l(e),null):await i(e,r,t);return{bookmarks:r,loading:s,error:o,addBookmark:i,removeBookmark:l,updateBookmarkNotes:async(r,s)=>{if(e)try{let a=await b.updateBookmarkNotes(e.id,r,s);return t(e=>e.map(e=>e.section_id===r?a:e)),a}catch(r){let e=r instanceof Error?r.message:"Failed to update bookmark notes";throw n(e),Error(e)}},isBookmarked:c,getBookmark:e=>r.find(r=>r.section_id===e)||null,toggleBookmark:d,getBookmarksByModule:e=>r.filter(r=>r.module_id===e),getBookmarksCount:()=>r.length,getRecentBookmarks:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;return r.slice(0,e)}}}(),[h,p]=(0,v.useState)([]),[f,A]=(0,v.useState)(!0),[E,S]=(0,v.useState)(null);(0,v.useEffect)(()=>{(async()=>{try{A(!0);let r=await b.getAllModules();if(p(r),e){let r=await b.getUserStats(e.id);S(r)}}catch(e){console.error("Error loading dashboard data:",e)}finally{A(!1)}})()},[e]);let C=l(),B=u(),I=m(3),M=async()=>{try{await r()}catch(e){console.error("Error signing out:",e)}};if(f)return(0,s.jsx)("div",{children:"Loading dashboard..."});let R=h.map(e=>{var r;let t=(null==E?void 0:E.progressByModule[e.id])||{completed:0,total:(null==(r=e.sections)?void 0:r.length)||0},s=t.total>0?Math.round(t.completed/t.total*100):0;return{...e,progress:{completed:t.completed,total:t.total,percentage:s}}});return(0,s.jsxs)("div",{className:"w-full space-y-8 pb-12",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-primary/10",children:(0,s.jsx)(_.A,{className:"h-5 w-5 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Welcome back!"}),(0,s.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:null==e?void 0:e.email})]})]}),(0,s.jsxs)(i.$,{variant:"outline",onClick:M,children:[(0,s.jsx)(k.A,{className:"mr-2 h-4 w-4"}),"Sign Out"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-4",children:[(0,s.jsxs)(a.Zp,{className:"border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100 dark:border-blue-800 dark:from-blue-900/20 dark:to-blue-800/20",children:[(0,s.jsx)(a.aR,{className:"pb-2",children:(0,s.jsx)(a.BT,{className:"text-blue-600 dark:text-blue-400",children:"Total Progress"})}),(0,s.jsxs)(a.Wu,{children:[(0,s.jsxs)("div",{className:"mb-1 text-2xl font-bold text-blue-700 dark:text-blue-300",children:[C.completionRate,"%"]}),(0,s.jsx)(n.k,{value:C.completionRate,className:"h-2"}),(0,s.jsxs)("p",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400",children:[C.completed," of ",(null==E?void 0:E.totalSections)||0," sections"]})]})]}),(0,s.jsxs)(a.Zp,{className:"border-green-200 bg-gradient-to-br from-green-50 to-green-100 dark:border-green-800 dark:from-green-900/20 dark:to-green-800/20",children:[(0,s.jsx)(a.aR,{className:"pb-2",children:(0,s.jsx)(a.BT,{className:"text-green-600 dark:text-green-400",children:"Completed"})}),(0,s.jsxs)(a.Wu,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(j.A,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),(0,s.jsx)("span",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:C.completed})]}),(0,s.jsx)("p",{className:"mt-2 text-xs text-green-600 dark:text-green-400",children:"Sections mastered"})]})]}),(0,s.jsxs)(a.Zp,{className:"border-orange-200 bg-gradient-to-br from-orange-50 to-orange-100 dark:border-orange-800 dark:from-orange-900/20 dark:to-orange-800/20",children:[(0,s.jsx)(a.aR,{className:"pb-2",children:(0,s.jsx)(a.BT,{className:"text-orange-600 dark:text-orange-400",children:"In Progress"})}),(0,s.jsxs)(a.Wu,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.A,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"}),(0,s.jsx)("span",{className:"text-2xl font-bold text-orange-700 dark:text-orange-300",children:C.inProgress})]}),(0,s.jsx)("p",{className:"mt-2 text-xs text-orange-600 dark:text-orange-400",children:"Currently studying"})]})]}),(0,s.jsxs)(a.Zp,{className:"border-cyan-200 bg-gradient-to-br from-cyan-50 to-cyan-100 dark:border-cyan-800 dark:from-cyan-900/20 dark:to-cyan-800/20",children:[(0,s.jsx)(a.aR,{className:"pb-2",children:(0,s.jsx)(a.BT,{className:"text-cyan-600 dark:text-cyan-400",children:"Bookmarks"})}),(0,s.jsxs)(a.Wu,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(N.A,{className:"h-5 w-5 text-cyan-600 dark:text-cyan-400"}),(0,s.jsx)("span",{className:"text-2xl font-bold text-cyan-700 dark:text-cyan-300",children:B})]}),(0,s.jsx)("p",{className:"mt-2 text-xs text-cyan-600 dark:text-cyan-400",children:"Saved for later"})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,s.jsx)(i.$,{asChild:!0,children:(0,s.jsxs)(g(),{href:"/study",children:[(0,s.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Continue Learning"]})}),(0,s.jsx)(i.$,{variant:"outline",asChild:!0,children:(0,s.jsxs)(g(),{href:"/bookmarks",children:[(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"View Bookmarks"]})}),(0,s.jsx)(i.$,{variant:"outline",asChild:!0,children:(0,s.jsxs)(g(),{href:"/progress",children:[(0,s.jsx)(w.A,{className:"mr-2 h-4 w-4"}),"Progress Report"]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"TCO Certification Modules"}),(0,s.jsx)(o.E,{variant:"secondary",className:"text-sm",children:"5 modules • 20 sections"})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:R.map(e=>(0,s.jsx)(x,{module:e,progress:e.progress},e.id))})]}),I.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"mb-4 text-xl font-semibold text-slate-900 dark:text-slate-100",children:"Recent Bookmarks"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:I.map(e=>{var r,t;return(0,s.jsxs)(a.Zp,{className:"transition-shadow hover:shadow-md",children:[(0,s.jsx)(a.aR,{className:"pb-2",children:(0,s.jsx)(a.ZB,{className:"line-clamp-2 text-sm font-medium",children:(null==(r=e.section)?void 0:r.title)||"Untitled Section"})}),(0,s.jsxs)(a.Wu,{children:[(0,s.jsx)("p",{className:"mb-2 text-xs text-muted-foreground",children:(null==(t=e.module)?void 0:t.title)||"Unknown Module"}),e.notes&&(0,s.jsx)("p",{className:"line-clamp-2 text-xs text-slate-600 dark:text-slate-400",children:e.notes}),(0,s.jsx)(i.$,{asChild:!0,size:"sm",className:"mt-2 w-full",children:(0,s.jsx)(g(),{href:"/study/modules/".concat(e.module_id,"/sections/").concat(e.section_id),children:"Continue Reading"})})]})]},e.id)})})]})]})}},94600:(e,r,t)=>{Promise.resolve().then(t.bind(t,94414))}},e=>{e.O(0,[4909,5376,5040,2619,8968,1733,8441,1255,7358],()=>e(e.s=94600)),_N_E=e.O()}]);